*** Settings ***
Documentation    M1M3_RejectedCylinderForces sender/logger tests.
Force Tags    python    TSS-2617
Suite Setup    Run Keywords    Log Many    ${Host}    ${subSystem}    ${component}    ${timeout}
...    AND    Create Session    Sender    AND    Create Session    Logger
Suite Teardown    Close All Connections
Library    SSHLibrary
Library    String
Resource    ../../Global_Vars.robot
Resource    ../../common.robot

*** Variables ***
${subSystem}    m1m3
${component}    RejectedCylinderForces
${timeout}    30s

*** Test Cases ***
Verify Component Sender and Logger
    [Tags]    smoke
    File Should Exist    ${SALWorkDir}/${subSystem}/python/${subSystem}_Event_${component}.py
    File Should Exist    ${SALWorkDir}/${subSystem}/python/${subSystem}_EventLogger_${component}.py

Start Sender - Verify Missing Inputs Error
    [Tags]    functional
    Switch Connection    Sender
    Comment    Move to working directory.
    Write    cd ${SALWorkDir}/${subSystem}/python
    Comment    Start Sender.
    ${input}=    Write    python ${subSystem}_Event_${component}.py 
    ${output}=    Read Until Prompt
    Log    ${output}
    Should Contain    ${output}   ERROR : Invalid or missing arguments : Timestamp SecondaryCylinderForces PrimaryCylinderForces priority

Start Logger
    [Tags]    functional
    Switch Connection    Logger
    Comment    Move to working directory.
    Write    cd ${SALWorkDir}/${subSystem}/python
    Comment    Start Logger.
    ${input}=    Write    python ${subSystem}_EventLogger_${component}.py
    ${output}=    Read Until    logger ready
    Log    ${output}
    Should Contain    ${output}    ${subSystem}_${component} logger ready

Start Sender
    [Tags]    functional
    Switch Connection    Sender
    Comment    Move to working directory.
    Write    cd ${SALWorkDir}/${subSystem}/python
    Comment    Start Sender.
    ${input}=    Write    python ${subSystem}_Event_${component}.py 62.0094 -1689069134 1549026660 -891522356 907561117 280181413 -112418472 1773116169 -63776453 -1235720351 1759212663 -1165578754 -900526723 591688365 -47772660 -894303224 -1705440442 1382287357 1633848128 -1163673525 598739726 -1655429684 2090848001 1696898359 -2103839900 -1817532146 1080764315 -575741407 -643864796 1647874934 -132557056 1647724831 1272379265 -1857242453 -466530295 -109232757 -1465522263 -2048306709 -654492026 -1577915682 -1224793226 -243747374 933787719 1102301891 -1135730924 -860363062 2000059810 1059736799 -1436643592 -1641808758 -502735972 -230960888 1022297347 -1431841096 -500590601 -1158831070 -1396029443 136617636 1509740004 563480784 -848352212 225112143 -1307078968 -1941473146 -854021539 773410712 1107853984 -713081311 -252711768 -1934311507 -1603533519 -383954306 1642362003 -1825716557 -1159704588 89251930 1423393986 267643418 -911066857 1979807248 391634148 1543680139 -756217583 1631596840 -2040869010 -1682307741 2097761823 1110853415 -541949033 176150806 1389445453 -1074626979 595847425 -2000531967 -1713401189 1970545079 1319724595 60700160 1705869929 -98445804 -1266548993 -1412923471 -33909497 606946076 529366643 -1244142273 -2068193822 -68553263 69448092 2052864408 1542150383 -1225639443 754004076 -805174522 2084527896 2143723958 -841758784 1996286722 -1661548166 -554876796 -1651867491 1170198253 -354555127 578438256 -1268768936 -2137308866 -946399925 125496193 -135013469 -1014319101 -1664559436 356949709 255970299 1238988220 -1280961931 1197470394 766204154 -2103500918 -171538750 1213314636 -615258064 -2056359607 -667643286 -666546577 1875858576 599509781 1508983580 -1210972873 1672232268 -2012777802 740091344 -1631861480 1050201069 -291570298 1240409279 -771257966 932616811 1284730938 -347117260 1833443701 282026435 -78267017 -448597543 490895831 -1406316142 -1953223789 -1880570903 -421754128 -1551895999 -1731920863 1912113725 -643798026 46282770 -1060823881 -712764602 -294701398 -1598606308 660468214 -666471397 -1279941452 1545624802 1649756979 539468692 -1695724096 -1296615302 1607423057 903684614 20880379 2136941971 -61500773 -2082070855 816797694 -221714302 20178146 987269853 136763628 1123882636 -636842041 2040631907 -1972531523 -1072331921 -622371313 -1089957666 -1395794704 1146014548 1984700057 1810372489 -1364496024 673697503 84422803 -285762139 375562201 -1298279249 -1263129882 75097313 621171357 1332117146 -2128807715 -1061799764 -679652972 1040098233 -650961746 -161165245 1283635148 -1653498271 -2024421002 1481503696 572188209 500370250 1834690404 -914946669 1694059666 1417513553 -529082359 820596844 1705198648 1207728013 -2093232486 -194895806 861503786 853975216 790212940 1068929483 -1018365836 -1432454167 823525415 1400202090 1976503583 -846256129 264707224 -1246892745 -1600673437 -1461412740 -412387050 940112301 -521233538 -1960160696 588360840 2088625900 863279641 -1540926408 -238188722 2070479773 705310519 -1497119950 1124939459 1694587135 -2079246724 -1007381440 1495333273
    ${output}=    Read Until Prompt
    Log    ${output}
    Should Contain X Times    ${output}    === [putSample] m1m3::logevent_RejectedCylinderForces writing a message containing :    1
    Should Contain    ${output}    revCode \ : LSST TEST REVCODE

Read Logger
    [Tags]    functional
    Switch Connection    Logger
    ${output}=    Read Until    ${component} received
    Log    ${output}
    Should Contain X Times    ${output}    Event ${subSystem} ${component} received     1
