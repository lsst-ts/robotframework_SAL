*** Settings ***
Documentation    M1M3_RejectedCylinderForces sender/logger tests.
Force Tags    python    TSS-2617
Suite Setup    Run Keywords    Log Many    ${Host}    ${subSystem}    ${component}    ${timeout}
...    AND    Create Session    Sender    AND    Create Session    Logger
Suite Teardown    Close All Connections
Library    SSHLibrary
Library    String
Resource    ../../Global_Vars.robot
Resource    ../../common.robot

*** Variables ***
${subSystem}    m1m3
${component}    RejectedCylinderForces
${timeout}    30s

*** Test Cases ***
Verify Component Sender and Logger
    [Tags]    smoke
    File Should Exist    ${SALWorkDir}/${subSystem}/python/${subSystem}_Event_${component}.py
    File Should Exist    ${SALWorkDir}/${subSystem}/python/${subSystem}_EventLogger_${component}.py

Start Sender - Verify Missing Inputs Error
    [Tags]    functional
    Switch Connection    Sender
    Comment    Move to working directory.
    Write    cd ${SALWorkDir}/${subSystem}/python
    Comment    Start Sender.
    ${input}=    Write    python ${subSystem}_Event_${component}.py 
    ${output}=    Read Until Prompt
    Log    ${output}
    Should Contain    ${output}   ERROR : Invalid or missing arguments : Timestamp SecondaryCylinderForces PrimaryCylinderForces priority

Start Logger
    [Tags]    functional
    Switch Connection    Logger
    Comment    Move to working directory.
    Write    cd ${SALWorkDir}/${subSystem}/python
    Comment    Start Logger.
    ${input}=    Write    python ${subSystem}_EventLogger_${component}.py
    ${output}=    Read Until    logger ready
    Log    ${output}
    Should Contain    ${output}    ${subSystem}_${component} logger ready

Start Sender
    [Tags]    functional
    Switch Connection    Sender
    Comment    Move to working directory.
    Write    cd ${SALWorkDir}/${subSystem}/python
    Comment    Start Sender.
    ${input}=    Write    python ${subSystem}_Event_${component}.py 16.2383 -1130192864 1855447319 -1857778218 -441075629 1552996839 708887582 -903617010 -663340192 -1956801735 434184320 -1229259669 -621778539 1759455814 -614277632 -1423418570 1847511167 -1406721321 865040586 2018495328 -5913476 -1954633388 -1667301053 1515504079 392932552 -1176879482 -1082055569 -1249350573 985970610 1796190183 -601411326 -2110341818 48302300 764559347 -1593254823 -1909436686 -1358395750 370956092 -1443495914 -293431518 709254604 1290970653 -1783661023 2005899168 -1689591732 632472473 1559254385 -1492279167 345042971 -602255654 -1366347401 2133894014 -71693556 1438575089 1057961857 -1609010254 502378341 -807408726 1550391353 -1013201927 -1502515618 -1494003326 1178019991 -2142160873 -1699936536 2140477046 -7932350 1713683193 -1628945983 675644825 -1854100381 1388512887 241079028 -2042114276 -1289435618 -118644283 -300052755 1801796374 -455037926 -583148180 202164696 1625251437 6190418 -146102395 515018110 -1660476902 1959233262 -672720029 431638906 1836749422 -197418250 -839622020 -1554552242 -1767609266 -2001286535 -1949439272 1012853654 -1823898445 -1516995926 -1321088185 -1602542025 1835965357 -691231431 -2016861543 -1318074340 1446115061 -1104013159 -2077097115 -1692565208 487523091 -828040539 -1511265043 370583605 -1203944877 1816005100 -1767532625 55027452 -297831046 -753884908 -1950446733 -616276374 -181433453 456634806 -1035324898 150607638 -1651375541 -1398634056 1873210393 -379318760 -869360162 -964701216 871231863 -1834107436 1890084969 -767583662 -740935423 1590521724 -298248423 -1778925709 -503780112 1529708055 1758067293 -85510378 -2131629184 691367141 72677493 547392968 -335419703 -1472591805 789699013 -1860039806 -188364341 -1014005841 -1284648988 -1831755145 -2010949636 920218589 1528545233 -544800796 -1954057095 676056121 -227242836 2142052339 -961130784 1775175118 546194583 610131714 1110548245 -2043591312 -228567593 -1863803593 -1055680266 1048729921 -1580646429 1269574190 -1709151061 1489677115 -609088653 -846678020 -1151895820 467219590 -159457262 -1648672842 -630298292 -2023283119 -1271879071 -1309258698 1932391144 1006557014 -1082363939 -352898979 -363594024 2040636669 -1540762121 415797851 -551213944 1718644266 -1733331316 519601951 100414046 -1063691190 -695528413 -883377066 -1030478256 -222859194 1277525874 -1442267404 -2037335661 -104305337 -1341846890 1390275452 1985927194 1551134756 -914353175 -1294106996 -1694321359 -887253527 -163137791 -1249243117 1659057631 -1375687483 -1352880176 -1177172120 629563991 -409694926 -1640554444 1106746332 310867581 -64896953 -1688597120 1127271538 -1188845148 933011578 -127570710 183491639 1709556989 -942820831 20262206 883620440 660516967 1284449699 53766584 -289842626 -2122023850 -2057912461 1890054284 321721795 -1168793698 -2080318522 1423487667 -1828726172 -777091112 302898150 -1259095142 1448347321 243409506 -834566300 -1680230665 708969157 -2045757901 -1032745432 528014861 736294837 -1520057353 -2094443801 423969204 1632899916 1948398238 -1149554015 -358248116
    ${output}=    Read Until Prompt
    Log    ${output}
    Should Contain X Times    ${output}    === [putSample] m1m3::logevent_RejectedCylinderForces writing a message containing :    1
    Should Contain    ${output}    revCode \ : LSST TEST REVCODE

Read Logger
    [Tags]    functional
    Switch Connection    Logger
    ${output}=    Read Until    ${component} received
    Log    ${output}
    Should Contain X Times    ${output}    Event ${subSystem} ${component} received     1
