*** Settings ***
Documentation    M1M3_RejectedCylinderForces sender/logger tests.
Force Tags    python    TSS-2617
Suite Setup    Run Keywords    Log Many    ${Host}    ${subSystem}    ${component}    ${timeout}
...    AND    Create Session    Sender    AND    Create Session    Logger
Suite Teardown    Close All Connections
Library    SSHLibrary
Library    String
Resource    ../../Global_Vars.robot
Resource    ../../common.robot

*** Variables ***
${subSystem}    m1m3
${component}    RejectedCylinderForces
${timeout}    30s

*** Test Cases ***
Verify Component Sender and Logger
    [Tags]    smoke
    File Should Exist    ${SALWorkDir}/${subSystem}/python/${subSystem}_Event_${component}.py
    File Should Exist    ${SALWorkDir}/${subSystem}/python/${subSystem}_EventLogger_${component}.py

Start Sender - Verify Missing Inputs Error
    [Tags]    functional
    Switch Connection    Sender
    Comment    Move to working directory.
    Write    cd ${SALWorkDir}/${subSystem}/python
    Comment    Start Sender.
    ${input}=    Write    python ${subSystem}_Event_${component}.py 
    ${output}=    Read Until Prompt
    Log    ${output}
    Should Contain    ${output}   ERROR : Invalid or missing arguments : Timestamp SecondaryCylinderForces PrimaryCylinderForces priority

Start Logger
    [Tags]    functional
    Switch Connection    Logger
    Comment    Move to working directory.
    Write    cd ${SALWorkDir}/${subSystem}/python
    Comment    Start Logger.
    ${input}=    Write    python ${subSystem}_EventLogger_${component}.py
    ${output}=    Read Until    logger ready
    Log    ${output}
    Should Contain    ${output}    ${subSystem}_${component} logger ready

Start Sender
    [Tags]    functional
    Switch Connection    Sender
    Comment    Move to working directory.
    Write    cd ${SALWorkDir}/${subSystem}/python
    Comment    Start Sender.
    ${input}=    Write    python ${subSystem}_Event_${component}.py 65.1674 1012666751 -1649853497 60341628 -557359443 1558817908 -1905391194 -1838338627 1878222823 -525269877 -146776421 1214396853 -352241921 -1682879548 -1270208654 -1510813926 1741726167 279153461 1680328101 -1551632920 682168322 276554110 800414280 1090173693 1343914965 -343275691 -1753355805 382079092 -1936606671 102033069 -967588778 471602937 -452634257 1033377358 -1489516139 -830539219 249565473 470858551 1116882940 1110138302 1515733935 1231678789 1490088978 410384611 1073512082 -53455446 698329808 -1269272320 -719392063 -905532137 1593549275 -1042494735 1002022913 986966419 -124958077 -105596533 1714115782 86347851 618901084 -447348139 2145680549 150124019 -1619104608 1609980601 -1929979805 1239586073 -1051823133 894862416 765993380 -1385171782 1875543426 985736990 96717480 85707034 -226394665 1729150838 -1275039803 -224674805 2124032250 1015429122 -870141307 517000926 -1140400029 -1051097306 496667050 -1814705525 1154291855 2007433283 -1451259493 1471297884 487094546 -1781807217 -606725433 783451591 465185360 1081689566 1390057747 1529872628 566403184 -419108409 -50595308 -1852878982 -399281066 25959449 1411478982 2000827675 1042558729 1216022339 -518328655 -1263092835 1220773717 -1572009029 -1163662585 -1839635556 -1616126976 -2115901858 -910681394 -68999424 263240789 -1863001778 -462567727 584016761 -2108976574 807591558 -1564906309 726214340 -937478516 1665617361 -513264814 -864469130 -882620853 1802621012 190759552 -697024345 1213969977 921093623 -1857428394 1140229114 1818320845 -249856217 -763496010 -2023696183 1634590057 -1492585252 2117656251 1554667750 381138288 -1836612205 -568487972 475751154 597501229 -206708287 -1915385758 2127542995 -985046720 -285761189 1926109906 2005653505 1507855562 398368285 -849895002 -1588712279 910846041 -1478035327 2121838271 789134521 1762730382 -1645499344 -1581709716 -1032754904 632179628 1365807309 1382253912 571340600 456228352 -1307532627 -1158265195 -796778550 1808481289 1554368553 1528033630 -1309756479 2093602653 -1102468342 870584958 328219056 -2139660405 1734232574 -280642393 -1344556977 225686933 -1919806815 268520401 -1781941010 1583377408 1866137163 -748454602 505519770 -530730575 -1763236421 804356111 830763345 -443385464 -1022265716 1059367142 558760274 982823742 -966908488 447160801 -211184029 -1236936262 -1129720192 1174199120 -1216964192 -684562952 901507555 903070924 -1242070456 155736872 237950364 -321717642 -2039976239 -340379446 8428850 -1245465076 -78412771 1536014933 -430200339 -133074590 144285875 879382985 -1901843846 1102513845 -840511115 -1185559015 1446141472 -791414137 1651995846 226601122 418313990 527290705 -222798097 394945218 -1966812851 -413262906 630374971 -906024033 -1642240391 -712989458 -1779350728 1656184386 -1233295162 1413768013 -1812288731 1656766150 -316375008 -2126518277 942738859 -623299048 -139103416 6416105 -859798695 1393017249 1852481121 1074459018 600398964 -1813000314 1648417491 -1632234875 -100402051
    ${output}=    Read Until Prompt
    Log    ${output}
    Should Contain X Times    ${output}    === [putSample] m1m3::logevent_RejectedCylinderForces writing a message containing :    1
    Should Contain    ${output}    revCode \ : LSST TEST REVCODE

Read Logger
    [Tags]    functional
    Switch Connection    Logger
    ${output}=    Read Until    ${component} received
    Log    ${output}
    Should Contain X Times    ${output}    Event ${subSystem} ${component} received     1
*** Settings ***
Documentation    M1M3_RejectedCylinderForces communications tests.
Force Tags    python    TSS-2617
Suite Setup    Run Keywords    Log Many    ${Host}    ${subSystem}    ${component}    ${timeout}
...    AND    Create Session    Sender    AND    Create Session    Logger
Suite Teardown    Close All Connections
Library    SSHLibrary
Library    String
Resource    ../../Global_Vars.robot
Resource    ../../common.robot

*** Variables ***
${subSystem}    m1m3
${component}    RejectedCylinderForces
${timeout}    30s

*** Test Cases ***
Verify Component Sender and Logger
    [Tags]    smoke
    File Should Exist    ${SALWorkDir}/${subSystem}/python/${subSystem}_Event_${component}.py
    File Should Exist    ${SALWorkDir}/${subSystem}/python/${subSystem}_EventLogger_${component}.py

Start Sender - Verify Missing Inputs Error
    [Tags]    functional
    Switch Connection    Sender
    Comment    Move to working directory.
    Write    cd ${SALWorkDir}/${subSystem}/python
    Comment    Start Sender.
    ${input}=    Write    python ${subSystem}_Event_${component}.py 
    ${output}=    Read Until Prompt
    Log    ${output}
    Should Contain    ${output}   ERROR : Invalid or missing arguments : Timestamp SecondaryCylinderForces PrimaryCylinderForces priority

Start Logger
    [Tags]    functional
    Switch Connection    Logger
    Comment    Move to working directory.
    Write    cd ${SALWorkDir}/${subSystem}/python
    Comment    Start Logger.
    ${input}=    Write    python ${subSystem}_EventLogger_${component}.py
    ${output}=    Read Until    logger ready
    Log    ${output}
    Should Contain    ${output}    ${subSystem}_${component} logger ready

Start Sender
    [Tags]    functional
    Switch Connection    Sender
    Comment    Move to working directory.
    Write    cd ${SALWorkDir}/${subSystem}/python
    Comment    Start Sender.
    ${input}=    Write    python ${subSystem}_Event_${component}.py 53.0682 -126658335 1346477729 -2013749082 967553051 -632804140 102691263 2094514065 -2099176223 794490372 1651540370 -691760329 -1114480582 1717226918 1566511142 -1279438256 1146942666 192510603 -1477411984 -1221357349 -1275612040 -550699743 -778226059 -1064775714 -936858270 921054737 -40213991 -675396776 582419291 934376180 -2059268668 -301208375 719125642 -1708430279 -301698749 1132459272 -567951752 -387921087 -1309777967 1729835746 1097172814 -1720433855 1248793881 -829522062 1612501634 1024337344 -308294037 -1388988855 -1600201655 2074773388 -2051788883 759963731 744744598 -661593879 -1543103444 353764511 -248290572 -1423592621 235917679 -886969952 -708224886 -365745221 1885532504 -1957091926 994323447 -501933529 -2114893052 -1513821528 1100610355 -1308733397 922872704 -1187859175 -1516908842 1454453210 2032822105 297915187 -1603699918 678041864 812172212 -320852212 12258994 -998305599 828501581 2060935121 -600250918 909834905 -1030055620 594804658 287375260 -1384152648 -945741479 2115641495 1586846597 -2138002310 -1208887222 950284519 -1242946686 950943316 844864986 -600566415 -1598819616 928025097 -1677742458 -1395151218 1189743865 -1466783398 2000244002 55180301 641896165 98641586 1090327272 1416978229 1204636383 -235215100 -1152189338 120276963 -614111089 1447641496 1661161339 -802235809 -1761420221 2088436120 -1046484996 -162152301 1875150206 2027878348 -2070835229 -1078956957 -191824902 -22953480 316530630 1909600354 -1634448595 -1439804942 1364523407 -732065245 -1682955304 -1678987217 1219760864 -48635513 -1229918637 -704167988 855811393 -1320341787 -796204611 1692197495 -1865823928 2075675140 1177908490 -899869991 -718399446 -1938622546 812731660 799857107 -149942408 152853804 1386610306 362485469 -1188880831 863994466 1595770905 -65820116 84758329 1634517914 955627353 87219787 755291018 -191181319 256066837 -1839748493 -1779257646 -1256933769 1679276935 -1262237387 -280508458 -1981440101 1628978203 -679117127 241717520 -2029304462 -684835839 -1286647035 -1173010890 354549084 107386079 1662977013 328577399 -955981316 -227671681 1478728394 -961330373 402750525 -1261239015 -1619104849 1398120507 -2078195643 -1475529997 -1690741651 1452885942 78764143 -28445601 235379769 322924570 -1877305877 857135067 -1233822063 528897086 863774596 1737821286 903954937 1516146211 1102093492 2145121563 793209606 -1625611531 -465643452 126338646 996143553 1433260145 -1795662390 1016656179 -1204815004 1367566304 122241213 1089554370 -2112841112 -1461191989 -969204473 1658190465 340229231 1188237528 865704666 2109140586 1989577450 943616099 93011846 371327632 -1009261738 531833805 -1338104996 413702602 -874390433 49889333 1414535358 -1798056387 1400283878 929997253 1735792288 534743837 -70745071 961387864 -383766721 618892926 -345353846 -227763122 1407768492 2090378683 -1730477195 -2037885846 523125300 346197464 -1124861198 1889546383 -838555548 146420331 816477794 1068987 2008362977 -702641292 -309467786
    ${output}=    Read Until Prompt
    Log    ${output}
    Should Contain X Times    ${output}    === [putSample] m1m3::logevent_RejectedCylinderForces writing a message containing :    1
    Should Contain    ${output}    revCode \ : LSST TEST REVCODE

Read Logger
    [Tags]    functional
    Switch Connection    Logger
    ${output}=    Read Until    ${component} received
    Log    ${output}
    Should Contain X Times    ${output}    Event ${subSystem} ${component} received     1
