*** Settings ***
Documentation    M1M3_RejectedCylinderForces sender/logger tests.
Force Tags    python    Checking if skipped: m1m3
TSS-2617
Suite Setup    Run Keywords    Log Many    ${Host}    ${subSystem}    ${component}    ${timeout}
...    AND    Create Session    Sender    AND    Create Session    Logger
Suite Teardown    Close All Connections
Library    SSHLibrary
Library    String
Resource    ../../Global_Vars.robot
Resource    ../../common.robot

*** Variables ***
${subSystem}    m1m3
${component}    RejectedCylinderForces
${timeout}    30s

*** Test Cases ***
Verify Component Sender and Logger
    [Tags]    smoke
    File Should Exist    ${SALWorkDir}/${subSystem}/python/${subSystem}_Event_${component}.py
    File Should Exist    ${SALWorkDir}/${subSystem}/python/${subSystem}_EventLogger_${component}.py

Start Sender - Verify Missing Inputs Error
    [Tags]    functional
    Switch Connection    Sender
    Comment    Move to working directory.
    Write    cd ${SALWorkDir}/${subSystem}/python
    Comment    Start Sender.
    ${input}=    Write    python ${subSystem}_Event_${component}.py 
    ${output}=    Read Until Prompt
    Log    ${output}
    Should Contain    ${output}   ERROR : Invalid or missing arguments : Timestamp SecondaryCylinderForces PrimaryCylinderForces priority

Start Logger
    [Tags]    functional
    Switch Connection    Logger
    Comment    Move to working directory.
    Write    cd ${SALWorkDir}/${subSystem}/python
    Comment    Start Logger.
    ${input}=    Write    python ${subSystem}_EventLogger_${component}.py
    ${output}=    Read Until    logger ready
    Log    ${output}
    Should Contain    ${output}    ${subSystem}_${component} logger ready

Start Sender
    [Tags]    functional
    Switch Connection    Sender
    Comment    Move to working directory.
    Write    cd ${SALWorkDir}/${subSystem}/python
    Comment    Start Sender.
    ${input}=    Write    python ${subSystem}_Event_${component}.py 18.4146 1968678778 1796126926 -1100257770 1806810996 -1676347361 -1572908795 -1256038815 -1901545242 -616634796 -1665819879 -1639462528 1803780775 834441116 1167495091 973422999 -1732960970 -1647476121 -1997979106 1108418813 1226823013 327456866 -1058422618 -1380530027 1423222469 166063569 626378033 1440822957 1230819508 -407407141 1985857553 2090505471 -569808432 1038694920 -2075277662 363912820 -1648249693 -639674619 -2054764033 49923955 -1013749826 1257335452 609242565 -975331907 1493469357 -1109123154 -1384191993 529136853 -596425784 -864796776 1353133906 1946893333 -1631542706 -1795267433 -662248834 -1860158419 -207244321 -1147826904 -8355941 1451864276 588789060 543092254 -1358711818 -569026078 720799455 -477809804 1511506274 605408513 -776137373 518437457 -535376786 2049124867 -512926688 -27774561 1307909489 -819338364 1174914095 -22725805 566584776 -1071645922 -450154290 2007010676 1941102084 -1082089392 1529225589 -119764791 -206703680 1134674515 1845914215 -393970523 714213101 -1541370966 -380856649 2105436224 -1225064547 -263243268 38850389 1954906158 124303881 1656029671 1005401849 1390566018 1809850848 -509079172 1969315316 -1967712508 1504624602 1613057094 -1705840742 -1779535641 -1362891491 1793454654 1333097487 -270103549 -872477070 -405029899 1239342303 -1389094149 2061007694 -496868929 1938551518 2005596008 -248639826 -1480400445 -473711609 1457574587 1662921540 -1233492378 -1868008514 -507050612 -3092833 -1512754807 -1551944316 -1473348844 1213932847 -2097263909 -1147819495 -1293809874 -913181352 -1480172985 -1972682004 1408517315 202996377 2120913015 -583019501 -1445613650 1148502952 1652859859 307877492 822109331 173274230 -934617444 1491031696 -1144152872 1001443782 2096079873 292832130 -501631448 1317456251 1731479749 -473730841 -247660071 1390740602 1358162581 -108693403 1546610403 -2060534082 -1895858631 1644457766 -949308317 685388743 1767065610 1740132242 -800792914 -379843926 1424754112 1321497329 -803054291 -1098386637 1918897882 -896521113 1677775312 62673714 -2071979022 44145340 1862892301 -1985497541 1035642931 -2088297702 295008062 2118538212 -891907351 -1512418596 -995859894 -1456307396 -2030094402 1959394820 1984455356 1830831460 809137037 918940194 643100824 -1148557857 1373486814 -981670660 673026206 -1793854232 -966878988 -1781364761 -1495716191 -1712662245 206339411 -1178182208 -119155745 1962853242 -500413081 580867539 1283626061 1429904383 -23655280 -1119122866 -142150788 1537026135 -1031554187 -1147680367 1772869728 -1263196095 1161691133 527638165 1525945347 -1290830619 -1531207047 1719307387 138245952 -868951181 743851341 -1339952019 -899298690 -1909723855 -592870112 -1239798865 736105607 1799188112 1529338668 1120861024 -2040500286 207838397 -1365849783 -421116291 457776710 -369402719 -1025977844 1661205458 -1224159111 -391908006 -253408896 239737385 -1634181175 1651485008 300897085 -992536772 270025595 692440258 -1464185582 1905680254 494566139 -1325566895 -622966660 1811741044 82080736
    ${output}=    Read Until Prompt
    Log    ${output}
    Should Contain X Times    ${output}    === [putSample] m1m3::logevent_RejectedCylinderForces writing a message containing :    1
    Should Contain    ${output}    revCode \ : LSST TEST REVCODE

Read Logger
    [Tags]    functional
    Switch Connection    Logger
    ${output}=    Read Until    ${component} received
    Log    ${output}
    Should Contain X Times    ${output}    Event ${subSystem} ${component} received     1
