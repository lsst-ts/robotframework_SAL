*** Settings ***
Documentation    M1M3_RejectedCylinderForces communications tests.
Force Tags    python    TSS-2617
Suite Setup    Run Keywords    Log Many    ${Host}    ${subSystem}    ${component}    ${timeout}
...    AND    Create Session    Sender    AND    Create Session    Logger
Suite Teardown    Close All Connections
Library    SSHLibrary
Library    String
Resource    ../../Global_Vars.robot
Resource    ../../common.robot

*** Variables ***
${subSystem}    m1m3
${component}    RejectedCylinderForces
${timeout}    30s

*** Test Cases ***
Verify Component Sender and Logger
    [Tags]    smoke
    File Should Exist    ${SALWorkDir}/${subSystem}/python/${subSystem}_Event_${component}.py
    File Should Exist    ${SALWorkDir}/${subSystem}/python/${subSystem}_EventLogger_${component}.py

Start Sender - Verify Missing Inputs Error
    [Tags]    functional
    Switch Connection    Sender
    Comment    Move to working directory.
    Write    cd ${SALWorkDir}/${subSystem}/python
    Comment    Start Sender.
    ${input}=    Write    python ${subSystem}_Event_${component}.py 
    ${output}=    Read Until Prompt
    Log    ${output}
    Should Contain    ${output}   ERROR : Invalid or missing arguments : Timestamp SecondaryCylinderForces PrimaryCylinderForces priority

Start Logger
    [Tags]    functional
    Switch Connection    Logger
    Comment    Move to working directory.
    Write    cd ${SALWorkDir}/${subSystem}/python
    Comment    Start Logger.
    ${input}=    Write    python ${subSystem}_EventLogger_${component}.py
    ${output}=    Read Until    logger ready
    Log    ${output}
    Should Contain    ${output}    ${subSystem}_${component} logger ready

Start Sender
    [Tags]    functional
    Switch Connection    Sender
    Comment    Move to working directory.
    Write    cd ${SALWorkDir}/${subSystem}/python
    Comment    Start Sender.
    ${input}=    Write    python ${subSystem}_Event_${component}.py 47.9885 480264815 187792095 313550264 351157606 -60191964 -221690587 -231872015 910431571 -1189161316 1711887829 -1571210150 1760017773 1801026762 -386360254 -467771141 -128554426 -982053890 576987168 -201748057 546282948 -1765196607 1388770231 -1891067504 -1818110515 1249065387 102667627 2123135275 -714241609 191933636 711409600 1075674727 1398696340 -718633627 1046373235 -1351641116 1668501022 718321496 -153381703 -1595281187 454808628 -1505903685 -2080975192 -1624987834 -1209670315 428212071 -460146670 -1584073677 797589776 -1210877801 1741428782 -1111234659 -334042032 -491146055 1592063099 -993093581 828962349 -685717265 1819669800 -1433327049 686506781 -710960884 987065696 -2028491828 742292854 -1926688435 1372401482 1214190393 504227142 -2043159578 -1621781265 145231177 206119826 1081566474 1626819000 -270799471 1974798214 -1639261319 784354855 579852548 -1653885360 894773126 752599006 1692851169 -2137152559 -348925440 -2144492716 860415292 1420138348 -1226736567 1031041985 -2098291797 -1853711003 -988986154 -921652356 567366595 -1506004169 -114070007 -1883446511 -1472449169 1352860228 2044297618 -195802306 386651349 1073189291 661744915 148383582 -986844842 802916113 1066504787 117298668 -1335131873 -1928607830 1191215520 -465111071 -459866677 -1618208732 1146888183 303344609 -726735984 1636694998 -1252498167 92809568 1541384089 -1346283184 562385459 -1803395973 -1717947283 808609449 -1097837835 -1077149467 921466624 -1279757221 1717096181 116662510 -166871354 -1789507533 -939333345 1662840763 1152506028 -140219934 977396407 2077228640 -1857044801 -1244509989 -974379649 1439762372 -1394384739 1529711879 -380620721 -205523540 -2013400796 -135839794 1206085844 659774040 996626753 -1093320188 1903876587 429663989 -338922398 1243275606 1889745165 -427931151 437725924 986053108 -184147030 -900688412 1304886678 1917310453 1621389290 -1734094817 1397914761 -1651401871 1536234979 -132075905 1777948804 -1197193308 938678964 639833403 2130912243 2014070235 1092674823 -1637940729 1156237669 -2085156287 1032214472 1658575920 -2083122119 1452087751 -1757912160 765058206 1258658037 1849687514 -1684004902 53307617 1994983154 1658468815 -2061813296 1473712650 -860444953 733887199 1877208926 595981888 -1229565544 588685809 1778083259 -856204120 -1564996361 720797696 -1686810460 -413115795 -1117510777 -365845966 -368693954 -1954971002 908894625 -1852182040 -1548806177 1687448862 1974110113 -342405260 -1513178633 -1765286379 -1203411084 -943840224 -1497250862 -1635455659 2122459505 -1747329858 1360561224 -1744989437 692547729 -505881757 200510907 2128759105 581132342 -393388583 2081262463 -1262323082 2086395238 -2019852918 -165773260 1439327961 -788684162 -540927319 416024325 287697946 -374200259 977933658 2121331938 1458566642 479976837 -129341788 -32078757 -1528946064 628575043 1213802606 1288746970 69944415 1107970852 -1073319311 -370321866 1177750245 -508061906 -1664749407 -177331339 -916269862 -725083175 -656620610 -837288390
    ${output}=    Read Until Prompt
    Log    ${output}
    Should Contain X Times    ${output}    === [putSample] m1m3::logevent_RejectedCylinderForces writing a message containing :    1
    Should Contain    ${output}    revCode \ : LSST TEST REVCODE

Read Logger
    [Tags]    functional
    Switch Connection    Logger
    ${output}=    Read Until    ${component} received
    Log    ${output}
    Should Contain X Times    ${output}    Event ${subSystem} ${component} received     1
