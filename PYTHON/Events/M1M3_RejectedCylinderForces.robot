*** Settings ***
Documentation    M1M3_RejectedCylinderForces sender/logger tests.
Force Tags    python    TSS-2617
Suite Setup    Run Keywords    Log Many    ${Host}    ${subSystem}    ${component}    ${timeout}
...    AND    Create Session    Sender    AND    Create Session    Logger
Suite Teardown    Close All Connections
Library    SSHLibrary
Library    String
Resource    ../../Global_Vars.robot
Resource    ../../common.robot

*** Variables ***
${subSystem}    m1m3
${component}    RejectedCylinderForces
${timeout}    30s

*** Test Cases ***
Verify Component Sender and Logger
    [Tags]    smoke
    File Should Exist    ${SALWorkDir}/${subSystem}/python/${subSystem}_Event_${component}.py
    File Should Exist    ${SALWorkDir}/${subSystem}/python/${subSystem}_EventLogger_${component}.py

Start Sender - Verify Missing Inputs Error
    [Tags]    functional
    Switch Connection    Sender
    Comment    Move to working directory.
    Write    cd ${SALWorkDir}/${subSystem}/python
    Comment    Start Sender.
    ${input}=    Write    python ${subSystem}_Event_${component}.py 
    ${output}=    Read Until Prompt
    Log    ${output}
    Should Contain    ${output}   ERROR : Invalid or missing arguments : Timestamp SecondaryCylinderForces PrimaryCylinderForces priority

Start Logger
    [Tags]    functional
    Switch Connection    Logger
    Comment    Move to working directory.
    Write    cd ${SALWorkDir}/${subSystem}/python
    Comment    Start Logger.
    ${input}=    Write    python ${subSystem}_EventLogger_${component}.py
    ${output}=    Read Until    logger ready
    Log    ${output}
    Should Contain    ${output}    ${subSystem}_${component} logger ready

Start Sender
    [Tags]    functional
    Switch Connection    Sender
    Comment    Move to working directory.
    Write    cd ${SALWorkDir}/${subSystem}/python
    Comment    Start Sender.
    ${input}=    Write    python ${subSystem}_Event_${component}.py 65.1674 1012666751 -1649853497 60341628 -557359443 1558817908 -1905391194 -1838338627 1878222823 -525269877 -146776421 1214396853 -352241921 -1682879548 -1270208654 -1510813926 1741726167 279153461 1680328101 -1551632920 682168322 276554110 800414280 1090173693 1343914965 -343275691 -1753355805 382079092 -1936606671 102033069 -967588778 471602937 -452634257 1033377358 -1489516139 -830539219 249565473 470858551 1116882940 1110138302 1515733935 1231678789 1490088978 410384611 1073512082 -53455446 698329808 -1269272320 -719392063 -905532137 1593549275 -1042494735 1002022913 986966419 -124958077 -105596533 1714115782 86347851 618901084 -447348139 2145680549 150124019 -1619104608 1609980601 -1929979805 1239586073 -1051823133 894862416 765993380 -1385171782 1875543426 985736990 96717480 85707034 -226394665 1729150838 -1275039803 -224674805 2124032250 1015429122 -870141307 517000926 -1140400029 -1051097306 496667050 -1814705525 1154291855 2007433283 -1451259493 1471297884 487094546 -1781807217 -606725433 783451591 465185360 1081689566 1390057747 1529872628 566403184 -419108409 -50595308 -1852878982 -399281066 25959449 1411478982 2000827675 1042558729 1216022339 -518328655 -1263092835 1220773717 -1572009029 -1163662585 -1839635556 -1616126976 -2115901858 -910681394 -68999424 263240789 -1863001778 -462567727 584016761 -2108976574 807591558 -1564906309 726214340 -937478516 1665617361 -513264814 -864469130 -882620853 1802621012 190759552 -697024345 1213969977 921093623 -1857428394 1140229114 1818320845 -249856217 -763496010 -2023696183 1634590057 -1492585252 2117656251 1554667750 381138288 -1836612205 -568487972 475751154 597501229 -206708287 -1915385758 2127542995 -985046720 -285761189 1926109906 2005653505 1507855562 398368285 -849895002 -1588712279 910846041 -1478035327 2121838271 789134521 1762730382 -1645499344 -1581709716 -1032754904 632179628 1365807309 1382253912 571340600 456228352 -1307532627 -1158265195 -796778550 1808481289 1554368553 1528033630 -1309756479 2093602653 -1102468342 870584958 328219056 -2139660405 1734232574 -280642393 -1344556977 225686933 -1919806815 268520401 -1781941010 1583377408 1866137163 -748454602 505519770 -530730575 -1763236421 804356111 830763345 -443385464 -1022265716 1059367142 558760274 982823742 -966908488 447160801 -211184029 -1236936262 -1129720192 1174199120 -1216964192 -684562952 901507555 903070924 -1242070456 155736872 237950364 -321717642 -2039976239 -340379446 8428850 -1245465076 -78412771 1536014933 -430200339 -133074590 144285875 879382985 -1901843846 1102513845 -840511115 -1185559015 1446141472 -791414137 1651995846 226601122 418313990 527290705 -222798097 394945218 -1966812851 -413262906 630374971 -906024033 -1642240391 -712989458 -1779350728 1656184386 -1233295162 1413768013 -1812288731 1656766150 -316375008 -2126518277 942738859 -623299048 -139103416 6416105 -859798695 1393017249 1852481121 1074459018 600398964 -1813000314 1648417491 -1632234875 -100402051
    ${output}=    Read Until Prompt
    Log    ${output}
    Should Contain X Times    ${output}    === [putSample] m1m3::logevent_RejectedCylinderForces writing a message containing :    1
    Should Contain    ${output}    revCode \ : LSST TEST REVCODE

Read Logger
    [Tags]    functional
    Switch Connection    Logger
    ${output}=    Read Until    ${component} received
    Log    ${output}
    Should Contain X Times    ${output}    Event ${subSystem} ${component} received     1
