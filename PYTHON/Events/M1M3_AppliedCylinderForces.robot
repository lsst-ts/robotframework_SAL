*** Settings ***
Documentation    M1M3_AppliedCylinderForces sender/logger tests.
Force Tags    python    TSS-2617
Suite Setup    Run Keywords    Log Many    ${Host}    ${subSystem}    ${component}    ${timeout}
...    AND    Create Session    Sender    AND    Create Session    Logger
Suite Teardown    Close All Connections
Library    SSHLibrary
Library    String
Resource    ../../Global_Vars.robot
Resource    ../../common.robot

*** Variables ***
${subSystem}    m1m3
${component}    AppliedCylinderForces
${timeout}    30s

*** Test Cases ***
Verify Component Sender and Logger
    [Tags]    smoke
    File Should Exist    ${SALWorkDir}/${subSystem}/python/${subSystem}_Event_${component}.py
    File Should Exist    ${SALWorkDir}/${subSystem}/python/${subSystem}_EventLogger_${component}.py

Start Sender - Verify Missing Inputs Error
    [Tags]    functional
    Switch Connection    Sender
    Comment    Move to working directory.
    Write    cd ${SALWorkDir}/${subSystem}/python
    Comment    Start Sender.
    ${input}=    Write    python ${subSystem}_Event_${component}.py 
    ${output}=    Read Until Prompt
    Log    ${output}
    Should Contain    ${output}   ERROR : Invalid or missing arguments : Timestamp SecondaryCylinderForces PrimaryCylinderForces priority

Start Logger
    [Tags]    functional
    Switch Connection    Logger
    Comment    Move to working directory.
    Write    cd ${SALWorkDir}/${subSystem}/python
    Comment    Start Logger.
    ${input}=    Write    python ${subSystem}_EventLogger_${component}.py
    ${output}=    Read Until    logger ready
    Log    ${output}
    Should Contain    ${output}    ${subSystem}_${component} logger ready

Start Sender
    [Tags]    functional
    Switch Connection    Sender
    Comment    Move to working directory.
    Write    cd ${SALWorkDir}/${subSystem}/python
    Comment    Start Sender.
    ${input}=    Write    python ${subSystem}_Event_${component}.py 52.5735 -933041411 -1674216962 1322335667 176183099 -802999588 1979421963 -1545161099 845429508 -779755814 1545100777 -161614340 -1006396248 -284646697 2093068806 -991316992 1649250828 1514393026 508939287 266447555 -889293262 -764078210 -310148723 -1121984496 1738148849 615374235 774388271 -71075919 -730452410 907649475 -168136182 -959517368 -249261087 -2079621460 515761006 124310897 102661070 1763832112 -1908441612 -293365237 1934565780 764619224 759371090 -995411793 -27762511 1698180234 299609686 -976710646 -170788921 1867556532 1947415011 1400081715 1606557913 -929084070 -584476156 -2035284307 3307131 221626117 493568109 523109835 1863211707 1360059856 -1836858844 104746671 322084830 990847863 852912662 152342758 -1069122634 1636418381 1212636113 -1266298087 1389357414 -2046888081 1278558851 -426545882 -1293889942 -1328043146 1293520561 503757968 -1429473016 -1630147842 203062053 880851975 804979064 1791204214 915827022 -1609674459 -793109938 1825161662 489443374 1790259586 -182932483 -541568140 -387810420 -1168945262 -311898948 1296724807 -255320657 -1937818853 -136216958 616843385 -1117974333 663506522 1068142157 -817350382 -218577855 1710427327 -312726867 767572568 1085885150 1482107666 1382706038 -1895162480 1613438564 -40951457 -897527066 -238241472 -1624548891 -1049632157 1502489522 5091339 65778268 -1328601296 848280558 -608614042 -2145735357 -505735756 579706820 -1716732166 1080469435 1226205 -1178463763 -135241798 1780335493 415572469 812992298 1283999924 1242283705 2025756973 -1488646424 -257460027 -906720189 -823360027 1999217259 1473469244 -495286054 -381573366 -884363625 761037441 420353320 -381947456 486329490 1501270132 602154024 -970917102 2109844529 207533709 -1569536827 -1115701123 -2126729108 -1507327872 -226450718 1496787749 1058128837 -883669548 -1915426556 -2056433978 -735618442 429432838 -2099469540 172240029 1047621968 953314100 356471453 995484460 -1921691363 1308169462 1312043480 1407401445 840957675 1646224091 -1385020537 5110397 1504856890 2113885031 -96498442 -874356333 1064673829 1928516112 1586096044 317221185 -849812194 1976294901 1221539092 1230993551 1309178988 -1106977272 689581428 -225243370 -1636716417 1015016336 -104295607 381717971 -1774813253 563165294 -464348445 1425413303 1859779550 484314665 1528591264 -1278576901 -943752957 -1639565876 1671153314 2114844673 1859723026 877510267 1070344050 -186205598 362866588 -1270272247 1819342742 -1419113776 5616100 2107847335 -884286449 -67420456 1704237625 1169789781 1003456542 -10677017 -1878414060 -895343728 533329234 -2007091046 295917532 -1142405586 366340438 -284987197 -1129206595 1939766108 1817863098 1616236361 -1936995291 -247066521 -1848107456 549630088 797621636 -676924284 1719718991 1368173772 -1330049571 381632490 -1368725155 1333399575 -358012132 1799651755 -1968198540 19767239 -1082702707 19393965 1890951165 8515907 -683505426 44657104 1235168186 -1393796047 1332418966 -2006748807
    ${output}=    Read Until Prompt
    Log    ${output}
    Should Contain X Times    ${output}    === [putSample] m1m3::logevent_AppliedCylinderForces writing a message containing :    1
    Should Contain    ${output}    revCode \ : LSST TEST REVCODE

Read Logger
    [Tags]    functional
    Switch Connection    Logger
    ${output}=    Read Until    ${component} received
    Log    ${output}
    Should Contain X Times    ${output}    Event ${subSystem} ${component} received     1
