*** Settings ***
Documentation    M1M3_AppliedCylinderForces sender/logger tests.
Force Tags    python    Checking if skipped: m1m3
TSS-2617
Suite Setup    Run Keywords    Log Many    ${Host}    ${subSystem}    ${component}    ${timeout}
...    AND    Create Session    Sender    AND    Create Session    Logger
Suite Teardown    Close All Connections
Library    SSHLibrary
Library    String
Resource    ../../Global_Vars.robot
Resource    ../../common.robot

*** Variables ***
${subSystem}    m1m3
${component}    AppliedCylinderForces
${timeout}    30s

*** Test Cases ***
Verify Component Sender and Logger
    [Tags]    smoke
    File Should Exist    ${SALWorkDir}/${subSystem}/python/${subSystem}_Event_${component}.py
    File Should Exist    ${SALWorkDir}/${subSystem}/python/${subSystem}_EventLogger_${component}.py

Start Sender - Verify Missing Inputs Error
    [Tags]    functional
    Switch Connection    Sender
    Comment    Move to working directory.
    Write    cd ${SALWorkDir}/${subSystem}/python
    Comment    Start Sender.
    ${input}=    Write    python ${subSystem}_Event_${component}.py 
    ${output}=    Read Until Prompt
    Log    ${output}
    Should Contain    ${output}   ERROR : Invalid or missing arguments : Timestamp SecondaryCylinderForces PrimaryCylinderForces priority

Start Logger
    [Tags]    functional
    Switch Connection    Logger
    Comment    Move to working directory.
    Write    cd ${SALWorkDir}/${subSystem}/python
    Comment    Start Logger.
    ${input}=    Write    python ${subSystem}_EventLogger_${component}.py
    ${output}=    Read Until    logger ready
    Log    ${output}
    Should Contain    ${output}    ${subSystem}_${component} logger ready

Start Sender
    [Tags]    functional
    Switch Connection    Sender
    Comment    Move to working directory.
    Write    cd ${SALWorkDir}/${subSystem}/python
    Comment    Start Sender.
    ${input}=    Write    python ${subSystem}_Event_${component}.py 26.4917 -812752638 321353540 -1187634909 -817228373 266980707 -1262280555 -1059811941 -2013321974 201972816 1574292011 1848165264 -2080637062 1807094535 245269847 -1867866469 -68922661 254377040 -474460690 734629927 115905174 -44379758 1195245278 -1634105499 -343114168 -587657564 -1520484291 -1760131009 1748359263 -1349263915 -1736989529 -1682374218 1832335307 854279364 1238966565 -1745943485 -2111366691 -670800954 874783131 -313498519 -545649670 -1988721513 -556599317 105493377 827908856 -1410078978 1440727620 1825103434 1377198109 660193902 418594532 1847296771 540120774 323843786 -1069393555 1811888167 -1720380895 -1357083095 -1306513601 898287398 1660438824 1649166492 1359432491 2015025999 -399798123 -1130142564 324993016 -1437450433 -754972131 1828527857 -1630545733 820770961 -1178621598 987792585 -993145995 646701176 1385333359 -2067984901 1640423801 2080803767 -1038463758 379288577 -2080126285 -1493782945 -321385537 1226229606 1278943187 1956189041 -442072968 -1093524729 2001194374 -1367870835 -939762906 502916218 967396449 195340527 -1732237680 243439514 -1773174581 -463925350 1812668464 -1562356293 819417329 -10081553 2142054345 530116297 636953696 1184760733 356751885 -1841585461 -673195532 -93264534 -1387890655 965684975 856523904 -1120728307 -1792617161 -670045025 -1761460130 -784895505 1558364017 -702309720 1251763615 1263569972 -1805333883 -607980959 703659586 -694186911 -1728687109 -1597403539 1155631894 -495522064 545789064 -249905486 1374014256 22994520 -1696062952 -264739108 -1503406099 -569847677 -839588262 2144166825 -619609945 679798783 1749966694 1406780467 1096648131 -396316306 982251887 602662614 1537193011 -1392414246 1742238367 -304557121 731564247 1223039335 -970417076 -1232074533 197760141 -1364438926 -1765619120 -544925789 1673010561 11101395 6115725 1397242464 -615217200 -61380296 -305168432 -1414682947 -1453239418 1911298240 -144994672 1177395698 1618584783 -1488448104 85968135 -48797882 1977301836 1101953247 2107166320 -1542799216 1161894742 -575557285 544823882 -518744441 1210254538 -1553783125 1351819350 1173071783 1577311463 1603314536 -1785433761 1737818547 1390355671 -666856854 1369794312 -1347706776 585631381 1721596992 1679370432 -144302220 1936213751 417148352 1765629477 1295114890 764140922 -196179699 -1157383930 -854197452 -683175127 1523005424 -1320244213 1860473643 -509003863 715615941 -2062591770 -171331263 -746068286 -32727321 2001720457 1916539508 -1146156449 642666923 1334864105 -929857179 2015596560 1469069560 -1029802645 -256705597 -875678086 -838289625 1427208033 -2029920443 -1968061416 1845680604 -1977649359 1748014035 1604246577 282297769 -1698409071 421086942 -640216896 -1004227726 -248703839 -1426759285 -416975588 -1388796588 1660957659 -519072841 937209027 314557546 -2105221274 186771955 -1969652007 -915463143 1213086665 1540883660 1865069545 1354141251 -1061154892 -1050786752 897593578 2096294217 2081650314 282097809 102253636 972032419 1888539875 -885552982
    ${output}=    Read Until Prompt
    Log    ${output}
    Should Contain X Times    ${output}    === [putSample] m1m3::logevent_AppliedCylinderForces writing a message containing :    1
    Should Contain    ${output}    revCode \ : LSST TEST REVCODE

Read Logger
    [Tags]    functional
    Switch Connection    Logger
    ${output}=    Read Until    ${component} received
    Log    ${output}
    Should Contain X Times    ${output}    Event ${subSystem} ${component} received     1
