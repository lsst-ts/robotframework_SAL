*** Settings ***
Documentation    AtScheduler_target sender/logger tests.
Force Tags    python    
Suite Setup    Run Keywords    Log Many    ${Host}    ${subSystem}    ${component}    ${timeout}
...    AND    Create Session    Sender    AND    Create Session    Logger
Suite Teardown    Close All Connections
Library    SSHLibrary
Library    String
Resource    ../../Global_Vars.robot
Resource    ../../common.robot

*** Variables ***
${subSystem}    atScheduler
${component}    target
${timeout}    30s

*** Test Cases ***
Verify Component Sender and Logger
    [Tags]    smoke
    File Should Exist    ${SALWorkDir}/${subSystem}/python/${subSystem}_Event_${component}.py
    File Should Exist    ${SALWorkDir}/${subSystem}/python/${subSystem}_EventLogger_${component}.py

Start Sender - Verify Missing Inputs Error
    [Tags]    functional
    Switch Connection    Sender
    Comment    Move to working directory.
    Write    cd ${SALWorkDir}/${subSystem}/python
    Comment    Start Sender.
    ${input}=    Write    python ${subSystem}_Event_${component}.py 
    ${output}=    Read Until Prompt
    Log    ${output}
    Should Contain    ${output}   ERROR : Invalid or missing arguments : targetId fieldId filters grating request_time request_mjd ra decl angle num_exposures exposure_times airmass sky_brightness cloud seeing slew_time stage offsetX offsetY priority

Start Logger
    [Tags]    functional
    Switch Connection    Logger
    Comment    Move to working directory.
    Write    cd ${SALWorkDir}/${subSystem}/python
    Comment    Start Logger.
    ${input}=    Write    python ${subSystem}_EventLogger_${component}.py
    ${output}=    Read Until    logger ready
    Log    ${output}
    Should Contain    ${output}    ${subSystem}_${component} logger ready

Start Sender
    [Tags]    functional
    Switch Connection    Sender
    Comment    Move to working directory.
    Write    cd ${SALWorkDir}/${subSystem}/python
    Comment    Start Sender.
    ${input}=    Write    python ${subSystem}_Event_${component}.py -26823092 1378839114 LZmSsNSdaOLnVNTCGbPUiLGmfuInjDPcWdQtwPPAcBNHigGZOazmqjULDrcctQKqYhJiEoYqzKhFuDaLrQfUfVqVPjETTOVdXugaeVWTKUufCuXNHgRSogdmMvvKbeoesubtZSnLqdkVMYnNNZVXWqnynRRqtQwMmcNLvnnRJyHpNzebrixeagWTJKStwjbGBkuYpkDSauooqdfzbEscuROOpGtOVoRvyhlqJxlpnmnMxyhrtLWopeJrYmbZcYFCjTNitUrxQRtIqINPwbhwxoplEAOWOJk RcEwTRiPUtZmqJsKktQdVlXVKamAnbivHdgHZDvtZckBFjlVqPvhWdRjEcNyxbDPDoqXqBMehFpnIjXFrHYjCWkUlFJEmgLnmtCWhzAlpUVHLOKWykLqyXJbNeEboYyITQQejNVNbLsFVBhgYtwgjmNYG acBPhFdUyJcHqauPwDXTjnBOVfSVmWxqbZmPxNltGsJKjzmycFvUWHRWJjhMbPynEtmOxlTdcMeOxrmkOIBREjZNbcsLhBOhrLHuJQRZFueRyPtqamUnaXZpWfNDHiHPSDtyJVaQYYlGtsrObOWFBbFFwgwRsLJSKuaQGBzEQqPvuRhxVyCeSLnVTmTGpgFiUylOlTXORCGGuPBmuuOGRmyhFxauNxcKCcbgrXgjkAAuTMjsTUePmgMvMvSBPRPfEXrEiJBDxwGwdLHbTxbermflSveXcFHlfwLEAVWsREElzZhaFsaiooTaiiZiXMyDGTbcyjRSRGgpclMVdKPZZskbbsIVGCAtrtSwjfeEdRzYkGvjZxbjMXrFzSTtVQzrMTKbTqZhOjtVDUgqrobOHIBftidpJwQRBlDFAkpPDYsKHehyosZYMhBDmIhDnXwWKxDhJkIQVXaGYWYBCRIeXhitMVOucdwbSCOsKliGcMTiuTaqlBLmwcUiwOHLrJvMdbRcBtNfpONkjdVgtELVMwGlBzVbMbIGNobFDEqFoxoXOqcRBmHULzkVPwWnPZWvdIirDpmkFbtseTMFHZEYVPcyLUMAPxlBExZIRZBqObMTLqSapTSjWXWpohEpxeSmCpmpYtYMcmNhAYlJyoZeDaIUbuqwqKxuUpOaCljEEUlwsUbopKQVFmpkfVUbiaGvtbiGIZuABWYYAVBPuIsJtxrdmqoKQOoCBlVKrzZrajObozLaFOabWvTcHTXbVdtdTgYohLcFEUuzhyUBIevE NtLneMvEWpOYdoKeBcseyiRUbclXHhQeNLPbLLmCRIduzFnKKRtUtqYtsJEtRPXvduDpkTltmKietzWSkexaIVrxEdZVSxMJTbokzIuyZlJhfYBZcGtXKhGrHsYOPFbBMhjxurTaUsUkTjLHhNxvHslJJlGpIwkLWfRrCnueBcrozgCMXfWlugqEvWOWEtNetVAITCrUGPOjlAHieOCVDWNHOKAjGYDaIHxbSMIyhtQdOitjqISpOHduaRpuywaOJzjgjyMVXJnEUwaNOeiObsSHFzIzqNNrgEkMsRLiRXAPGPEnsjzuzxrCqJEfUuJfsPCaRwRtTxMGStMUXShfaUWKrfLNZLySvVZYqEMVVtNJIFJOiOzTnawPUhUloGohIosfmAmktvorlPsCNdKSbxfdmBKMBqAHGRAnQf SFaLSnUILiIbygZIrgLMQVZuaTnzoJSmUqrRJdxamIVTLqMUpywLDIQlN DZWEtdMatdgqeUGJOIMENVdqfdSjYtfvZNGwWJbznAgMLtIgTJekZQVWCwUFmoKQEbTFEqhFkgEsvqHVFwMUOAcAtaTdwwbVHTkIoaXLQZQdlfsEmmYlVSFSdaAZQxnMOZutzQUYDhghqCigKGogENokgNDCWLcdYkUfciKvecQEVGKJhdCrQnzWWHiWctDAYVffXWhwSIkWHOlgKpdxLQqHRUniVjAbJDyIaLWbDQcMJdVvDkGrYJHWNCriStcocToZzkHhopUiotbiSrRRdyAOhSMpmtoHbHRpmhULlTajMkPyopFcHsydgutuUYESTwhqTOkXTSYvsLdgOAPXacwyNckYtlTylSMrIbEXFlUGJwtbCwUAWbsNzaJmUVSOPJbgWdTCBBtUAdjdgmCRGAxyfcVXTNRTKZyvYMlJxLADONoyuPfQhlwgXGHfSlkUSAkKtpmpaXCQZHQCqXBYdwcLisnIdSPrpzRQRkmFCtxbjdtrHWYCuyytuUDKMqktaFQmlQmiMjyqCVVKviprPuESZDNKFloptqrCLzrkvduOUqeAUMjLAXStUXDlYUVkOuYdtKmPUhJYZZfcnuxydDxvoCLrJKqiHicDHQclfzYvSmFZAdoWbbozKqBogpSuRvwFKITaqriJGbXPooZRtecraDSeoKscUezQbCoFpsJRbTJRsTf vfruqhXYUvjSFTTVxuNPPCSIcukrufCcVKGUHmKGOSEWiPWfxIZCcnmJmSlsNSkBVIessyWZqJRLKSAbAOcOjPxXrUccQXdkoZzqtXrgEPbJthbcbaSwaZxbzvyTUXiufzbfHaIOTKXiFYBSRrcPmszYQIvHCKpyDeavytsrfprTGzozoaWwIuYzbVJntTTziGxLcyvCNfSIUaRUJuWRxNLcqBZoqOJWuGvkMkPuMQvLhBPQtFrTbeHOjYanQVjkNVCtQixJQtheAhAnHpcRCskCuyhrQdTkSQvNTLbFrjhmEStkmlClCTwYDLwSvEKjLFqWFH oVHyBfgFQGqGhxsygLcNYNIjGCkyQAHZTYRkemQYIeyCBZzOpeqmEowFJLFZPcrUDGLOSqjMITaRCnNJiCndjNHpMPqnHGzwcuOBYuNIpCfMQNVwcYfKKGUsbLwKzBkcThwfSNjCJklXwSwQkcMlrYeGXxllGLSFQQkyolGHZEWINSVXdPZpTxeUcDVySosEuUbEOMwZdJzujaygUqixMNmOMPHDuVwwIXtjDrUXswfAdwJayWkxSMCLUsFjfrxtWaKDgTbSaGcInEGfUTFtDpFoHYoeubRtXCZmdCZSjUUiVmNGhdJPlXSATmmvjuGdlHcucpohgmUqRwEGlZKYMhCTikuMsjhQWnlryrkEdQjVYePyGHihXmHKjSsVllNVJbmqDJEpvmeAUQBjBgRVVLcyJTmnubXiRGOuOgiYMrRdgWOMZixrgBDTciUWoZbuWMQXodBxNqPXeXwrPVcyBBiJcGUxQiFivYCSzhKXjzwDTbjRPWqXLMRoppVRDDVZhUZoHtUSefboBbKGBsgOiaVOnUfNhRgQNKJisMjEXZjIoWVMlXvUtNyQccDPjcbQqdtqQVLlzNsMLKugUKLboqaJbdBVDBvfkjDzyYCzuCPVwgXdKTSfWtWfEDrBjvobvZSpDoLIecosxiJeOFdcEyNVOHpsZOiwtcpRtPxqJEqDhnaSIiMMmoHgaNxhFvMgNPnLwMtCUcUVnyXibUmmOMEDPiQpYtBYxqLinMfZyEjxnzdiOwLVTWFFgbrZPkOaUipGoGqtFwbdOWJMpPDZVIlqToifULGxRQsCIiTMivDFdpDkjSXxvLBlVLWLMTauKqBFzpVKPKHYHRbRNivnxZYtxEGDpibogknodBYnfNUNHZxcmXbzRUNmipQQJhRRyUWovgyrGINbxhZQAhGuGNijdxpynJclrnaPHDwJKNnDYeQTnaidwqujkpssZrWG vtHiZxjkMKBCVdAJKNYZxCpypecvypTTizyeSSTOgwjyTEmIHNpCAUtZWKmiUgcOkSDOGtPIimdeGunenIvZrAQTxLnBVYewIFMEkUmcaXqramIiOTSrCQgpaMumxRCjpBcWGDmPrNWbVbKNlFCmOzBPdUJjqvpxMDZlfPvsQnZaRwBMFPrInkEPMQlOJRHriYFWtmYjXMWhSHXunOCppkybiAxxNLwJdrOxwYmlnpSPoZQyyjdukDQkJinrvZTQexAtqxYqgCzmBnWpneIzNhBOOSXTIiGGFRduEnwtHXSCgFJjvkNHGrBpDpbEGlLaCclgOGvZhmDnTuYuwLDGBScnQMvoatTfPEUrxgwLxTsPLwhnYJizBffkETuZyHwOLEfNmPRsTrCIuDnbfmWiSdLXjLNGJcUBrprLOAfeSMCQSxYhnjIbyZsTkNngiSOsXwXFMEwjdXpVMtDBFLvCxAauDMVKzfzyQBUnrVacTHKuYUNjtZMnZiXIglQHLHfstKoIxsOzRxEUoFqhhJJPcyqPDFFEKTqJopBFYAvvTzgNaqaxQyRKFjyLYuQmBXjGgwBLcBXBUEgjhITklU muvhMnUfSMoyWddXvVTekUoazBeBbqKaPQbNdgcnbKDlCgTBwtyCVbYvelBIJAdncpkxSvolQEPPKKgNlDhkVphqLSIvqeDSHxthZjPaFMlNLgZVGIdbjMJDFhvSNGKUvdxcppWGEjNvakoBjBbJgVmjiWWrtBgyqbGmQPvTcQGeBzKNdhhLVOJAViCTIXmIfNlfPROaallXtHplrFGxQHZLQiBccjHuBLPDd TDIAuqBYiaGEzgLyJUsgZRdjIrshhvLtGgwuoFdddNaNkSxHOkJJlOZGrUhNZabQRabmcQkGgietCuLZZIitFexOtCgGgqQIPgBuYdMyIRzcfuFygayHjlcDgRgMpEdVZVqbyQMMdlacnLrXYSFSjxetzAlbNmtJlaJFwiDfsRcdNtClAITFUlQTPebZMaiZQpHsfdPjAGEngpiwFlNDggWUnZoMWTKyWMltSeNulaFUJRIoFwPEZqDjbgUDqTikgninyOFCDoSqXluThRkEacwnXSnwxnlMzHWBFwDODfyDurGOxWdbSOGotqHLFvVPNDsTnkSKXrroGhKAHUfhODhyAKwWUUurxyRkHNmTTdxlgXwohNsswVgFkHtlqDLqBBdUZauzscKnKgrPxStKvWrOGQYYiswEPACKxhxJeDuKEbKewarvcdpsxGzEDfyDyxUlPazJCMZigvReAZtFsaRvAvEwU ODugGCdzNjCvMFXeJTOGztMnuilErwmZNhCgMMroJYBDZNNkuEubwcmivDPVblJOhYEYYxhodUKWdMcROyFWGLdWZztScELxZqzeyeyfjvGMUGm ARmmeNwWYTtzhvmjOxRUyeKoVxgqREmuWrnlmDCoHLnqUAMUiAgHZJkpxLacnWxhbbbkrSXNqvoZLZGqxqcBSeqXPdUKBbDZtvzEMPQQEhMLjiXTNOwDJVlpoWUUsckHkPWfmbhMNgKvPKPGTpytHRUVpyOJPjVwOlyHmtLnvdgxKPHdtUBNUplGrNnAwTwvzCwEBClSVGQlgPDCWBkYuaiyNcFkoAYkXPFXAWhYwxMTSrTSaxQTddTkaaPJwQrVEIEowUqhuegrePKXgjNODGsrHevBUekqjqbYSfOnPdemZEsQrpEjaedQZYGnjdhCYMZkzDEYRpBxgJnATZEZQwMrJntdRtTqtnGAtqCnyjoaaFToQhQbrUKcoMfyPVOVZApCldOkPmpQXIBxQemnnCBuPGqBRhZooeNexGCFecWogURfEDrJqyfdKEqbnIttoloSfhVwxBsZVzifaYxiGPDWQxdyNsIavBSIfhAtkGhvZconewqEVDhBbmasSMTosgaZKrCOrNhnDNvUZaZVAVgxFvWKRHcbjHKRHYvfABxHSwHaIFKuPFzTENtlBfCjnQDKRgMUBKEfxzmyuMFTAWuChVpSOfOnyAagKQmpIULyXDuigyYJCrfnKdkipjIDKcEyUZuWcKFyYFgxHTjLdZGeRuCcaaRVhOUFCaticqEFUFGqyeaiUDDFnCDgtvgsrtBQKjLQtjMGOtToLVyYPpgbAwenaYinQwpsnXJLnl xaToWEmzNmmJbzdKIlGObSlhVVJxbxBhORnfkVCMochaPISeWRwCyOEkBYcLEqJtWMqyRjtydvSsjFQUBSIXZAvFNSuTpQdsLNOpmmZYzoMNNOPhnImECLeQPCaeNxskKnAyZXfODcoytniQQKnbNJyckdQqtFHPpkZkypUUExpQhNNRgNrVArQaTFcZMCNCnrtkyteKvzkSNDUCgbsGvNaAnpNajIfxOvKXcQklfxXSooNCJTktPZFKuKnbWePeIiVbjwzRhYsqoOuDEBPSviikFydTnfPbaHgELIQDLCwVqpCTqKzxKUGVdoMSJnRjvpVhDYaedTkMswCKOcUczknjnPqyuAKJWGcMTmMsZelxPHnwJpBJDeGiABheNDzDxhDnSbfouzsZynNJtnNQLTTDvEvVtqeSJbRNnQZJnnPgElwNmceERmAbXKZabNcQTPobLFeJoZCNqgnZLWWrWxnDsboabDQhcANGjVEWUGoClBjaGRqCHNrCGKGKWlfwPVSTrZFOkqqmOgWZIBMbZxkRytVjhqXDdVEXHvdEWAmEZDVUDDGsxReBImBhOpNbsorCytsFMUkrfyKDufRMHUVTivNAugijnYtV DajixPuhrrIVUatikCbQBEYCccqIAZjiwzgNqEZdYQwHClMvTKQoeRSlbtTWIiRKrdPpNeqyPhYIWgRrjhLsEykpIgKecpGdSFNbSFYwOMqHTlmepyGfMXPijmkIsCHePwWRnjWsuePTsZhojhfTsGOUjRQfsjtKMMeMXaLeUsvpLtsAIXHrYKqyisXCrIlGAcgmMBMOORjJQBoHxpZVRWekhUYkdmANVOmHellGIXtslWfXpDoMExE OLfxWkDYWgVfoHeNqsjxFaORouxxjUvXvcFeYMEwVRuPwwTqcOPhIACuqYqYKXySxJjrWistElVMubIVObGPqOKbAvliCNpBPybAwRrNPjZbHppIyJWEemsoIrgVTMjxGJoRXtKLVduRpyDIFrLiMGLKnvCxzeuujXXvrDTRUIjvSgovDCqncPMmHURwHBbBenNMmjXSaZzjZXnairBwZKPAinipYkMnZKouXbPmNaxhgysVifjYIWesSmYzRclAiFjxnZaoIeYYpADXCmiShxrFQHMGuZYcLwAeLdSsaIojrZEWvOUNnwfCDCKYxzLLDbpOGlcBdmOKkzuVbJmPucvRxKikAmpWtyEgtRCTfZstSisbGokkwPwREmzfHRkmQpJtaGpYXTuXLCNnIesnzodaDpkAHJTINXYzhQHPOSMctGdQJXcADegPMJLfQQQwjbztaTIFhwAsuuRayRDNlaoJlraXHtlMnJvazjvcumbSCoUMLjORmPDoNIEemIXrAPHlFZVcgjFZfuQAOyRzZRXxfPyiUIRIIUBacdnpMcoxwTrprBeNwPbMKBBLgyURkHZhAdgCELYlKwaCaCcMPRpcgTWCVtNiFnnMuGWUsfXHVcPVceRTYathfmceIlSEQscgyWcFxSJKhZmiYqmVVeCfSqYJjnJnveiTnNBZTEGafyQaNHSICFCDBquyAjRFfItJFdWRXcIdUamOQsNdkpcmQAMFqlsNnCCSvlqqBOKuRHJNBAfsIqInsPPzxNHOxhwEkcMmWUqbMCMUxwnkQHCmwQNmdDVQPQRtBpFEaMSjiQEwctOQlUoGhBhoqlUdrcMftmrubUBYRPkUtRyyFynGsSGIzMSVPAqtJiDryGOevDTwv GIFVFcGzeljPOQsETlGYlNFajsMLqfWuOpDFzJMEfomOHwtFtrTsmtgrQIAocKjybgOCHPawYxHaGqtpZSkXzQuMdqQYyLhIqgNsOFLsCJLyOzjUplWhMLZpPYcRVyatqVjCgWvWnAOxdGLuxhXlUZqWxpYfjftePQocdgboQvmkwEFKuyFJYPXQwZtWztqCVTyOJtJAqZKVVrwjcViSUnScSxMViighqVtHZuYBoLqPmXkreebqGEVRgELPIzTcmgfapOXulwqMoObSDgqOsFaxtpgyYRlJVuZolCdaIjLdGkOXfBAZhJXLwgSjABueXwbrglWzKuckUuQMVJSJIlWfpkxgKBeFusWPewFRmIgOFQRrTgXravBdvRwhOpiCXklHusMkxKwMehZwYGfsexQOIXZYtVqQbPiXigQmdbhlkifIbqeEudMzxEozuHpgqQDnkeVyXhNfefyKBWAKgBexiksOdtqQJQNrXhHWxIvVBELSqQvDtBzYODSTyCAeVmz unFIordWbYybgBagOnmadXjlfUCQPGMImsioFboivTDoULjzxgNegigDGPAnUhcmbhcBMzITeWSBvtujudgwnXRUQtzhSRFOUpEtOMoLiIRYXjXWCwSdKVowMkSqDzwnlWnxNyklzOLFBQBIMmVXZX HzdhLmWeZBQrlrCQIzyJYeVWmMioOVDfrjdJwyYfoOifsexgrEpzZOjdCVHiCXyWJVTQgAQikSgMfkRYpHDatooscYqFBZKaNBRTVNaZczdZkxLBhdwRhuvMMTATVwoGZxoZPSmOnQoCcpUlTYYvuUtcbCUJiHdcMUqowcxqxYcffXVWTBEYijrfiNDZqjJJOwASMJnRLPeugdYXxEOIaohyybcNEFnOrPxsDZaMIHNQZynLdrZrqFPOLtFZvqlGncOmeDXIviIJJXgSGDMJHYwbGXgaIxajoSrfSzsVJJSnRRqArxzlpVxJXiQhsxIsCONHjqCLKAMapMthrelRrNCooFXWBQLtSuduyxuJwmjkRayRHOAFLdbUtVmWobTFmVDFQWxiJUrxvZLHBeBACqUnJyhAtpSsZIRPpylGgrjSBmJiFMCCScQrSoBsFGHrjToBChifdWtuHQtrhrhXpgLbQMYRTjryebrWXAhZLtxZcRKpkrezlQjvDSmELMwXkwPOJtTRZiedQgPRHeWjYuNGNhCKBrSyRjWtdtkOFtOoBFoSNKuYPBWPmVWBOfwmcTLABdOWApOeQWwFOmhUSUtdWYdvTelxdqdASNYpQMBKPVSgGWvDAtXozglsMxYwZSWfSqIvTFQnEDHUHFlNkLVktxLCZPFATWmfBLNoIBKlnVCkUvlfOesOFqqQdrBvlqpNKTFVEacZaJeYogLFNMeTDWWmzHQnlbtMtEieCQKBixhlWwNcLwkfUDlTOrXAAIqbIDQUGeqMZnPM mCpbVfqzGBSFvSNryBmViasaNVjnCmePWyxlCDMkviiVcaoDccqiugMCvHCWUzndpdUvkMcpOhroBoNKYHbuCNWDayiuzCiTjrhMSuqqdODHoqFrAabagdzjqtaFDzzyJhCUCSpJKnBpUUBrIYGxkutRPdnFgvEcIyvGAcAYfdtJmsHoVjOUNEeevHqFvbRqjDyAVMVBqPufnJzDJrlFXKVWzLbVGNUAoCqnxYdzBCKGzGYGIRUUeJTtnuQajWouiITgXRxhUoxOzDjgMfbNfdPEubRGgUnPfPtEqfXIYTNmzgvoBILnLToRkuoSzOBJCgeRISmjouhoCRlHRfLrxVZxMpuLSfNPybaPYRSrGEhtoPaZxuaeFhXivbMjxwHWbxhRqrIOZJSlpwaanzPbGbxmGXKjlylILDE 28.4657 62.6411 33.491 66.9395 68.2252 -413590326 429613765 750596240 1024922880 -1508184107 409406436 493950450 -1195610291 1141350037 -367374401 -147207695 27.4365 83.9911 78.0387 4.3313 56.7178 0.960442005323 0.939413827679 0.749525755971 0.825731671929 0.751724107933 0.652343879093 0.961636983898 0.625068902761 0.735588972883 0.492968707795 0.282374246232 0.317072391196 0.56392850127 0.560992238624 0.209580465298 0.25983600681 0.385264149767 0.753054121726 0.353349734293 0.278926073177 0.136137632777 0.159985682698 0.489618464509 0.190999729565 0.173841637914 0.0940738878456 0.0518271289687 0.0480684588668 0.408924742991 0.697881983663 -100789333
    ${output}=    Read Until Prompt
    Log    ${output}
    Should Contain X Times    ${output}    === [putSample] atScheduler::logevent_target writing a message containing :    1
    Should Contain    ${output}    revCode \ : LSST TEST REVCODE

Read Logger
    [Tags]    functional
    Switch Connection    Logger
    ${output}=    Read Until    ${component} received
    Log    ${output}
    Should Contain X Times    ${output}    Event ${subSystem} ${component} received     1
