*** Settings ***
Documentation    Hexapod_configureAzimuthRawLUT commander/controller tests.
Force Tags    python    Checking if skipped: hexapod
Suite Setup    Run Keywords    Log Many    ${Host}    ${subSystem}    ${component}    ${timeout}
...    AND    Create Session    Commander    AND    Create Session    Controller
Suite Teardown    Close All Connections
Library    SSHLibrary
Library    String
Resource    ../../Global_Vars.robot
Resource    ../../common.robot

*** Variables ***
${subSystem}    hexapod
${component}    configureAzimuthRawLUT
${timeout}    30s

*** Test Cases ***
Verify Component Commander and Controller
    [Tags]    smoke
    File Should Exist    ${SALWorkDir}/${subSystem}/python/${subSystem}_Commander_${component}.py
    File Should Exist    ${SALWorkDir}/${subSystem}/python/${subSystem}_Controller_${component}.py

Start Commander - Verify Missing Inputs Error
    [Tags]    functional
    Switch Connection    Commander
    Comment    Move to working directory.
    Write    cd ${SALWorkDir}/${subSystem}/python
    Comment    Start Commander.
    ${input}=    Write    python ${subSystem}_Commander_${component}.py 
    ${output}=    Read Until Prompt
    Log    ${output}
    Should Contain    ${output}   ERROR : Invalid or missing arguments :

Start Commander - Verify Timeout without Controller
    [Tags]    functional
    Switch Connection    Commander
    Comment    Move to working directory.
    Write    cd ${SALWorkDir}/${subSystem}/python
    Comment    Start Commander.
    ${input}=    Write    python ${subSystem}_Commander_${component}.py -23544 -6277 2244 10422 -13489 -19828 2697 -28085 5485 17021 -6102 4783 21125 -22271 20055 -21951 24726 -9028 -28767 21028 10336 -21191 8111 -3474 9704 19875 -11595 12722 -8230 27171 -25952 30926 2122 17929 -17839 -19867 20024 0.204704636178 0.754896047104 0.961915317829 0.777720918412 0.183692967491 0.662031459657 0.0455897720202 0.936902639146 0.414628138155 0.729343753014 0.763732134512 0.662547722724 0.229840043604 0.654408750922 0.840770994328 0.578493384751 0.305709645462 0.193236496669 0.351201871226 0.942832821726 0.76695940967 0.807966390187 0.696696096749 0.164941639891 0.698260004684 0.265490950198 0.448748895224 0.690473967326 0.757575888905 0.446011346923 0.569096110896 0.151575601952 0.233425571736 0.11119661804 0.0329727386633 0.784760305725 0.531020716198 0.910827492081 0.83156432346 0.0381959388742 0.137308574229 0.828248802459 0.966218011469 0.521992464858 0.409862514744 0.59935860274 0.607551700101 0.77826464701 0.036150570851 0.378526740853 0.11903932084 0.37354890633 0.886279814842 0.151486485084 0.165576584671 0.806373160265 0.229657160542 0.652281482939 0.932922069626 0.481505256274 0.236778032266 0.215269824035 0.397931546585 0.663781577804 0.259338424933 0.802235370969 0.0933849195889 0.0181574179274 0.247579472019 0.460279285091 0.518436512121 0.591998708767 0.435819482785 0.789883188436 0.208469108603 0.654324353405 0.916237206396 0.94078011067 0.697149674732 0.962790198868 0.990949911819 0.00998128364161 0.174158916614 0.487865227605 0.551490105979 0.515421099447 0.386428935244 0.84568746651 0.0807384528726 0.0598196275085 0.879880501131 0.869531268772 0.751562918457 0.0161283177666 0.549179078292 0.380300634125 0.702759126228 0.00485282800647 0.282228291712 0.396188103426 0.605503928734 0.0890115556681 0.81815145703 0.16148174727 0.932236741832 0.444734165794 0.367696247673 0.0373532580688 0.578571448203 0.682935180913 0.950375752797 0.608254387787 0.573692445575 0.308260507734 0.600634978548 0.300171035926 0.880138778815 0.277217715849 0.840001388368 0.931154708984 0.466973317047 0.660719583422 0.519386702716 0.214016338216 0.534976166056 0.0548071560747 0.941206329822 0.781500707091 0.169956153086 0.302145853468 0.0480989482842 0.187757613946 0.887730057252 0.737648957682 0.366849940214 0.979086923163 0.603945029552 0.20218902098 0.233500841247 0.108532592887 0.131531700701 0.504854830085 0.504378930835 0.570510358222 0.456318734127 0.813209134824 0.232303392011 0.233881466515 0.589382129721 0.519292857513 0.340198543902 0.901123584614 0.636174849939 0.176162487673 0.303775595188 0.686981215433 0.367729383557 0.0190309082812 0.970748191694 0.707755782432 0.921557498544 0.0901097326177 0.709018460889 0.205872815258 0.978268483517 0.268902744929 0.654643205775 0.990916358684 0.25377543592 0.028390620451 0.106673396592 0.475712988219 0.418325189258 0.759413887476 0.0992465617372 0.173900805235 0.887727104955 0.609393108882 0.867146227273 0.73636660287 0.491604445067 0.088112111276 0.937813457631 0.834678444773 0.494679074171 0.934838889488 0.632038530497 0.967331395606 0.198064889686 0.774596593508 0.128158754396 0.679808342559 0.672326239266 0.676444983351 0.824251280858 0.0135050496892 0.353245851902 0.509594164556 0.361846038432 0.214976946308 0.875050252267 0.96774844369 0.635138798891 0.0379231393354 0.678896710555 0.656172885757 0.872193626357 0.556788122156 0.492651848662 0.853507063844 0.62848535214 0.811936391299 0.0993080015753 0.460322248309 0.0268159691233 0.185499444802 0.144119240559 0.961675834589 0.118886057226 0.0143425959334 0.459087541848 0.158369903953
    ${output}=    Read Until Prompt
    Log    ${output}
    ${CmdComplete}=    Get Line    ${output}    -2
    Should Match Regexp    ${CmdComplete}    (=== \\[waitForCompletion_${component}\\] command )[0-9]+( timed out :)

Start Controller
    [Tags]    functional
    Switch Connection    Controller
    Comment    Move to working directory.
    Write    cd ${SALWorkDir}/${subSystem}/python
    Comment    Start Controller.
    ${input}=    Write    python ${subSystem}_Controller_${component}.py
    ${output}=    Read Until    controller ready
    Log    ${output}
    Should Contain    ${output}    ${subSystem}_${component} controller ready

Start Commander
    [Tags]    functional
    Switch Connection    Commander
    Comment    Move to working directory.
    Write    cd ${SALWorkDir}/${subSystem}/python
    Comment    Start Commander.
    ${input}=    Write    python ${subSystem}_Commander_${component}.py -23544 -6277 2244 10422 -13489 -19828 2697 -28085 5485 17021 -6102 4783 21125 -22271 20055 -21951 24726 -9028 -28767 21028 10336 -21191 8111 -3474 9704 19875 -11595 12722 -8230 27171 -25952 30926 2122 17929 -17839 -19867 20024 0.204704636178 0.754896047104 0.961915317829 0.777720918412 0.183692967491 0.662031459657 0.0455897720202 0.936902639146 0.414628138155 0.729343753014 0.763732134512 0.662547722724 0.229840043604 0.654408750922 0.840770994328 0.578493384751 0.305709645462 0.193236496669 0.351201871226 0.942832821726 0.76695940967 0.807966390187 0.696696096749 0.164941639891 0.698260004684 0.265490950198 0.448748895224 0.690473967326 0.757575888905 0.446011346923 0.569096110896 0.151575601952 0.233425571736 0.11119661804 0.0329727386633 0.784760305725 0.531020716198 0.910827492081 0.83156432346 0.0381959388742 0.137308574229 0.828248802459 0.966218011469 0.521992464858 0.409862514744 0.59935860274 0.607551700101 0.77826464701 0.036150570851 0.378526740853 0.11903932084 0.37354890633 0.886279814842 0.151486485084 0.165576584671 0.806373160265 0.229657160542 0.652281482939 0.932922069626 0.481505256274 0.236778032266 0.215269824035 0.397931546585 0.663781577804 0.259338424933 0.802235370969 0.0933849195889 0.0181574179274 0.247579472019 0.460279285091 0.518436512121 0.591998708767 0.435819482785 0.789883188436 0.208469108603 0.654324353405 0.916237206396 0.94078011067 0.697149674732 0.962790198868 0.990949911819 0.00998128364161 0.174158916614 0.487865227605 0.551490105979 0.515421099447 0.386428935244 0.84568746651 0.0807384528726 0.0598196275085 0.879880501131 0.869531268772 0.751562918457 0.0161283177666 0.549179078292 0.380300634125 0.702759126228 0.00485282800647 0.282228291712 0.396188103426 0.605503928734 0.0890115556681 0.81815145703 0.16148174727 0.932236741832 0.444734165794 0.367696247673 0.0373532580688 0.578571448203 0.682935180913 0.950375752797 0.608254387787 0.573692445575 0.308260507734 0.600634978548 0.300171035926 0.880138778815 0.277217715849 0.840001388368 0.931154708984 0.466973317047 0.660719583422 0.519386702716 0.214016338216 0.534976166056 0.0548071560747 0.941206329822 0.781500707091 0.169956153086 0.302145853468 0.0480989482842 0.187757613946 0.887730057252 0.737648957682 0.366849940214 0.979086923163 0.603945029552 0.20218902098 0.233500841247 0.108532592887 0.131531700701 0.504854830085 0.504378930835 0.570510358222 0.456318734127 0.813209134824 0.232303392011 0.233881466515 0.589382129721 0.519292857513 0.340198543902 0.901123584614 0.636174849939 0.176162487673 0.303775595188 0.686981215433 0.367729383557 0.0190309082812 0.970748191694 0.707755782432 0.921557498544 0.0901097326177 0.709018460889 0.205872815258 0.978268483517 0.268902744929 0.654643205775 0.990916358684 0.25377543592 0.028390620451 0.106673396592 0.475712988219 0.418325189258 0.759413887476 0.0992465617372 0.173900805235 0.887727104955 0.609393108882 0.867146227273 0.73636660287 0.491604445067 0.088112111276 0.937813457631 0.834678444773 0.494679074171 0.934838889488 0.632038530497 0.967331395606 0.198064889686 0.774596593508 0.128158754396 0.679808342559 0.672326239266 0.676444983351 0.824251280858 0.0135050496892 0.353245851902 0.509594164556 0.361846038432 0.214976946308 0.875050252267 0.96774844369 0.635138798891 0.0379231393354 0.678896710555 0.656172885757 0.872193626357 0.556788122156 0.492651848662 0.853507063844 0.62848535214 0.811936391299 0.0993080015753 0.460322248309 0.0268159691233 0.185499444802 0.144119240559 0.961675834589 0.118886057226 0.0143425959334 0.459087541848 0.158369903953
    ${output}=    Read Until Prompt
    Log    ${output}
    Should Contain X Times    ${output}    === [issueCommand_${component}] writing a command containing :    1
    Should Contain X Times    ${output}    device :    1
    Should Contain X Times    ${output}    property :    1
    Should Contain X Times    ${output}    action :    1
    Should Contain X Times    ${output}    value :    1
    Should Contain X Times    ${output}    azIndex : -23544    1
    Should Contain X Times    ${output}    fz1 : 0.204704636178    1
    Should Contain X Times    ${output}    fz2 : 0.910827492081    1
    Should Contain X Times    ${output}    fz3 : 0.208469108603    1
    Should Contain X Times    ${output}    fz4 : 0.608254387787    1
    Should Contain X Times    ${output}    fz5 : 0.589382129721    1
    Should Contain X Times    ${output}    fz6 : 0.934838889488    1
    ${CmdComplete}=    Get Line    ${output}    -2
    Should Match Regexp    ${CmdComplete}    (=== \\[waitForCompletion_${component}\\] command )[0-9]+( completed ok :)

Read Controller
    [Tags]    functional
    Switch Connection    Controller
    ${output}=    Read Until    result \ \ : Done : OK
    Log    ${output}
    Should Contain X Times    ${output}    azIndex(37) = [-23544, -6277, 2244, 10422, -13489, -19828, 2697, -28085, 5485, 17021, -6102, 4783, 21125, -22271, 20055, -21951, 24726, -9028, -28767, 21028, 10336, -21191, 8111, -3474, 9704, 19875, -11595, 12722, -8230, 27171, -25952, 30926, 2122, 17929, -17839, -19867, 20024]    1
    Should Contain X Times    ${output}    fz1(37) = [0.204704636178, 0.754896047104, 0.961915317829, 0.777720918412, 0.183692967491, 0.662031459657, 0.0455897720202, 0.936902639146, 0.414628138155, 0.729343753014, 0.763732134512, 0.662547722724, 0.229840043604, 0.654408750922, 0.840770994328, 0.578493384751, 0.305709645462, 0.193236496669, 0.351201871226, 0.942832821726, 0.76695940967, 0.807966390187, 0.696696096749, 0.164941639891, 0.698260004684, 0.265490950198, 0.448748895224, 0.690473967326, 0.757575888905, 0.446011346923, 0.569096110896, 0.151575601952, 0.233425571736, 0.11119661804, 0.0329727386633, 0.784760305725, 0.531020716198]    1
    Should Contain X Times    ${output}    fz2(37) = [0.910827492081, 0.83156432346, 0.0381959388742, 0.137308574229, 0.828248802459, 0.966218011469, 0.521992464858, 0.409862514744, 0.59935860274, 0.607551700101, 0.77826464701, 0.036150570851, 0.378526740853, 0.11903932084, 0.37354890633, 0.886279814842, 0.151486485084, 0.165576584671, 0.806373160265, 0.229657160542, 0.652281482939, 0.932922069626, 0.481505256274, 0.236778032266, 0.215269824035, 0.397931546585, 0.663781577804, 0.259338424933, 0.802235370969, 0.0933849195889, 0.0181574179274, 0.247579472019, 0.460279285091, 0.518436512121, 0.591998708767, 0.435819482785, 0.789883188436]    1
    Should Contain X Times    ${output}    fz3(37) = [0.208469108603, 0.654324353405, 0.916237206396, 0.94078011067, 0.697149674732, 0.962790198868, 0.990949911819, 0.00998128364161, 0.174158916614, 0.487865227605, 0.551490105979, 0.515421099447, 0.386428935244, 0.84568746651, 0.0807384528726, 0.0598196275085, 0.879880501131, 0.869531268772, 0.751562918457, 0.0161283177666, 0.549179078292, 0.380300634125, 0.702759126228, 0.00485282800647, 0.282228291712, 0.396188103426, 0.605503928734, 0.0890115556681, 0.81815145703, 0.16148174727, 0.932236741832, 0.444734165794, 0.367696247673, 0.0373532580688, 0.578571448203, 0.682935180913, 0.950375752797]    1
    Should Contain X Times    ${output}    fz4(37) = [0.608254387787, 0.573692445575, 0.308260507734, 0.600634978548, 0.300171035926, 0.880138778815, 0.277217715849, 0.840001388368, 0.931154708984, 0.466973317047, 0.660719583422, 0.519386702716, 0.214016338216, 0.534976166056, 0.0548071560747, 0.941206329822, 0.781500707091, 0.169956153086, 0.302145853468, 0.0480989482842, 0.187757613946, 0.887730057252, 0.737648957682, 0.366849940214, 0.979086923163, 0.603945029552, 0.20218902098, 0.233500841247, 0.108532592887, 0.131531700701, 0.504854830085, 0.504378930835, 0.570510358222, 0.456318734127, 0.813209134824, 0.232303392011, 0.233881466515]    1
    Should Contain X Times    ${output}    fz5(37) = [0.589382129721, 0.519292857513, 0.340198543902, 0.901123584614, 0.636174849939, 0.176162487673, 0.303775595188, 0.686981215433, 0.367729383557, 0.0190309082812, 0.970748191694, 0.707755782432, 0.921557498544, 0.0901097326177, 0.709018460889, 0.205872815258, 0.978268483517, 0.268902744929, 0.654643205775, 0.990916358684, 0.25377543592, 0.028390620451, 0.106673396592, 0.475712988219, 0.418325189258, 0.759413887476, 0.0992465617372, 0.173900805235, 0.887727104955, 0.609393108882, 0.867146227273, 0.73636660287, 0.491604445067, 0.088112111276, 0.937813457631, 0.834678444773, 0.494679074171]    1
    Should Contain X Times    ${output}    fz6(37) = [0.934838889488, 0.632038530497, 0.967331395606, 0.198064889686, 0.774596593508, 0.128158754396, 0.679808342559, 0.672326239266, 0.676444983351, 0.824251280858, 0.0135050496892, 0.353245851902, 0.509594164556, 0.361846038432, 0.214976946308, 0.875050252267, 0.96774844369, 0.635138798891, 0.0379231393354, 0.678896710555, 0.656172885757, 0.872193626357, 0.556788122156, 0.492651848662, 0.853507063844, 0.62848535214, 0.811936391299, 0.0993080015753, 0.460322248309, 0.0268159691233, 0.185499444802, 0.144119240559, 0.961675834589, 0.118886057226, 0.0143425959334, 0.459087541848, 0.158369903953]    1
    Should Contain X Times    ${output}    === [ackCommand_configureAzimuthRawLUT] acknowledging a command with :    1
    Should Contain    ${output}    seqNum   :
    Should Contain    ${output}    ack      : 301
    Should Contain X Times    ${output}    error \ \ \ : 0    1
    Should Contain    ${output}    result   : Ack : OK
    Should Contain    ${output}    ack      : 303
    Should Contain    ${output}    result   : Done : OK
