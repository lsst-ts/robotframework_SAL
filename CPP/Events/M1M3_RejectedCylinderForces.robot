*** Settings ***
Documentation    M1M3_RejectedCylinderForces sender/logger tests.
Force Tags    cpp    TSS-2617
Suite Setup    Run Keywords    Log Many    ${Host}    ${subSystem}    ${component}    ${timeout}
...    AND    Create Session    Sender    AND    Create Session    Logger
Suite Teardown    Close All Connections
Library    SSHLibrary
Resource    ../../Global_Vars.robot
Resource    ../../common.robot

*** Variables ***
${subSystem}    m1m3
${component}    RejectedCylinderForces
${timeout}    30s

*** Test Cases ***
Verify Component Sender and Logger
    [Tags]    smoke
    File Should Exist    ${SALWorkDir}/${subSystem}/cpp/src/sacpp_${subSystem}_${component}_send
    File Should Exist    ${SALWorkDir}/${subSystem}/cpp/src/sacpp_${subSystem}_${component}_log

Start Sender - Verify Missing Inputs Error
    [Tags]    functional
    Switch Connection    Sender
    Comment    Move to working directory.
    Write    cd ${SALWorkDir}/${subSystem}/cpp/src
    Comment    Start Sender.
    ${input}=    Write    ./sacpp_${subSystem}_${component}_send 
    ${output}=    Read Until Prompt
    Log    ${output}
    Should Contain    ${output}   Usage :  input parameters...

Start Logger
    [Tags]    functional
    Switch Connection    Logger
    Comment    Move to working directory.
    Write    cd ${SALWorkDir}/${subSystem}/cpp/src
    Comment    Start Logger.
    ${input}=    Write    ./sacpp_${subSystem}_${component}_log
    ${output}=    Read Until    logger ready =
    Log    ${output}
    Should Contain    ${output}    Event ${component} logger ready

Start Sender
    [Tags]    functional
    Switch Connection    Sender
    Comment    Move to working directory.
    Write    cd ${SALWorkDir}/${subSystem}/cpp/src
    Comment    Start Sender.
    ${input}=    Write    ./sacpp_${subSystem}_${component}_send 60.6163 -529762813 -672299734 1660846074 463447090 -2076826834 1477384873 -779700573 -1261800289 1453277614 1325483394 365474178 -1595621067 -1046437713 1213990361 510194533 -304441491 -1562872286 -710023882 384650512 -65783969 -872505478 415035374 -1054118447 -1517927793 974656681 -564537206 -628699578 766927951 -212001567 1325342464 -459893992 -597577664 -290168525 155820193 428317778 1087586580 -251891213 1116792896 881370337 -667050501 -296217401 1407874138 1693792705 279523039 -993769075 -1125003294 -35567053 109431402 1738184614 943108369 -108689214 2124974744 -1816757111 1063897548 -416629660 -104107526 -2024982885 1466608012 346352338 -516532124 -436865983 748725680 -883554495 -454032938 -1123440917 -1956187588 1652917118 -1020891483 1451173102 -1134985480 -162106613 -933123880 1757601551 1268768435 -1335423582 -1037695990 625641210 -1338958914 -1664223753 -627907505 25879480 1370608950 -1431236198 1843516707 -1852850556 707494062 -847687626 -1953074357 746312604 1329085130 -1908933139 685499219 766681734 -607490975 1071073390 1166632121 -1792496647 -2050977133 1006229459 -1967805738 -1528023510 1569112551 -628493539 1287439907 2053930038 831006436 1077107819 -1453178208 -1234497367 1808488554 175372412 41092229 -2002237110 -46156251 -654917881 956673856 1387195440 204392633 -380139520 -1975469308 580864186 1529307581 -1642900721 1693949959 -1614944523 1184706214 -563546019 -665985493 -2027757765 49101986 -551697163 -660427139 -1567563354 -161974435 1644957801 1386484188 -994543870 -1102320634 -221705710 1614527122 -248675051 661277081 1205921390 -80977914 852534389 505288240 905810617 1334477465 -590885137 -1749284346 1910638845 -1718180923 -1355555539 -470941623 1322087792 2118444535 1234478529 1037791467 -243713497 526649585 967109428 -641668038 -883596592 1439352272 1128909883 -577904456 577599222 249918240 -1692447095 -618536411 -984333988 1317523729 -1693281260 997573889 -235017243 -946825193 227894004 54754497 539706404 1804829591 -1579954857 -719037462 2014262215 -1330545034 592372067 561546272 1482444700 1729414335 132071203 -1649468028 -950065475 -1795211824 -1175693502 -175003712 -1817193755 908610575 -456477379 -853572866 696046195 -317362619 -111111096 -1195122236 -82331692 -47025140 430534601 -1550849995 -1120376069 -1260530028 -1686820485 1007295618 -576224461 -1685821708 -413852384 -1484565243 1077471302 -1663770503 -622936148 -1678349655 -1649619975 1433092284 -56034242 -887058851 978348023 1396912596 1283467293 1685910296 209513784 1107786596 1026054220 455641967 1706923571 -350334229 -1755937578 1975636376 -907916187 -621674338 1352025110 1194282846 -1429648152 -1243097316 2120094806 -610088619 603367459 -226901329 551158758 -1617529786 84256645 1905413387 1378593774 -1621992565 -1920971462 -161260826 98823060 -28883867 1605939924 -1638848727 1562810316 74012017 -481989851 -1685806821 1827905312 1431104655 -851827263 1199170410 808582225 -1451099385 1501827325 112906827 1255150754
    ${output}=    Read Until Prompt
    Log    ${output}
    Should Contain X Times    ${output}    === [putSample] m1m3::logevent_RejectedCylinderForces writing a message containing :    1
    Should Contain    ${output}    revCode \ :
    Should Contain    ${output}    === Event RejectedCylinderForces generated =

Read Logger
    [Tags]    functional
    Switch Connection    Logger
    ${output}=    Read Until    priority : 1255150754
    Log    ${output}
    Should Contain X Times    ${output}    === Event RejectedCylinderForces received =     1
    Should Contain    ${output}    Timestamp : 60.6163
    Should Contain    ${output}    SecondaryCylinderForces : -529762813
    Should Contain    ${output}    PrimaryCylinderForces : -672299734
    Should Contain    ${output}    priority : 1660846074
