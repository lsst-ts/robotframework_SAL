*** Settings ***
Documentation    M1M3_RejectedCylinderForces sender/logger tests.
Force Tags    cpp    TSS-2617
Suite Setup    Run Keywords    Log Many    ${Host}    ${subSystem}    ${component}    ${timeout}
...    AND    Create Session    Sender    AND    Create Session    Logger
Suite Teardown    Close All Connections
Library    SSHLibrary
Resource    ../../Global_Vars.robot
Resource    ../../common.robot

*** Variables ***
${subSystem}    m1m3
${component}    RejectedCylinderForces
${timeout}    30s

*** Test Cases ***
Verify Component Sender and Logger
    [Tags]    smoke
    File Should Exist    ${SALWorkDir}/${subSystem}/cpp/src/sacpp_${subSystem}_${component}_send
    File Should Exist    ${SALWorkDir}/${subSystem}/cpp/src/sacpp_${subSystem}_${component}_log

Start Sender - Verify Missing Inputs Error
    [Tags]    functional
    Switch Connection    Sender
    Comment    Move to working directory.
    Write    cd ${SALWorkDir}/${subSystem}/cpp/src
    Comment    Start Sender.
    ${input}=    Write    ./sacpp_${subSystem}_${component}_send 
    ${output}=    Read Until Prompt
    Log    ${output}
    Should Contain    ${output}   Usage :  input parameters...

Start Logger
    [Tags]    functional
    Switch Connection    Logger
    Comment    Move to working directory.
    Write    cd ${SALWorkDir}/${subSystem}/cpp/src
    Comment    Start Logger.
    ${input}=    Write    ./sacpp_${subSystem}_${component}_log
    ${output}=    Read Until    logger ready =
    Log    ${output}
    Should Contain    ${output}    Event ${component} logger ready

Start Sender
    [Tags]    functional
    Switch Connection    Sender
    Comment    Move to working directory.
    Write    cd ${SALWorkDir}/${subSystem}/cpp/src
    Comment    Start Sender.
    ${input}=    Write    ./sacpp_${subSystem}_${component}_send 26.9975 1955357076 343281446 -1890604872 1119042553 -1235190050 1377740707 515849557 1442681458 1000430129 758866184 -545920199 138483591 948148525 919753301 -1891054082 1580851213 413186220 -1919805905 -85510536 2017249335 1022313323 -1403853639 1664955666 1520196264 858812584 -1266042265 -1103849803 -1565626526 -1317842413 -885326901 286177046 749025748 1965722574 2046056114 1298897728 698212508 -844752830 -1784773275 -483444256 -1366606633 -1606614719 1395815742 1712226175 639227361 -863497043 1405204962 1206191907 1373064535 1557103702 806730157 -263697264 1249303443 -70377505 1441159103 1599607476 1284024052 757375844 1347747696 -464496643 1206753534 2145027789 -1826414410 1663141052 1631048604 1911444778 328994054 1337169898 2062571377 1528618505 42372574 -1942614565 460941465 -1682943448 2032540242 34745870 198477389 -1785712778 794252465 1732827382 1889525860 -1827760568 -1780643956 143918118 -1306774283 -2080571277 1570207028 1554364310 1432293881 -1008118280 1310291286 1015509757 -1304677374 803933856 390947148 95704049 1253930461 835708905 1753793794 -1917797933 -1900035575 1714978292 -1442387270 276729651 -40577048 649188302 58206499 -313844283 -331555008 1738467854 2052670397 122130653 -668813899 -569571453 -574175979 -1996689186 287289409 1496616722 -826062418 1991678940 499599034 166495336 -274992158 -810842530 1753337483 1969553901 876557939 1250895954 -296153107 1397583788 453085659 1638084484 -1391218516 -776299850 1096947160 319788766 1186146541 1056680895 1787202771 -1335351261 59986116 -2026900535 -394812027 819837894 1630253068 1147011594 -1197503848 -1629215008 -1764420975 1703350183 258134490 -1321854139 -1437281132 38831675 1524577410 1141921682 470588332 6721452 -546877985 503136930 1748570820 -811185661 243082972 -16353992 -392898586 -1090121146 536754239 -1977185441 784266275 1568507388 -2129506355 -1239322557 1784186604 -2086900199 1523638858 -1546120017 -1850700325 841085611 -49921102 1539988986 1485903572 471025804 1980560184 12447260 79388587 -1865703405 -1563083522 2050043355 -1982471861 51004713 -1084363273 1036477066 336830827 -87408279 -873174308 -1667843723 -208959911 1167528999 -1635181585 -1096003430 1221337834 135588562 246825223 -1063577519 2057990271 820002788 1899092954 -870251171 1815978962 301035438 1095052527 -2059165468 1171231878 -1403914417 -707363988 -1663781214 -203311278 122076993 1898073703 -961633609 -281229458 -791423627 1662000003 504930722 -617124674 -1738321923 1238817005 1024967372 -667193870 649067955 21156220 -934241535 442369559 -1159065603 -2047932789 2097116372 -705543080 -753778639 1117369947 333887698 881314268 422870806 2018020328 -1437284386 -1358030621 679072586 202934382 -535988656 521484581 1706035102 -995172228 57775748 -1475622266 1413016417 962041740 -945618800 441970911 1003169893 1286187457 -130001603 912251811 1579571549 1350342276 107074416 120662035 -927045820 1942015746 1349246569 997221560 -346351599
    ${output}=    Read Until Prompt
    Log    ${output}
    Should Contain X Times    ${output}    === [putSample] m1m3::logevent_RejectedCylinderForces writing a message containing :    1
    Should Contain    ${output}    revCode \ :
    Should Contain    ${output}    === Event RejectedCylinderForces generated =

Read Logger
    [Tags]    functional
    Switch Connection    Logger
    ${output}=    Read Until    priority : -346351599
    Log    ${output}
    Should Contain X Times    ${output}    === Event RejectedCylinderForces received =     1
    Should Contain    ${output}    Timestamp : 26.9975
    Should Contain    ${output}    SecondaryCylinderForces : 1955357076
    Should Contain    ${output}    PrimaryCylinderForces : 343281446
    Should Contain    ${output}    priority : -1890604872
