*** Settings ***
Documentation    M1M3_RejectedCylinderForces sender/logger tests.
Force Tags    cpp    TSS-2617
Suite Setup    Run Keywords    Log Many    ${Host}    ${subSystem}    ${component}    ${timeout}
...    AND    Create Session    Sender    AND    Create Session    Logger
Suite Teardown    Close All Connections
Library    SSHLibrary
Resource    ../../Global_Vars.robot
Resource    ../../common.robot

*** Variables ***
${subSystem}    m1m3
${component}    RejectedCylinderForces
${timeout}    30s

*** Test Cases ***
Verify Component Sender and Logger
    [Tags]    smoke
    File Should Exist    ${SALWorkDir}/${subSystem}/cpp/src/sacpp_${subSystem}_${component}_send
    File Should Exist    ${SALWorkDir}/${subSystem}/cpp/src/sacpp_${subSystem}_${component}_log

Start Sender - Verify Missing Inputs Error
    [Tags]    functional
    Switch Connection    Sender
    Comment    Move to working directory.
    Write    cd ${SALWorkDir}/${subSystem}/cpp/src
    Comment    Start Sender.
    ${input}=    Write    ./sacpp_${subSystem}_${component}_send 
    ${output}=    Read Until Prompt
    Log    ${output}
    Should Contain    ${output}   Usage :  input parameters...

Start Logger
    [Tags]    functional
    Switch Connection    Logger
    Comment    Move to working directory.
    Write    cd ${SALWorkDir}/${subSystem}/cpp/src
    Comment    Start Logger.
    ${input}=    Write    ./sacpp_${subSystem}_${component}_log
    ${output}=    Read Until    logger ready =
    Log    ${output}
    Should Contain    ${output}    Event ${component} logger ready

Start Sender
    [Tags]    functional
    Switch Connection    Sender
    Comment    Move to working directory.
    Write    cd ${SALWorkDir}/${subSystem}/cpp/src
    Comment    Start Sender.
    ${input}=    Write    ./sacpp_${subSystem}_${component}_send 64.694 714969100 1015933807 392509336 -2137436981 -1696672271 580113042 948162213 1477698415 -45495125 977429115 -1813758237 -1364320915 350046386 -948530773 -1225540519 -293504370 -1921686034 -1064968286 -783047973 -1137720103 1650565916 592325130 1463467617 1806331209 252310006 207114662 282813229 1940865356 215943596 1115506946 1765023676 -1528506543 526176501 -2011334690 333713808 1842861852 -1754284452 1504384549 978618739 -612006839 -2004152641 -1614156611 -1823817219 -1104516592 -2010826113 -241848582 470989023 1420298220 93287770 1870837634 -231177645 477394061 260965909 -347110213 -1233653221 -1732043554 2098253477 1231907833 -1134697995 2079535723 -1053284682 -756758511 -1026424803 1785118583 -60783710 1926515990 -1110348959 -1513794245 1401930018 -1690102951 99898752 -443545073 -95111528 628008193 1673542123 -478782617 -196500234 1424188664 755110007 1324997014 -1149314506 -1067362384 221539397 -1867619139 -1980710794 -192397616 2109948076 838561478 866113622 -1254779897 1267622732 1583365999 197885023 1273996658 1600151207 2033534002 -1386215692 1607877438 187441890 -2061710783 1206634766 1673482942 -1036697900 1272678147 712679932 -966631027 421846414 711791423 689303513 1753798117 666299455 -1284382716 -294128839 -1040613964 1131492511 -2140284354 -1296401643 -1965960937 -1811098076 -771681745 885635900 2013167400 1062493956 631595107 -1634649614 413448936 -1500123384 -88431636 -935096908 1200153880 -283058709 957810129 -433701844 1540415605 629793086 -1644610832 95009257 1943158980 514568091 2126863464 1700222144 -1843943504 1341712615 67641288 -1859405979 153301642 -1152666974 147170729 -1009658779 -602928460 -1774618191 -603736563 -696520852 -497536641 -705544712 -495450535 -455454241 634018504 655144942 -1993451612 461652393 -931530693 1677878505 1453303975 765629909 -706857444 1564930927 250071585 -1230736138 -1377659432 -879285882 -1637154561 14219589 -1249128914 120554877 1530089336 -915525182 2065123658 1104449206 -1998324468 559295917 1992306165 862327520 1029705477 1786185824 665447062 914155698 1533496236 1269158940 -93072341 -530157629 -507934993 -928426834 -1066171604 2019930332 -1525495413 -2031300195 -1681067482 -1129526447 1933305034 826189327 1297490607 -1011097510 -809567370 -752915589 -369412081 -23839675 1948791774 259316707 1322397406 -1753523472 63236694 -1490172797 1731686504 -1525448671 163546512 820303599 562533583 -1138611215 -610915118 -2118231114 779338789 -1104707569 -553720040 -307428765 1250306308 -1032255435 1719712071 1988948975 697929779 -1158340222 -692159487 -418869241 373722545 -577915991 -1742722378 -897349839 -1671359181 -461965816 -966365991 -1058061375 -1438392437 -553470674 1750269268 -1131551460 -273304706 1955041925 958521331 -107329057 839225448 -459886576 1337972242 -1410701411 -378276859 -1008921707 -678573760 1699798085 -139229561 291043861 1191764805 -1999891538 634608354 295865866 -1518088141 -2103172671 1874221623 -2071610092 -739156914 475188805
    ${output}=    Read Until Prompt
    Log    ${output}
    Should Contain X Times    ${output}    === [putSample] m1m3::logevent_RejectedCylinderForces writing a message containing :    1
    Should Contain    ${output}    revCode \ :
    Should Contain    ${output}    === Event RejectedCylinderForces generated =

Read Logger
    [Tags]    functional
    Switch Connection    Logger
    ${output}=    Read Until    priority : 475188805
    Log    ${output}
    Should Contain X Times    ${output}    === Event RejectedCylinderForces received =     1
    Should Contain    ${output}    Timestamp : 64.694
    Should Contain    ${output}    SecondaryCylinderForces : 714969100
    Should Contain    ${output}    PrimaryCylinderForces : 1015933807
    Should Contain    ${output}    priority : 392509336
