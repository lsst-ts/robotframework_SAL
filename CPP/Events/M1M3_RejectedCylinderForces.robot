*** Settings ***
Documentation    M1M3_RejectedCylinderForces sender/logger tests.
Force Tags    cpp    TSS-2617
Suite Setup    Run Keywords    Log Many    ${Host}    ${subSystem}    ${component}    ${timeout}
...    AND    Create Session    Sender    AND    Create Session    Logger
Suite Teardown    Close All Connections
Library    SSHLibrary
Resource    ../../Global_Vars.robot
Resource    ../../common.robot

*** Variables ***
${subSystem}    m1m3
${component}    RejectedCylinderForces
${timeout}    30s

*** Test Cases ***
Verify Component Sender and Logger
    [Tags]    smoke
    File Should Exist    ${SALWorkDir}/${subSystem}/cpp/src/sacpp_${subSystem}_${component}_send
    File Should Exist    ${SALWorkDir}/${subSystem}/cpp/src/sacpp_${subSystem}_${component}_log

Start Sender - Verify Missing Inputs Error
    [Tags]    functional
    Switch Connection    Sender
    Comment    Move to working directory.
    Write    cd ${SALWorkDir}/${subSystem}/cpp/src
    Comment    Start Sender.
    ${input}=    Write    ./sacpp_${subSystem}_${component}_send 
    ${output}=    Read Until Prompt
    Log    ${output}
    Should Contain    ${output}   Usage :  input parameters...

Start Logger
    [Tags]    functional
    Switch Connection    Logger
    Comment    Move to working directory.
    Write    cd ${SALWorkDir}/${subSystem}/cpp/src
    Comment    Start Logger.
    ${input}=    Write    ./sacpp_${subSystem}_${component}_log
    ${output}=    Read Until    logger ready =
    Log    ${output}
    Should Contain    ${output}    Event ${component} logger ready

Start Sender
    [Tags]    functional
    Switch Connection    Sender
    Comment    Move to working directory.
    Write    cd ${SALWorkDir}/${subSystem}/cpp/src
    Comment    Start Sender.
    ${input}=    Write    ./sacpp_${subSystem}_${component}_send 43.6924 -1996988103 1193366771 -1130377302 1362836945 88633233 1419630441 -1504171501 1318045858 1988828022 -883594139 1061763309 1488474105 780374508 -314635185 -613451427 -1198435013 -958928539 380041830 791233547 403289736 987972641 -942709909 827950091 -352962344 553795505 1848730258 203446918 1497946733 17030121 -581612896 1226531175 -1234891010 422416862 -781109880 -463952049 -1070267761 1742835378 1765560876 -519061391 -26671689 -1996526085 -1463935592 1034452928 -1096676114 -1058537468 -769312478 1919446730 -676892767 -190793496 -1250433796 1997070466 1458538645 1927036865 186826807 -1408634185 -766520435 1494337636 2070276043 1450802169 -445483172 1442014181 2064559392 795763504 -1224364789 465010635 1837310760 -1480775248 1596742613 165590222 -1726154768 -1943848772 1319498458 -291038927 652493037 -739317124 -111529324 -1301499959 544145201 -1049197423 1952687057 1017645677 1802384732 -1213823285 -1753418814 -66333776 1499641259 -998565870 -1672681222 55212825 1074271706 -786489117 -1143154493 784605965 76431877 1540389952 2002985292 1234944605 -472508262 793889940 -1580862490 -29301233 592175516 -1630014700 -1422821125 228573423 187355277 -2128603751 1035829254 797281167 1939618528 1804683890 1002281653 -571684836 1374686562 -2105853557 -1040256350 1361564216 1042711276 542001942 98772331 -2038406017 -305641859 -222056511 -1923489363 2035458788 59470460 -1393878287 -1228844971 1308101559 -1114785341 -446678634 -1698584956 215780767 -1493481685 -1119300631 -1659034450 474730967 -502190132 379938124 -1671743446 -670225123 -252870113 -2067389774 -1081043422 1234254206 1184012933 -2023549704 -17984504 -1402321852 -1247855383 -1088660398 205739627 -1249926224 -1589391257 1168558176 -1425010997 -1747775599 -1252434879 1317379032 1207291663 -888384479 -1002788271 2062897643 1994777078 -2081019843 -1282707585 1246255242 -1112139262 1393406897 20862893 -60781000 1987232972 -810704911 -1751418770 -1520458771 637771909 494394097 1825796161 -1030948788 -1849990471 -495959802 1287180345 -2022249249 -1335346902 -647259061 -33385828 -117242061 -1895611719 -947281971 -1591964806 -1771141359 1508558567 -1445903586 585190099 1709336520 -634422796 -1743761379 -678146169 -1556576401 -1133388386 -299731585 1272082311 -234359347 -1157198987 -1993989069 1161273149 -1120872799 305439556 907648682 -1590555996 2001017460 868114737 1835576152 1012307753 -1140977988 1727858961 1231671133 -1349650489 746436937 1537698933 -1954609805 -24073049 -443929217 -1944417675 -2021378506 1629313578 -83434993 -1094809528 -682343684 -887819817 -451373817 1333478334 -1688825960 -1732979332 -902528499 -1048303008 1769964029 -1037941196 -67151124 -1568331134 -1345104727 -919440898 876145808 1434603721 322526498 -2080904360 1354803293 -513643820 -1500251418 1001214861 -80578573 1699981713 -564604951 978047831 -339545106 387141298 -1893024263 1376107259 590640754 -884506065 49792716 -2026522191 -1128601573 1286657285 -1128865690 -771973750 325250447 27208793 -588533831
    ${output}=    Read Until Prompt
    Log    ${output}
    Should Contain X Times    ${output}    === [putSample] m1m3::logevent_RejectedCylinderForces writing a message containing :    1
    Should Contain    ${output}    revCode \ :
    Should Contain    ${output}    === Event RejectedCylinderForces generated =

Read Logger
    [Tags]    functional
    Switch Connection    Logger
    ${output}=    Read Until    priority : -588533831
    Log    ${output}
    Should Contain X Times    ${output}    === Event RejectedCylinderForces received =     1
    Should Contain    ${output}    Timestamp : 43.6924
    Should Contain    ${output}    SecondaryCylinderForces : -1996988103
    Should Contain    ${output}    PrimaryCylinderForces : 1193366771
    Should Contain    ${output}    priority : -1130377302
