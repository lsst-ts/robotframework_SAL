*** Settings ***
Documentation    M1M3_AppliedCylinderForces sender/logger tests.
Force Tags    cpp    TSS-2617
Suite Setup    Run Keywords    Log Many    ${Host}    ${subSystem}    ${component}    ${timeout}
...    AND    Create Session    Sender    AND    Create Session    Logger
Suite Teardown    Close All Connections
Library    SSHLibrary
Resource    ../../Global_Vars.robot
Resource    ../../common.robot

*** Variables ***
${subSystem}    m1m3
${component}    AppliedCylinderForces
${timeout}    30s

*** Test Cases ***
Verify Component Sender and Logger
    [Tags]    smoke
    File Should Exist    ${SALWorkDir}/${subSystem}/cpp/src/sacpp_${subSystem}_${component}_send
    File Should Exist    ${SALWorkDir}/${subSystem}/cpp/src/sacpp_${subSystem}_${component}_log

Start Sender - Verify Missing Inputs Error
    [Tags]    functional
    Switch Connection    Sender
    Comment    Move to working directory.
    Write    cd ${SALWorkDir}/${subSystem}/cpp/src
    Comment    Start Sender.
    ${input}=    Write    ./sacpp_${subSystem}_${component}_send 
    ${output}=    Read Until Prompt
    Log    ${output}
    Should Contain    ${output}   Usage :  input parameters...

Start Logger
    [Tags]    functional
    Switch Connection    Logger
    Comment    Move to working directory.
    Write    cd ${SALWorkDir}/${subSystem}/cpp/src
    Comment    Start Logger.
    ${input}=    Write    ./sacpp_${subSystem}_${component}_log
    ${output}=    Read Until    logger ready =
    Log    ${output}
    Should Contain    ${output}    Event ${component} logger ready

Start Sender
    [Tags]    functional
    Switch Connection    Sender
    Comment    Move to working directory.
    Write    cd ${SALWorkDir}/${subSystem}/cpp/src
    Comment    Start Sender.
    ${input}=    Write    ./sacpp_${subSystem}_${component}_send 82.9864 -159913914 -1764765832 495745357 1156659415 -1908896689 -1560522464 -629910367 1391009701 1913404810 -515143729 -562841466 395902171 -1895974076 -1461914652 992583714 2086839297 1934261924 -76731277 -1374697130 -2089435708 924940240 175491002 -380326588 -1379026531 -1499988965 2048897461 1402767821 108714806 -1308522741 -1548336483 -1396463366 2039990981 -1221213 -510089210 856995741 -1234089911 -1980087767 -1777557897 1261059987 1747187792 -2092403412 1365847120 -518606001 -816186756 -2018617378 -207255438 1722104186 -1641899962 633080269 -278886546 1367421146 1078221202 -653123630 -235042365 -568323000 1953857185 -1198526369 1103676469 -1850248858 -1428979889 -2046342893 570090905 -726725079 -2024707198 1762030538 -1811442023 -1692034131 -1663909741 864926549 431337326 -1020530110 -1742878776 -1074710819 756708164 666293979 -1438754663 -1353335130 1624491987 -2036810158 779554915 -1392372268 194957947 404019343 1329209174 -1237796455 1145765255 586462430 -167598878 -138889126 1575805763 -990067254 -1565818960 451117529 1711528938 1169382849 -1240882939 702269 1902360252 1165421012 101714835 -1477332932 -958500412 1876564463 -179330299 2147285232 -1572154384 -947242407 -584880345 -694090273 -1849393545 855207471 1853718903 -1076427614 563584119 2143671762 236370510 -1188103413 -709526076 2118529555 554443439 -1269450861 -169680848 -1808307575 1462575446 -993029437 -1438778862 44858610 -1630357372 -1593032450 -821234915 981987257 673497562 -131958589 -1116903332 -1551263694 35769243 -682797553 -253380201 537965117 700864085 -1613699843 1003238550 -1061362253 1211897959 -459997167 1655437081 -527551056 563320022 -812044360 695718023 -616932478 -1607053134 2000850741 -45734751 -74743046 -1000233602 -1389777309 -1508512531 -884974182 79883885 -1961157342 -734642677 -483120735 915701923 -375283643 -47111784 -975623077 1563901652 1962665321 -393375099 999975002 851577019 462177963 2143047639 297300293 -19185260 1686785850 -1397916402 1687981571 2109171217 -7540093 -846627485 -1956566715 -1334797626 -1506994067 -1406668389 -151828126 -1018456162 840835966 53931319 585618206 -1018953650 -842758027 -2090298531 681857989 1167219304 -1884946950 -315170174 -282397909 -1611225402 1221956560 -195354148 2046491102 -2050619965 792931460 -311715610 642472601 1848834843 1581547904 -263610212 568897847 1703447803 -881398453 -1591936780 353632839 -368033175 -376654676 -682674615 -534426660 392380466 -1612891798 -517271062 1318735118 -368692450 -965457799 491736338 -336956670 1870880779 1590772288 -2020686132 -31486920 -431945573 262822913 449828992 175890911 -694765984 1171900144 -457492557 415201704 477821686 -105502537 780910749 1298646146 -576722788 642648406 1491669352 -33070094 -544431541 -1168973034 -355719371 424676578 425805106 -485696790 -1864346745 877600558 -118420429 1241722709 360669183 -817683232 305690392 -89794401 1715327583 -1689707209 -1992438540 -2028392706 -391955953 1453645444 1543760187 -530358563
    ${output}=    Read Until Prompt
    Log    ${output}
    Should Contain X Times    ${output}    === [putSample] m1m3::logevent_AppliedCylinderForces writing a message containing :    1
    Should Contain    ${output}    revCode \ :
    Should Contain    ${output}    === Event AppliedCylinderForces generated =

Read Logger
    [Tags]    functional
    Switch Connection    Logger
    ${output}=    Read Until    priority : -530358563
    Log    ${output}
    Should Contain X Times    ${output}    === Event AppliedCylinderForces received =     1
    Should Contain    ${output}    Timestamp : 82.9864
    Should Contain    ${output}    SecondaryCylinderForces : -159913914
    Should Contain    ${output}    PrimaryCylinderForces : -1764765832
    Should Contain    ${output}    priority : 495745357
