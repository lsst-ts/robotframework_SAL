*** Settings ***
Documentation    M1M3_AppliedCylinderForces communications tests.
Force Tags    cpp    TSS-2617
Suite Setup    Run Keywords    Log Many    ${Host}    ${subSystem}    ${component}    ${timeout}
...    AND    Create Session    Sender    AND    Create Session    Logger
Suite Teardown    Close All Connections
Library    SSHLibrary
Resource    ../../Global_Vars.robot
Resource    ../../common.robot

*** Variables ***
${subSystem}    m1m3
${component}    AppliedCylinderForces
${timeout}    30s

*** Test Cases ***
Verify Component Sender and Logger
    [Tags]    smoke
    File Should Exist    ${SALWorkDir}/${subSystem}/cpp/src/sacpp_${subSystem}_${component}_send
    File Should Exist    ${SALWorkDir}/${subSystem}/cpp/src/sacpp_${subSystem}_${component}_log

Start Sender - Verify Missing Inputs Error
    [Tags]    functional
    Switch Connection    Sender
    Comment    Move to working directory.
    Write    cd ${SALWorkDir}/${subSystem}/cpp/src
    Comment    Start Sender.
    ${input}=    Write    ./sacpp_${subSystem}_${component}_send 
    ${output}=    Read Until Prompt
    Log    ${output}
    Should Contain    ${output}   Usage :  input parameters...

Start Logger
    [Tags]    functional
    Switch Connection    Logger
    Comment    Move to working directory.
    Write    cd ${SALWorkDir}/${subSystem}/cpp/src
    Comment    Start Logger.
    ${input}=    Write    ./sacpp_${subSystem}_${component}_log
    ${output}=    Read Until    logger ready =
    Log    ${output}
    Should Contain    ${output}    Event ${component} logger ready

Start Sender
    [Tags]    functional
    Switch Connection    Sender
    Comment    Move to working directory.
    Write    cd ${SALWorkDir}/${subSystem}/cpp/src
    Comment    Start Sender.
    ${input}=    Write    ./sacpp_${subSystem}_${component}_send 81.2947 -1089791989 1810199250 976787664 1043925650 -405174319 -30692735 -1595477088 555465324 -714571961 965661096 -68051318 1200863826 1569208753 -763619438 1628403631 -401740640 -1746991946 -1368086979 2061095347 116039129 1975762694 1248285425 -479531895 -1498158075 1541805822 -334464971 -1618823516 1867081087 1103157668 -50626078 245537126 1002630937 -1354672506 -1110981089 -120060815 2082143324 -1838663276 -1471996943 -554350304 142512539 -1943372540 -1793520398 -1158934668 714187285 -1290810211 1872334766 -1514588623 2074930500 1696474997 439041095 -963861555 1094849856 -1696909924 1534398159 -1433477692 1370497823 1318254858 -2123434656 1902653221 959357956 1983213141 -318608768 182278365 1479818319 -2011585429 1578381802 -135073840 -1765639398 1742971344 1450782084 316631071 1367247743 1328830305 -1842758839 -1410484242 -1731876583 -280516775 1639799240 -587617165 1200079782 -1263572360 1646073889 -574393332 1037067219 713224885 -353122078 1858468836 -299279419 -1648012861 86995007 976039039 -567757692 -1757802828 -1266266716 -166081555 1888606047 -1830574917 -1354111949 621248322 2133828304 1677188662 -2095139294 709381703 858499138 -876512397 -743718790 -131218089 1438193517 2031045138 -1405028299 -1378079721 1998625554 69551212 -2016219865 1425418123 -982954024 1280427180 -105905506 -1090978266 1446589681 64011438 572482912 69821426 -733699789 803103949 1640509049 -311670829 -164772583 -730080969 -1917766188 -918411310 1066702988 457028288 -215747982 -423124677 252629893 1455692451 1721742527 -1024737775 2025476106 510531826 494795502 -67587701 -1860148199 -24929568 677972553 -258378332 -1475843301 1585911930 -73418022 -1611091985 -1181018564 676963837 -1596857206 -1630677568 1641610237 -1920353462 127112914 593817570 -1192929480 -1653703858 -860165214 -1632581262 1826862487 606896921 -986739894 -1009817639 589004875 -769544398 2048418300 -2018860379 -1794613353 1834164626 2118646910 -1084143929 -2141716720 1807919008 198939344 -1350051943 747493799 -1245776196 1841867760 665929079 897681260 -1471454441 334595204 2073859689 2021118536 1910845690 -295870085 -1476723636 1126164595 -364195317 -431982644 -2086900609 999680808 2141527935 1072030460 -1364723564 1469582660 -1972855272 -578460080 -1604224621 1306893801 1192631089 370022311 1053499825 -1819369267 -179799024 913632789 -406823411 579006675 132707566 957663159 -654328561 -198393307 782753264 -653205168 1268983347 1437063388 104518060 1002324865 165475418 1411427272 -1446827783 1342021990 -17311917 291512617 1142654376 -1585748110 -1579757389 2015623824 294679351 735564174 235723438 -2076586645 -507512840 -1844608806 2049393316 -1905181444 1934878824 -1670451901 126959743 -434065068 1321583540 -89148984 627036193 910928784 541160175 -736555431 -1829867034 461067285 -270192629 -1251478753 -1395742211 -428742887 857907424 -408675661 32136239 -1528585340 2000492911 -105379109 -175150906 -1689519127 -1555135169 322841779 -311078937 1601501969 -1871968301
    ${output}=    Read Until Prompt
    Log    ${output}
    Should Contain X Times    ${output}    === [putSample] m1m3::logevent_AppliedCylinderForces writing a message containing :    1
    Should Contain    ${output}    revCode \ :
    Should Contain    ${output}    === Event AppliedCylinderForces generated =

Read Logger
    [Tags]    functional
    Switch Connection    Logger
    ${output}=    Read Until    priority : -1871968301
    Log    ${output}
    Should Contain X Times    ${output}    === Event AppliedCylinderForces received =     1
    Should Contain    ${output}    Timestamp : 81.2947
    Should Contain    ${output}    SecondaryCylinderForces : -1089791989
    Should Contain    ${output}    PrimaryCylinderForces : 1810199250
    Should Contain    ${output}    priority : 976787664
