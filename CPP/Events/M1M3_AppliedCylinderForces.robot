*** Settings ***
Documentation    M1M3_AppliedCylinderForces communications tests.
Force Tags    cpp    TSS-2617
Suite Setup    Run Keywords    Log Many    ${Host}    ${subSystem}    ${component}    ${timeout}
...    AND    Create Session    Sender    AND    Create Session    Logger
Suite Teardown    Close All Connections
Library    SSHLibrary
Resource    ../../Global_Vars.robot
Resource    ../../common.robot

*** Variables ***
${subSystem}    m1m3
${component}    AppliedCylinderForces
${timeout}    30s

*** Test Cases ***
Verify Component Sender and Logger
    [Tags]    smoke
    File Should Exist    ${SALWorkDir}/${subSystem}/cpp/src/sacpp_${subSystem}_${component}_send
    File Should Exist    ${SALWorkDir}/${subSystem}/cpp/src/sacpp_${subSystem}_${component}_log

Start Sender - Verify Missing Inputs Error
    [Tags]    functional
    Switch Connection    Sender
    Comment    Move to working directory.
    Write    cd ${SALWorkDir}/${subSystem}/cpp/src
    Comment    Start Sender.
    ${input}=    Write    ./sacpp_${subSystem}_${component}_send 
    ${output}=    Read Until Prompt
    Log    ${output}
    Should Contain    ${output}   Usage :  input parameters...

Start Logger
    [Tags]    functional
    Switch Connection    Logger
    Comment    Move to working directory.
    Write    cd ${SALWorkDir}/${subSystem}/cpp/src
    Comment    Start Logger.
    ${input}=    Write    ./sacpp_${subSystem}_${component}_log
    ${output}=    Read Until    logger ready =
    Log    ${output}
    Should Contain    ${output}    Event ${component} logger ready

Start Sender
    [Tags]    functional
    Switch Connection    Sender
    Comment    Move to working directory.
    Write    cd ${SALWorkDir}/${subSystem}/cpp/src
    Comment    Start Sender.
    ${input}=    Write    ./sacpp_${subSystem}_${component}_send 35.0907 1372633962 -49600899 -1421101162 -310791239 -88931222 1157818129 32763299 1996017529 -737311549 -578224516 -1667004081 131843089 -549392890 -2050169960 -1011608020 1793191152 -791389643 -1561074776 1301776103 194327731 1853779623 -1491120397 -1251152422 -669673694 1693544528 -65196983 -642289198 621628441 1386917410 831552695 975627689 -270123747 -2064403170 -2071000954 -1503693586 -1265388085 1765850429 176417268 -1972095796 -505416992 488494922 340001812 1628636871 51322320 -1822502784 -1765261826 691694551 -161356386 1128730753 778723631 1491058874 -2061196221 2106032006 -568232218 -798525541 885553492 -447775362 1360824131 -463393353 722106049 406612810 1168103444 -1044950043 1413905987 -626450353 -2078080617 -1159861866 -772660833 357872399 904527299 -682358917 1993476691 117986091 -1032199197 252501061 1327449879 -744666478 2054153055 1498373859 -1084026751 -545400055 32425994 850711005 702228012 -1557283169 -399218354 -1601383216 -1173087038 1291937965 313436663 -348194411 -465863361 -1068223423 -1596566546 -1768066066 -543695482 -242889861 -1876114860 845436386 1658752903 -1491130867 497244014 1686066761 -1586108429 -185309692 -1658521487 1440254837 1763575182 517627012 2027826091 175494055 1363221755 -1924959666 -472909423 -1777792857 -1581712843 -36464352 1954189281 1626601917 273644396 -1871110057 -756781866 1559488337 978423935 141484312 166283923 -1279099585 1332227181 2031150778 330504990 -673327572 2072700214 -1124343161 -1424826266 1513093787 1941417938 -245536452 1035405398 -1759863392 -2080112037 259466950 1958551005 1268252870 419860585 -1267545651 1153124931 955495222 1885123987 1351747076 259106644 -1066414696 -781541457 -721973309 -562048149 -1674317174 685641175 -1056619 747537813 1598371794 698218756 -1928028989 125804280 -555134482 -2076439078 -1535467611 -69460606 330798926 1803621023 295557166 486430364 -1202691427 -961420480 2082244558 1511199916 877743757 2120236889 1153836650 1232071074 1898083432 -1955458809 1172404952 -1906783110 1937383758 -1541188977 -390557883 -1514776161 -1747918266 278263289 -871843885 -271594430 -996134843 -364906472 1239621445 -826819934 1001385776 977771225 -290686686 -375201108 -397098699 798697647 -999276572 1434003717 -2094575725 -1831466906 705491351 1741619877 -1580576436 1887507397 781060916 1234129093 454689673 -137409380 1862687698 -251537640 788127129 196591560 -1122550109 -879828814 -2141290898 -1693191468 2069740562 56391518 -1815243770 1543290930 -1585573428 -179375393 1787281013 -1110333595 546262155 832456488 2065297177 261927850 -1383149127 361635259 1532059390 -1119251707 -992921347 356488200 1989513353 1228316083 1008922022 -576014217 -1783610263 449333983 -740918930 -1987374478 -618009384 1601411327 -1699672141 -477750673 -1478950827 -1399246677 -462874312 492734790 -1926921600 144520342 1491223824 1816922187 -951509023 -2001785313 2036585034 874017895 1444136166 1960001120 -800149902 1837197618 -129340943 -1388048257 -227357915
    ${output}=    Read Until Prompt
    Log    ${output}
    Should Contain X Times    ${output}    === [putSample] m1m3::logevent_AppliedCylinderForces writing a message containing :    1
    Should Contain    ${output}    revCode \ :
    Should Contain    ${output}    === Event AppliedCylinderForces generated =

Read Logger
    [Tags]    functional
    Switch Connection    Logger
    ${output}=    Read Until    priority : -227357915
    Log    ${output}
    Should Contain X Times    ${output}    === Event AppliedCylinderForces received =     1
    Should Contain    ${output}    Timestamp : 35.0907
    Should Contain    ${output}    SecondaryCylinderForces : 1372633962
    Should Contain    ${output}    PrimaryCylinderForces : -49600899
    Should Contain    ${output}    priority : -1421101162
