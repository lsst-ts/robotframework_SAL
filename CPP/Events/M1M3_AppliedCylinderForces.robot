*** Settings ***
Documentation    M1M3_AppliedCylinderForces sender/logger tests.
Force Tags    cpp    TSS-2617
Suite Setup    Run Keywords    Log Many    ${Host}    ${subSystem}    ${component}    ${timeout}
...    AND    Create Session    Sender    AND    Create Session    Logger
Suite Teardown    Close All Connections
Library    SSHLibrary
Resource    ../../Global_Vars.robot
Resource    ../../common.robot

*** Variables ***
${subSystem}    m1m3
${component}    AppliedCylinderForces
${timeout}    30s

*** Test Cases ***
Verify Component Sender and Logger
    [Tags]    smoke
    File Should Exist    ${SALWorkDir}/${subSystem}/cpp/src/sacpp_${subSystem}_${component}_send
    File Should Exist    ${SALWorkDir}/${subSystem}/cpp/src/sacpp_${subSystem}_${component}_log

Start Sender - Verify Missing Inputs Error
    [Tags]    functional
    Switch Connection    Sender
    Comment    Move to working directory.
    Write    cd ${SALWorkDir}/${subSystem}/cpp/src
    Comment    Start Sender.
    ${input}=    Write    ./sacpp_${subSystem}_${component}_send 
    ${output}=    Read Until Prompt
    Log    ${output}
    Should Contain    ${output}   Usage :  input parameters...

Start Logger
    [Tags]    functional
    Switch Connection    Logger
    Comment    Move to working directory.
    Write    cd ${SALWorkDir}/${subSystem}/cpp/src
    Comment    Start Logger.
    ${input}=    Write    ./sacpp_${subSystem}_${component}_log
    ${output}=    Read Until    logger ready =
    Log    ${output}
    Should Contain    ${output}    Event ${component} logger ready

Start Sender
    [Tags]    functional
    Switch Connection    Sender
    Comment    Move to working directory.
    Write    cd ${SALWorkDir}/${subSystem}/cpp/src
    Comment    Start Sender.
    ${input}=    Write    ./sacpp_${subSystem}_${component}_send 9.696 -393170347 1017150919 -1826261321 1188881274 -1273234067 1718979833 1065627557 750109535 1110181010 697449096 2100783709 1542756872 161471799 -1172535005 1244644390 -1395182976 1444567974 1103304198 -223359545 803333772 -1268034732 1610062521 815203438 20561311 -2000326760 396969197 -1608321117 1948812843 -194400429 42037100 -160655069 1267132479 387314696 -879397627 523272993 -490851927 935872343 -498977767 -784197485 1899589719 25097475 640182107 122855158 -784195344 1122475760 1381956684 -265443192 -218559494 -1068799419 -154147397 283536291 970174575 -1581365180 -691640268 -249428672 -1521042739 1487358388 -1930447592 -1790734813 -738201118 265888580 -1528017941 482242960 -1771172767 -989006611 109750640 5973021 -522786457 1409385392 288057825 -777184592 -740645765 2126150928 -1549287942 1010694782 -606286253 -827396510 -533085701 388491740 -703319085 1555853508 -1767205364 -1748803463 703617655 -754180978 -440237773 1754443872 -1928204403 -649146281 1658200187 -1525587347 1099414297 -1804083200 -749417687 950698017 591728273 -1982373261 439764644 255529200 -1543411621 -1839563469 -1943388509 -2139942746 -2028843629 1189357022 326877657 -483912122 -811898500 1240342356 2078556909 276068994 -1049422532 -886182663 1922234004 802614139 622303508 1723284593 -676913856 -1382621433 597286417 -628622024 -1408046100 1108462026 -889792924 -2074193944 -172826458 820049157 1591971878 624861852 -1325513842 -1893145962 -824040613 -1173992125 1262900721 -2125620961 -1737886780 -2046803968 1001681961 -1472782616 1592359098 -905007865 -860463847 1661339072 2066406902 -490333974 1340836572 -669449273 1414932125 -714511031 -1245012789 781572664 -2142513238 -25252118 -2004816257 -671419185 -1983064244 -524456910 -1516343687 -2608225 1002353687 -1732681579 2048276444 399612087 1332370131 -213356719 754464334 -65663103 -1447604941 -507172154 48476953 1836570111 1019383521 -824518274 1414331266 75193304 -560198822 -1370622983 -1989448197 -1998508138 -743822758 1594023284 973566175 -191409043 -1226791314 369417073 713345415 95976214 -519065592 1849890310 -593550351 -1363876152 616743238 -341753223 -1134143948 -1457998795 1757655911 1506262106 875214526 92239322 -441307954 417092377 1581435161 -1828776361 -1019296992 1706249960 376807082 2102768129 1712312086 -1353963919 -1966282924 2113015547 1543345193 -1902936876 -2111692789 1333683602 2060860303 -1021090946 1654099567 -1938498890 1807803285 2015291111 -740897313 907610756 -1012655772 1209574303 -1315038079 -953605124 -280817368 568386754 -955567803 1217505296 824521518 -455392444 -1871134780 2088345558 729517774 -1607426447 2113785469 1802357899 775893563 -276794106 943857675 -77505942 519858465 566266334 162829170 -1247970228 1094260803 -1259865782 -820753710 -520005058 -1151619512 -1379562750 888687628 -1455894377 -1812096327 -1181219494 -1255552786 868335286 -1295123830 -1067038162 1389759247 423146285 -1841884818 -1629690833 1096269463 -626795376 369453728 1158969605
    ${output}=    Read Until Prompt
    Log    ${output}
    Should Contain X Times    ${output}    === [putSample] m1m3::logevent_AppliedCylinderForces writing a message containing :    1
    Should Contain    ${output}    revCode \ :
    Should Contain    ${output}    === Event AppliedCylinderForces generated =

Read Logger
    [Tags]    functional
    Switch Connection    Logger
    ${output}=    Read Until    priority : 1158969605
    Log    ${output}
    Should Contain X Times    ${output}    === Event AppliedCylinderForces received =     1
    Should Contain    ${output}    Timestamp : 9.696
    Should Contain    ${output}    SecondaryCylinderForces : -393170347
    Should Contain    ${output}    PrimaryCylinderForces : 1017150919
    Should Contain    ${output}    priority : -1826261321
