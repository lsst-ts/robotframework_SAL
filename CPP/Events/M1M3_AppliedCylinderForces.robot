*** Settings ***
Documentation    M1M3_AppliedCylinderForces sender/logger tests.
Force Tags    cpp    TSS-2617
Suite Setup    Run Keywords    Log Many    ${Host}    ${subSystem}    ${component}    ${timeout}
...    AND    Create Session    Sender    AND    Create Session    Logger
Suite Teardown    Close All Connections
Library    SSHLibrary
Resource    ../../Global_Vars.robot
Resource    ../../common.robot

*** Variables ***
${subSystem}    m1m3
${component}    AppliedCylinderForces
${timeout}    30s

*** Test Cases ***
Verify Component Sender and Logger
    [Tags]    smoke
    File Should Exist    ${SALWorkDir}/${subSystem}/cpp/src/sacpp_${subSystem}_${component}_send
    File Should Exist    ${SALWorkDir}/${subSystem}/cpp/src/sacpp_${subSystem}_${component}_log

Start Sender - Verify Missing Inputs Error
    [Tags]    functional
    Switch Connection    Sender
    Comment    Move to working directory.
    Write    cd ${SALWorkDir}/${subSystem}/cpp/src
    Comment    Start Sender.
    ${input}=    Write    ./sacpp_${subSystem}_${component}_send 
    ${output}=    Read Until Prompt
    Log    ${output}
    Should Contain    ${output}   Usage :  input parameters...

Start Logger
    [Tags]    functional
    Switch Connection    Logger
    Comment    Move to working directory.
    Write    cd ${SALWorkDir}/${subSystem}/cpp/src
    Comment    Start Logger.
    ${input}=    Write    ./sacpp_${subSystem}_${component}_log
    ${output}=    Read Until    logger ready =
    Log    ${output}
    Should Contain    ${output}    Event ${component} logger ready

Start Sender
    [Tags]    functional
    Switch Connection    Sender
    Comment    Move to working directory.
    Write    cd ${SALWorkDir}/${subSystem}/cpp/src
    Comment    Start Sender.
    ${input}=    Write    ./sacpp_${subSystem}_${component}_send 13.3937 1219958282 1748964119 105165755 1950016599 1318447130 -955832953 1144199067 -1110698746 -1826351290 -287105475 -728167036 1044893326 -287848149 294246418 1900366980 -690758047 -1393424141 1407236281 -1328327655 -770607290 -1602442474 1440551180 2123950344 106984920 -1576299331 1249749114 -1713610548 -1418032988 -1509496425 -416951970 -2038999663 609913839 34633933 1132221635 1737677655 32498212 -1478260463 -648350229 -1340057276 357578906 1194973494 1601038472 -1103779655 1706671213 -1479123870 -1920867218 -910764974 1179644188 2002287304 1770099236 -399424610 -1235641278 207566883 -1533826980 -316400818 -344182779 1251425948 1524687974 1291625774 2034068123 -1873103518 533396121 707206410 204895008 -2115477146 -661377273 576188722 -545469959 -1148636208 -1405398580 490917564 1132937699 1831368384 -945118563 410107273 -13929489 -408074884 813837743 -144674808 -1109214338 540626794 1683500867 69272068 2004586114 1412177869 -529821389 272266501 -2140169574 -1932945485 -1725276198 -435795138 -1708330921 -230188437 -1518569420 378460921 -848820395 -517834606 -1480778066 -2070831595 1350532978 -496809093 992137228 -131906889 -124155320 866018355 1158025685 -798925794 -648109217 641355811 876603895 -1567577981 -1294855911 924626971 264428529 -274946207 -650741651 -1740109286 -1691821896 -359129785 -1294986031 -366582319 -1386175445 -166120872 -96471772 2021104619 1679139477 -877455232 1932227476 -1819580082 -1789583008 -1151803092 1487517996 1999481027 497750102 1278403578 -2134720702 1942783118 -561820023 123466576 -1447770785 -707124302 -895045707 1354083528 -568722976 -521605922 1306384925 -477194007 765082482 82061428 1535042632 1619904221 -2095153528 2009036258 -1753865106 1992532165 -1004569179 -2008432641 -1420579565 259649236 -349489343 1238627328 -186069042 -782951284 -1566312567 647960589 1893104565 -499948627 523022144 610791130 -1370113051 309094578 2133717276 1906189252 -852879845 -1970229820 1388266603 672186483 -71066841 1334941407 2078475769 1857694948 -401937052 762041379 -1900051938 -1134991514 -1210792464 -781061902 -367275263 -267256414 -1575917673 332197770 1834937201 -652426126 -893296371 -1319655219 -681288422 841556765 911333917 664185644 736536906 -248029937 -2047243477 -165571229 -764114837 1046671748 2096534753 -543238019 -2124338549 1686483906 1701593309 1261356172 1086941421 -1182908523 -476503800 -1536618532 552624569 605613015 -113565401 1891880168 5329758 -387082029 -1799843777 -222570827 21164861 -65138494 -1297951654 -167574644 977545027 1325508709 -1902355303 1949775868 -1089492717 -1187164495 -1094248007 156741623 812172820 -565619141 1816547230 1314180969 1281679533 880479823 1537269989 1498250452 2135717751 68463330 -331649403 -1810211802 -1687765898 -1950086026 1350903397 -6976445 -598358983 794077292 -512594953 -281116363 1099632211 668713832 -440823935 148443592 -937701136 -1575971556 2102130053 -901787991 1352569253 1653928481 247481355 -877920622 755990391 1842135156
    ${output}=    Read Until Prompt
    Log    ${output}
    Should Contain X Times    ${output}    === [putSample] m1m3::logevent_AppliedCylinderForces writing a message containing :    1
    Should Contain    ${output}    revCode \ :
    Should Contain    ${output}    === Event AppliedCylinderForces generated =

Read Logger
    [Tags]    functional
    Switch Connection    Logger
    ${output}=    Read Until    priority : 1842135156
    Log    ${output}
    Should Contain X Times    ${output}    === Event AppliedCylinderForces received =     1
    Should Contain    ${output}    Timestamp : 13.3937
    Should Contain    ${output}    SecondaryCylinderForces : 1219958282
    Should Contain    ${output}    PrimaryCylinderForces : 1748964119
    Should Contain    ${output}    priority : 105165755
