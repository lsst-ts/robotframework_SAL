*** Settings ***
Documentation    M1M3_AppliedCylinderForces sender/logger tests.
Force Tags    cpp    TSS-2617
Suite Setup    Run Keywords    Log Many    ${Host}    ${subSystem}    ${component}    ${timeout}
...    AND    Create Session    Sender    AND    Create Session    Logger
Suite Teardown    Close All Connections
Library    SSHLibrary
Resource    ../../Global_Vars.robot
Resource    ../../common.robot

*** Variables ***
${subSystem}    m1m3
${component}    AppliedCylinderForces
${timeout}    30s

*** Test Cases ***
Verify Component Sender and Logger
    [Tags]    smoke
    File Should Exist    ${SALWorkDir}/${subSystem}/cpp/src/sacpp_${subSystem}_${component}_send
    File Should Exist    ${SALWorkDir}/${subSystem}/cpp/src/sacpp_${subSystem}_${component}_log

Start Sender - Verify Missing Inputs Error
    [Tags]    functional
    Switch Connection    Sender
    Comment    Move to working directory.
    Write    cd ${SALWorkDir}/${subSystem}/cpp/src
    Comment    Start Sender.
    ${input}=    Write    ./sacpp_${subSystem}_${component}_send 
    ${output}=    Read Until Prompt
    Log    ${output}
    Should Contain    ${output}   Usage :  input parameters...

Start Logger
    [Tags]    functional
    Switch Connection    Logger
    Comment    Move to working directory.
    Write    cd ${SALWorkDir}/${subSystem}/cpp/src
    Comment    Start Logger.
    ${input}=    Write    ./sacpp_${subSystem}_${component}_log
    ${output}=    Read Until    logger ready =
    Log    ${output}
    Should Contain    ${output}    Event ${component} logger ready

Start Sender
    [Tags]    functional
    Switch Connection    Sender
    Comment    Move to working directory.
    Write    cd ${SALWorkDir}/${subSystem}/cpp/src
    Comment    Start Sender.
    ${input}=    Write    ./sacpp_${subSystem}_${component}_send 69.4135 -1073319950 1993779298 -1933244974 502267253 -1128182829 -627738884 -1946529716 1781976117 452040408 -845264302 389835607 -1152271101 -1938776278 -1987554942 -1195473920 -233345981 1462660581 201243166 2109375757 -1496055627 -1522368439 -1240516302 27264251 952919700 1431894028 2051845512 -1686048931 -2037672706 -957408594 -969314406 142643536 508945633 686308314 212730192 -1018027777 -2112993606 -1696696715 713064744 -1061472380 57068156 528950301 -405572542 1829109674 -1368395423 1171692799 -1997022065 -1559679289 246269992 -309712828 1502934487 -1491458001 843760572 898832888 -107755896 1187344436 -904728764 -1596577950 -958032693 -686322813 -1361910060 23848504 1867162047 -1885891709 -1693034579 325619802 -1641422308 -2075941533 -1677348654 -2079809757 -330564154 -149599461 -1288737799 -297213064 1534924565 1962974821 -723747060 -1516525040 1623751075 364995020 -1621817470 -1755272026 -2138143978 -2005217312 1972771208 -1777948153 1390245202 -959389808 -323237906 645500299 1853534005 -1329267511 1680218177 527316660 1879449319 1047556541 -1477819463 -556335775 872185284 1322833926 1508446653 1205188715 1285602171 -499349159 36569963 -876574498 1316438219 -1237436110 -1669892851 -31976282 1026753132 544773026 2001412529 592051358 -1451895330 -812213625 -1724330306 1879171039 2105582391 1505367427 1131843335 -842474626 -478364493 -1997396842 -1862398978 1646980735 1459648166 -59162307 1912563372 2067198323 -1334183281 -713220732 858390611 818407584 -1058808572 -642398309 518411199 245844277 -1151913794 -212370563 456554343 -642797783 -199731127 1693722177 -1022058243 155695100 -2016080670 -1586837283 918045074 1861999955 1953090480 -209487168 -2118827323 1225107417 1888105925 1117457983 1132259935 -1010859842 -1663976740 -1914877953 1189235726 1169392124 1709287131 1714669567 -2008388158 992211038 1159833364 239939329 1468103849 -894851316 1185663850 2137061009 507016944 -158887002 -1477453724 -1937144358 919858303 1154782394 -1722779835 1392324482 1197639959 1576233365 -134815859 -2079683676 -1990952365 -767035712 -1463816314 1481497624 -1302893251 1516907685 -1526367353 -511016696 -523780584 672907868 -1618051210 -1573482396 -553012576 -12926783 -1171204033 523281191 314018482 282161513 -714309229 -1830513855 1994572462 1571861190 414799105 289026337 798585454 2144657824 -623867852 -379558244 117179262 1575174200 -2083798672 2074346901 -1025817207 -419798015 -689422542 -96050299 -1578241896 1998670562 735316000 -1761319793 -691615309 -680103935 -739104407 -416084280 -953983449 1074275797 -1910444076 -1853104841 -829879089 -1242107220 -1841188155 1896686513 1563930063 1626449762 -758118889 476172541 1785611831 368688203 -422389781 1209570513 1452918659 -1023167994 -302918439 1434495568 -1016703035 -2053393185 -340714132 -323520740 -2144793447 -1552459670 -758223373 1271141432 -854840981 -1747802522 -843912703 887043865 653548778 -1423179638 -445805139 2146682952 -804834149 -21518892 1049212205 -1099428383 166014993 -375084619
    ${output}=    Read Until Prompt
    Log    ${output}
    Should Contain X Times    ${output}    === [putSample] m1m3::logevent_AppliedCylinderForces writing a message containing :    1
    Should Contain    ${output}    revCode \ :
    Should Contain    ${output}    === Event AppliedCylinderForces generated =

Read Logger
    [Tags]    functional
    Switch Connection    Logger
    ${output}=    Read Until    priority : -375084619
    Log    ${output}
    Should Contain X Times    ${output}    === Event AppliedCylinderForces received =     1
    Should Contain    ${output}    Timestamp : 69.4135
    Should Contain    ${output}    SecondaryCylinderForces : -1073319950
    Should Contain    ${output}    PrimaryCylinderForces : 1993779298
    Should Contain    ${output}    priority : -1933244974
