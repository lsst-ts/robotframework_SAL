*** Settings ***
Documentation    Hexapod_configureLut commander/controller tests.
Suite Setup    Log Many    ${Host}    ${subSystem}    ${component}    ${timeout}
Suite Teardown    Close All Connections
Library    SSHLibrary
Library    String
Resource    ../../Global_Vars.robot

*** Variables ***
${subSystem}    hexapod
${component}    configureLut
${timeout}    30s

*** Test Cases ***
Create Commander Session
    [Documentation]    Connect to the SAL host.
    [Tags]    smoke
    Comment    Connect to host.
    Open Connection    host=${Host}    alias=Commander    timeout=${timeout}    prompt=${Prompt}
    Comment    Login.
    Log    ${ContInt}
    Run Keyword If    "${ContInt}"=="false"    Login    ${UserName}    ${PassWord}
    Run Keyword If    "${ContInt}"=="true"    Login With Public Key    ${UserName}    keyfile=${PassWord}
    Directory Should Exist    ${SALInstall}
    Directory Should Exist    ${SALHome}
    Directory Should Exist    ${SALWorkDir}/${subSystem}

Create Controller Session
    [Documentation]    Connect to the SAL host.
    [Tags]    smoke
    Comment    Connect to host.
    Open Connection    host=${Host}    alias=Controller    timeout=${timeout}    prompt=${Prompt}
    Comment    Login.
    Log    ${ContInt}
    Run Keyword If    "${ContInt}"=="false"    Login    ${UserName}    ${PassWord}
    Run Keyword If    "${ContInt}"=="true"    Login With Public Key    ${UserName}    keyfile=${PassWord}
    Directory Should Exist    ${SALInstall}
    Directory Should Exist    ${SALHome}
    Directory Should Exist    ${SALWorkDir}/${subSystem}

Verify Component Commander and Controller
    [Tags]    smoke
    File Should Exist    ${SALWorkDir}/${subSystem}/cpp/src/sacpp_${subSystem}_${component}_commander
    File Should Exist    ${SALWorkDir}/${subSystem}/cpp/src/sacpp_${subSystem}_${component}_controller

Start Commander - Verify Missing Inputs Error
    [Tags]    functional
    Switch Connection    Commander
    Comment    Move to working directory.
    Write    cd ${SALWorkDir}/${subSystem}/cpp/src
    Comment    Start Commander.
    ${input}=    Write    ./sacpp_${subSystem}_${component}_commander 
    ${output}=    Read Until Prompt
    Log    ${output}
    Should Contain    ${output}   Usage : \ input parameters...

Start Commander - Verify Timeout without Controller
    [Tags]    functional
    Switch Connection    Commander
    Comment    Move to working directory.
    Write    cd ${SALWorkDir}/${subSystem}/cpp/src
    Comment    Start Commander.
    ${input}=    Write    ./sacpp_${subSystem}_${component}_commander 37.9184 67.4094 22.0265 32.0259 77.4386 71.3933 29.4025 13.2867 53.0069 79.6493 67.4338 89.8666 23.5288 63.7072 86.0555 69.0444 38.074 57.5123 33.4584 42.013 36.6036 49.8107 35.1724 59.6975 48.3232 30.5245 57.6603 91.4355 12.0367 84.0856 88.199 71.7127 67.6011 50.2382 79.493 13.5246 4.7112 54.6752 34.3165 24.4537 87.1515 27.7526 93.4577 80.3118 34.0801 88.6123 83.9639 13.9264 34.7402 16.1821 7.5408 65.0764 21.4251 85.2825 75.8378 75.9478 65.9544 94.6753 72.3117 36.9553 77.9811 70.1995 38.9214 14.1774 90.9091 31.5261 77.3926 70.8288 68.3822 44.5242 47.104 80.28 26.163 89.2149 5.4626 50.7602 53.0935 76.1451 43.1183 16.8654 40.6393 98.666 24.0847 8.8434 20.8218 86.4253 6.1294 22.4411 78.4492 66.9773 6.1921 24.7777 71.4845 45.8421 30.6296 34.9902 21.8389 87.8589 78.6569 40.2598 41.5546 26.0817 59.8157 15.6174 86.9211 40.8846 72.8815 61.6374 92.5509 50.9613 6.5255 42.9707 69.3699 84.9782 92.4009 74.7677 94.1417 92.9084 77.3591 57.9321 21.1709 85.8359 91.942 47.0956 90.8972 20.7389 44.337 39.8422 93.3713 72.7095 48.2737 65.2034 7.1253 71.2391 67.3726 27.7029 61.9855 43.9335 61.6541 51.6922 32.1079 47.874 63.6952 92.1257 87.3538 58.1333 40.1383 61.5614 9.3493 80.4719 38.9367 42.1306 87.277 86.1478 31.6913 4.7093 25.262 35.5301 84.0076 31.6637 40.3253 53.9887 37.6595 12.7419 71.1018 95.2253 43.3703 15.5404 23.2616 46.7923 89.4507 56.901 11.5629 5.5904 3.7895 58.2488 77.2696 15.1602 70.5579 29.6793 10.1711 34.7802 59.7343 69.3015 58.3205 66.6282 26.0374 79.0539 16.1706 52.2612 16.81 64.6879 93.4265 87.2186 64.0736 83.4921 77.158 56.5194 11.3373 80.2683 47.7494 8.2979 14.8152 65.0652 16.4655 11.3147 44.2297 28.0227 36.941 26.6328 97.8192 84.0621 80.9031 94.2552 64.9497 1.23 64.899 13.5225 25.8741 3.1535 77.0369 86.7825 72.4854 57.5564 74.9059 17.4523 63.6593 31.2447 17.5883 39.929 73.2193 18.8192 76.6225 90.3165 92.1165 88.6396 97.8565 14.4369 94.1703 8.3057 87.5308 65.3239 92.7841 28.8297 42.3601 87.5979 79.1794 75.1559 16.5818 10.8757 6.9386 29.2075 89.3069 78.1038 53.0487 35.2788 95.5075 84.8315 93.096 96.3357 71.678 50.5392 13.4424 7.3322 30.1449 35.3733 8.6229 91.345 40.622 73.4747 19.1307 66.4895 36.6234 34.7543 86.3099 27.5895 1.7545 1.1323 3.3192 12.3255 63.444 59.6079 18.7072 95.0167 46.5751 80.8173 56.9085 12.5463 27.8938 17.0277 50.4876 3.9191 17.2723 52.3276 32.0647 93.9277 68.299 77.5036 47.9478 75.4197 4.1771 6.3027 38.1976 35.3188 99.5576 84.6227 30.0633 30.1535 35.1443 90.9767 37.726 77.1744 13.6475 76.6274 38.7831 60.9797 23.4469 90.4564 72.5678 68.3897 67.8865 15.1473 31.4209 95.1164 93.128 48.7481 50.1456 23.8014 81.7271 8.0085 25.4206 21.7694 48.3321 77.2765 26.4811 86.6712 77.221 36.112 60.3998 78.4423 45.8228 71.7914 15.5976 86.1951 56.2735 17.7946 39.1596 34.4192 31.5233 84.844 38.3221 98.0747 32.0795 38.3449 85.9812 16.2463 24.1986 28.9136 52.2591 93.0036 34.4928 92.5474 87.5405 14.3966 91.5402 87.3226 8.2827 64.3253 86.788 5.4774 7.6433 61.3094 11.3426 15.3176 20.1716 31.869 82.5335 79.9024 36.4165 84.0877 4.1748 79.7111 87.701 36.2693 83.4872 61.3159 39.2397 10.8781 4.5477 75.7452 79.3563 34.7129 59.9254 51.2892 5.8705 68.8192 89.6158 60.4036 68.8306 33.9593 43.4639 96.92 16.2621 46.9822 85.0357 28.6181 16.6474 37.1905 60.4528 91.2004 46.1905 61.742 63.9641 44.5187 1.8511 29.4757 45.3198 94.0624 3.31 1.8543 85.3988 54.3572 55.0542 10.2238 24.0181 10.717 60.7797 75.0067 91.2856 93.5143 55.759 7.6112 99.7262 59.9269 59.6155 14.4729 63.9985 49.254 93.276 80.1778 59.3304 91.9921 2.2099 92.3383 10.3968 46.0007 60.4092 61.2709 56.9215 12.3128 44.3584 67.2408 36.4189 89.8579 81.4326 18.1554 18.941 94.7477 35.1075 24.0728 13.6163 16.1647 83.1596 83.2241 22.1503 39.0806 19.1421 58.9432 10.0343 7.362 70.4133 66.6329 18.9061 66.8051 44.0036 71.3526 50.8998 79.4212 1.1687 7.8784 65.8602 73.5682 7.5814 97.2307 64.7228 60.0073 60.6406 80.4923 86.6088 30.7921 1.9931 59.7926 24.5143 80.9426 5.5686 70.3805 59.0098 93.9067 9.4632 43.0518 70.5393 37.1512 5.172 47.6261 71.5463 60.6547 51.5035 63.9269 61.242 31.9868 19.926 74.3126 32.5858 57.8035 7.0802 69.336 8.0681 40.6862 92.3409 79.7464 1.8439 47.3003 38.342 27.6318 43.3399 24.1911 45.6487 46.6936 87.5436 39.6024 49.7191 75.2758 35.3323 76.8885 31.048 79.1666 15.6626 75.216 25.6314 30.4174
    ${output}=    Read Until Prompt
    Log    ${output}
    ${CmdComplete}=    Get Line    ${output}    -2
    Should Match Regexp    ${CmdComplete}    (=== \\[waitForCompletion_${component}\\] command )[0-9]+( timed out :)

Start Controller
    [Tags]    functional
    Switch Connection    Controller
    Comment    Move to working directory.
    Write    cd ${SALWorkDir}/${subSystem}/cpp/src
    Comment    Start Controller.
    ${input}=    Write    ./sacpp_${subSystem}_${component}_controller
    ${output}=    Read Until    controller ready
    Log    ${output}
    Should Contain    ${output}    ${subSystem}_${component} controller ready

Start Commander
    [Tags]    functional
    Switch Connection    Commander
    Comment    Move to working directory.
    Write    cd ${SALWorkDir}/${subSystem}/cpp/src
    Comment    Start Commander.
    ${input}=    Write    ./sacpp_${subSystem}_${component}_commander 37.9184 67.4094 22.0265 32.0259 77.4386 71.3933 29.4025 13.2867 53.0069 79.6493 67.4338 89.8666 23.5288 63.7072 86.0555 69.0444 38.074 57.5123 33.4584 42.013 36.6036 49.8107 35.1724 59.6975 48.3232 30.5245 57.6603 91.4355 12.0367 84.0856 88.199 71.7127 67.6011 50.2382 79.493 13.5246 4.7112 54.6752 34.3165 24.4537 87.1515 27.7526 93.4577 80.3118 34.0801 88.6123 83.9639 13.9264 34.7402 16.1821 7.5408 65.0764 21.4251 85.2825 75.8378 75.9478 65.9544 94.6753 72.3117 36.9553 77.9811 70.1995 38.9214 14.1774 90.9091 31.5261 77.3926 70.8288 68.3822 44.5242 47.104 80.28 26.163 89.2149 5.4626 50.7602 53.0935 76.1451 43.1183 16.8654 40.6393 98.666 24.0847 8.8434 20.8218 86.4253 6.1294 22.4411 78.4492 66.9773 6.1921 24.7777 71.4845 45.8421 30.6296 34.9902 21.8389 87.8589 78.6569 40.2598 41.5546 26.0817 59.8157 15.6174 86.9211 40.8846 72.8815 61.6374 92.5509 50.9613 6.5255 42.9707 69.3699 84.9782 92.4009 74.7677 94.1417 92.9084 77.3591 57.9321 21.1709 85.8359 91.942 47.0956 90.8972 20.7389 44.337 39.8422 93.3713 72.7095 48.2737 65.2034 7.1253 71.2391 67.3726 27.7029 61.9855 43.9335 61.6541 51.6922 32.1079 47.874 63.6952 92.1257 87.3538 58.1333 40.1383 61.5614 9.3493 80.4719 38.9367 42.1306 87.277 86.1478 31.6913 4.7093 25.262 35.5301 84.0076 31.6637 40.3253 53.9887 37.6595 12.7419 71.1018 95.2253 43.3703 15.5404 23.2616 46.7923 89.4507 56.901 11.5629 5.5904 3.7895 58.2488 77.2696 15.1602 70.5579 29.6793 10.1711 34.7802 59.7343 69.3015 58.3205 66.6282 26.0374 79.0539 16.1706 52.2612 16.81 64.6879 93.4265 87.2186 64.0736 83.4921 77.158 56.5194 11.3373 80.2683 47.7494 8.2979 14.8152 65.0652 16.4655 11.3147 44.2297 28.0227 36.941 26.6328 97.8192 84.0621 80.9031 94.2552 64.9497 1.23 64.899 13.5225 25.8741 3.1535 77.0369 86.7825 72.4854 57.5564 74.9059 17.4523 63.6593 31.2447 17.5883 39.929 73.2193 18.8192 76.6225 90.3165 92.1165 88.6396 97.8565 14.4369 94.1703 8.3057 87.5308 65.3239 92.7841 28.8297 42.3601 87.5979 79.1794 75.1559 16.5818 10.8757 6.9386 29.2075 89.3069 78.1038 53.0487 35.2788 95.5075 84.8315 93.096 96.3357 71.678 50.5392 13.4424 7.3322 30.1449 35.3733 8.6229 91.345 40.622 73.4747 19.1307 66.4895 36.6234 34.7543 86.3099 27.5895 1.7545 1.1323 3.3192 12.3255 63.444 59.6079 18.7072 95.0167 46.5751 80.8173 56.9085 12.5463 27.8938 17.0277 50.4876 3.9191 17.2723 52.3276 32.0647 93.9277 68.299 77.5036 47.9478 75.4197 4.1771 6.3027 38.1976 35.3188 99.5576 84.6227 30.0633 30.1535 35.1443 90.9767 37.726 77.1744 13.6475 76.6274 38.7831 60.9797 23.4469 90.4564 72.5678 68.3897 67.8865 15.1473 31.4209 95.1164 93.128 48.7481 50.1456 23.8014 81.7271 8.0085 25.4206 21.7694 48.3321 77.2765 26.4811 86.6712 77.221 36.112 60.3998 78.4423 45.8228 71.7914 15.5976 86.1951 56.2735 17.7946 39.1596 34.4192 31.5233 84.844 38.3221 98.0747 32.0795 38.3449 85.9812 16.2463 24.1986 28.9136 52.2591 93.0036 34.4928 92.5474 87.5405 14.3966 91.5402 87.3226 8.2827 64.3253 86.788 5.4774 7.6433 61.3094 11.3426 15.3176 20.1716 31.869 82.5335 79.9024 36.4165 84.0877 4.1748 79.7111 87.701 36.2693 83.4872 61.3159 39.2397 10.8781 4.5477 75.7452 79.3563 34.7129 59.9254 51.2892 5.8705 68.8192 89.6158 60.4036 68.8306 33.9593 43.4639 96.92 16.2621 46.9822 85.0357 28.6181 16.6474 37.1905 60.4528 91.2004 46.1905 61.742 63.9641 44.5187 1.8511 29.4757 45.3198 94.0624 3.31 1.8543 85.3988 54.3572 55.0542 10.2238 24.0181 10.717 60.7797 75.0067 91.2856 93.5143 55.759 7.6112 99.7262 59.9269 59.6155 14.4729 63.9985 49.254 93.276 80.1778 59.3304 91.9921 2.2099 92.3383 10.3968 46.0007 60.4092 61.2709 56.9215 12.3128 44.3584 67.2408 36.4189 89.8579 81.4326 18.1554 18.941 94.7477 35.1075 24.0728 13.6163 16.1647 83.1596 83.2241 22.1503 39.0806 19.1421 58.9432 10.0343 7.362 70.4133 66.6329 18.9061 66.8051 44.0036 71.3526 50.8998 79.4212 1.1687 7.8784 65.8602 73.5682 7.5814 97.2307 64.7228 60.0073 60.6406 80.4923 86.6088 30.7921 1.9931 59.7926 24.5143 80.9426 5.5686 70.3805 59.0098 93.9067 9.4632 43.0518 70.5393 37.1512 5.172 47.6261 71.5463 60.6547 51.5035 63.9269 61.242 31.9868 19.926 74.3126 32.5858 57.8035 7.0802 69.336 8.0681 40.6862 92.3409 79.7464 1.8439 47.3003 38.342 27.6318 43.3399 24.1911 45.6487 46.6936 87.5436 39.6024 49.7191 75.2758 35.3323 76.8885 31.048 79.1666 15.6626 75.216 25.6314 30.4174
    ${output}=    Read Until Prompt
    Log    ${output}
    Should Contain X Times    ${output}    === [issueCommand_${component}] writing a command containing :    1
    Should Contain X Times    ${output}    device : target    1
    Should Contain X Times    ${output}    property : lut    1
    Should Contain X Times    ${output}    action :     1
    Should Contain X Times    ${output}    value :     1
    Should Contain X Times    ${output}    xlut : 37.9184    1
    Should Contain X Times    ${output}    ylut : 6.1921    1
    Should Contain X Times    ${output}    zlut : 10.1711    1
    Should Contain X Times    ${output}    ulut : 19.1307    1
    Should Contain X Times    ${output}    vlut : 34.4928    1
    Should Contain X Times    ${output}    wlut : 44.3584    1
    Should Contain    ${output}    === command configureLut issued =
    ${CmdComplete}=    Get Line    ${output}    -2
    Should Match Regexp    ${CmdComplete}    (=== \\[waitForCompletion_${component}\\] command )[0-9]+( completed ok :)

Read Controller
    [Tags]    functional
    Switch Connection    Controller
    ${output}=    Read Until    result \ \ : Done : OK
    Log    ${output}
    Should Contain    ${output}    === command configureLut received =
    Should Contain    ${output}    device : target
    Should Contain    ${output}    property : lut
    Should Contain    ${output}    action : 
    Should Contain    ${output}    value : 
    Should Contain X Times    ${output}    xlut : 37.9184    1
    Should Contain X Times    ${output}    ylut : 6.1921    1
    Should Contain X Times    ${output}    zlut : 10.1711    1
    Should Contain X Times    ${output}    ulut : 19.1307    1
    Should Contain X Times    ${output}    vlut : 34.4928    1
    Should Contain X Times    ${output}    wlut : 44.3584    1
    Should Contain X Times    ${output}    === [ackCommand_configureLut] acknowledging a command with :    2
    Should Contain    ${output}    seqNum   :
    Should Contain    ${output}    ack      : 301
    Should Contain X Times    ${output}    error \ \ \ : 0    2
    Should Contain    ${output}    result   : Ack : OK
    Should Contain    ${output}    ack      : 303
    Should Contain    ${output}    result   : Done : OK
