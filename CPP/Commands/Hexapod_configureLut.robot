*** Settings ***
Documentation    Hexapod_configureLut commander/controller tests.
Force Tags    cpp
Suite Setup    Log Many    ${Host}    ${subSystem}    ${component}    ${timeout}
Suite Teardown    Close All Connections
Library    SSHLibrary
Library    String
Resource    ../../Global_Vars.robot

*** Variables ***
${subSystem}    hexapod
${component}    configureLut
${timeout}    30s

*** Test Cases ***
Create Commander Session
    [Documentation]    Connect to the SAL host.
    [Tags]    smoke
    Comment    Connect to host.
    Open Connection    host=${Host}    alias=Commander    timeout=${timeout}    prompt=${Prompt}
    Comment    Login.
    Log    ${ContInt}
    Login With Public Key    ${UserName}    keyfile=${KeyFile}    password=${PassWord}
    Directory Should Exist    ${SALInstall}
    Directory Should Exist    ${SALHome}

Create Controller Session
    [Documentation]    Connect to the SAL host.
    [Tags]    smoke
    Comment    Connect to host.
    Open Connection    host=${Host}    alias=Controller    timeout=${timeout}    prompt=${Prompt}
    Comment    Login.
    Log    ${ContInt}
    Login With Public Key    ${UserName}    keyfile=${KeyFile}    password=${PassWord}
    Directory Should Exist    ${SALInstall}
    Directory Should Exist    ${SALHome}

Verify Component Commander and Controller
    [Tags]    smoke
    File Should Exist    ${SALWorkDir}/${subSystem}/cpp/src/sacpp_${subSystem}_${component}_commander
    File Should Exist    ${SALWorkDir}/${subSystem}/cpp/src/sacpp_${subSystem}_${component}_controller

Start Commander - Verify Missing Inputs Error
    [Tags]    functional
    Switch Connection    Commander
    Comment    Move to working directory.
    Write    cd ${SALWorkDir}/${subSystem}/cpp/src
    Comment    Start Commander.
    ${input}=    Write    ./sacpp_${subSystem}_${component}_commander 
    ${output}=    Read Until Prompt
    Log    ${output}
    Should Contain    ${output}   Usage : \ input parameters...

Start Commander - Verify Timeout without Controller
    [Tags]    functional
    Switch Connection    Commander
    Comment    Move to working directory.
    Write    cd ${SALWorkDir}/${subSystem}/cpp/src
    Comment    Start Commander.
    ${input}=    Write    ./sacpp_${subSystem}_${component}_commander 56.249 29.6218 93.1438 86.7971 1.2244 51.7233 69.9535 38.4871 86.7926 49.8485 78.1071 83.573 58.5773 97.3384 4.6084 43.6187 76.5865 76.0091 51.2385 9.6321 56.8828 6.4421 58.2965 7.9013 8.8974 97.6233 38.1688 99.2168 25.2007 29.0525 74.4122 87.5226 4.111 61.3904 45.8536 78.1508 96.8015 92.7196 99.7317 98.5607 25.63 58.6881 62.1663 36.3459 25.0533 86.8043 16.3794 38.9951 17.3462 69.5221 89.5106 43.7575 19.2071 27.3022 5.9331 47.3052 49.5385 89.317 78.6821 87.1841 68.8664 47.0126 89.6112 67.9068 42.8773 87.1907 12.2822 29.3323 99.7051 39.0388 48.7815 3.1251 94.7107 21.0964 70.5222 11.7445 23.5778 94.8837 4.5437 69.2813 32.7281 58.1164 71.2194 30.9743 25.1123 49.5942 94.8862 2.981 82.7802 82.0955 67.1329 65.7323 97.81 89.5659 43.2252 51.149 45.2986 81.0913 76.4199 40.7293 11.2983 96.8427 0.9185 63.8417 1.7795 78.8744 27.818 86.112 69.0527 6.6982 46.6505 44.0623 39.1659 70.3371 31.6455 7.281 47.5077 90.7169 72.4725 55.722 67.8291 51.4228 7.4319 84.5423 38.6648 76.8662 18.3342 58.2931 92.8619 62.8696 65.134 62.5603 81.0325 38.7128 28.4816 24.0426 33.1242 41.7082 40.9122 66.9317 23.1272 8.3273 18.8256 31.0083 47.7614 91.9244 4.7717 69.3525 65.0538 19.3644 62.4663 96.3483 33.7496 84.615 86.3763 21.3859 17.5563 42.0068 13.2905 63.0983 94.3781 79.1335 14.8429 3.5265 41.9741 39.8073 65.627 92.4054 66.944 69.0316 38.7707 95.831 96.952 31.344 56.848 37.706 66.5217 83.9072 79.8777 0.524 30.2408 85.229 6.8196 7.305 65.1373 92.1153 73.0945 44.0089 15.8263 62.5274 30.5447 45.2689 45.7557 11.1474 18.8585 85.6399 31.9487 67.0259 1.8658 60.1235 65.7652 50.9659 0.4318 2.7943 4.1049 12.7507 51.138 45.1858 12.7201 84.5965 12.5386 58.1393 21.0102 38.294 38.7361 75.4 1.3938 90.0038 28.7819 22.8757 25.7831 68.3976 59.7506 3.7891 11.0125 7.464 83.6176 82.5352 92.8956 13.8889 10.13 64.9392 48.1206 43.825 2.644 60.8888 62.5497 39.2731 43.5134 40.289 20.5933 32.4683 50.9528 87.3147 2.6616 97.1474 51.1845 74.5071 71.4791 40.4315 89.4699 75.3515 19.3459 17.3479 83.5554 7.3323 77.7169 58.6236 90.7088 89.872 36.8023 86.4004 90.1227 31.2606 35.5995 77.222 25.7566 65.5205 48.0376 12.88 34.6266 33.1866 40.0758 29.414 87.2457 49.4348 17.0818 70.3434 24.6828 42.379 63.3985 68.3805 91.5626 42.7558 16.0035 62.024 0.4818 90.9237 13.7811 60.2425 64.623 27.4306 49.2572 14.3529 99.8197 76.7693 77.4622 44.0874 50.1322 91.8583 81.8794 7.1439 90.7107 39.4839 71.6162 34.8593 98.2662 14.812 33.4902 61.2212 66.8923 61.6879 83.0499 19.4222 36.6386 47.0203 47.2538 44.4231 4.08 59.8775 91.0341 97.0808 28.6147 43.782 74.0566 87.6985 23.4365 92.5392 58.546 81.0872 71.142 61.722 29.4476 59.6568 36.48 80.7836 58.8703 22.1475 85.02 67.0087 55.2615 58.8913 71.7323 49.3562 69.2512 15.1403 27.5373 94.8837 86.7731 83.4225 40.8583 48.4288 36.591 67.6251 25.9675 47.5962 53.456 9.6253 95.2621 43.2539 83.1018 79.6653 36.9924 33.8488 49.5288 37.5001 14.4439 98.0353 81.856 58.1187 37.2355 52.4233 9.2761 81.1254 70.0614 53.382 19.581 57.0843 64.0542 45.9273 43.2615 67.3326 21.2379 47.4675 29.8618 48.0464 23.44 30.4211 16.958 94.2888 48.0436 10.1337 95.8022 91.0585 11.5654 65.0047 24.0205 29.3613 38.4207 86.179 80.9656 90.2832 5.7705 78.8659 35.3529 25.899 34.5706 51.0557 25.727 78.9031 63.7528 1.5476 71.9991 5.0067 6.0682 24.2668 80.5792 39.9701 77.9746 65.563 71.8821 38.637 96.8908 11.8335 65.6394 40.3046 17.857 14.4207 40.9833 65.161 23.6873 91.6345 86.7819 2.7979 72.5542 88.5867 69.4156 44.9191 81.2524 53.7259 1.8214 97.9556 28.3319 10.0167 90.5309 31.4325 21.1028 11.1201 40.5907 94.7866 30.0422 84.8673 56.453 72.9518 83.5878 89.7627 14.2355 76.8221 6.1903 41.7705 72.3772 56.8615 26.2071 69.7424 20.2968 19.0682 8.0004 79.3784 68.3313 34.9386 30.7053 25.2064 61.6909 30.7349 85.6345 34.8597 52.9059 92.7089 91.8835 72.3197 56.7418 95.6016 63.2799 31.1114 18.5801 2.3734 13.2466 98.0753 11.4525 57.3746 24.9039 8.1568 92.5782 20.2534 51.2335 26.3187 8.0306 6.2105 98.0092 63.4361 77.4807 71.2013 26.4015 65.2361 69.0576 55.7074 30.3289 26.6369 0.2215 7.3306 80.0843 69.4184 30.2208 72.065 38.585 58.063 14.9979 46.1972 69.6548 44.4519 98.6022 17.8135 83.4158 52.8574 48.8825 63.7396 15.1984 7.9449 92.6629 9.0478 43.3698 80.579 91.1421 69.712 85.52 97.8764 59.3963 17.8132 72.4666 24.0768
    ${output}=    Read Until Prompt
    Log    ${output}
    ${CmdComplete}=    Get Line    ${output}    -2
    Should Match Regexp    ${CmdComplete}    (=== \\[waitForCompletion_${component}\\] command )[0-9]+( timed out :)

Start Controller
    [Tags]    functional
    Switch Connection    Controller
    Comment    Move to working directory.
    Write    cd ${SALWorkDir}/${subSystem}/cpp/src
    Comment    Start Controller.
    ${input}=    Write    ./sacpp_${subSystem}_${component}_controller
    ${output}=    Read Until    controller ready
    Log    ${output}
    Should Contain    ${output}    ${subSystem}_${component} controller ready

Start Commander
    [Tags]    functional
    Switch Connection    Commander
    Comment    Move to working directory.
    Write    cd ${SALWorkDir}/${subSystem}/cpp/src
    Comment    Start Commander.
    ${input}=    Write    ./sacpp_${subSystem}_${component}_commander 56.249 29.6218 93.1438 86.7971 1.2244 51.7233 69.9535 38.4871 86.7926 49.8485 78.1071 83.573 58.5773 97.3384 4.6084 43.6187 76.5865 76.0091 51.2385 9.6321 56.8828 6.4421 58.2965 7.9013 8.8974 97.6233 38.1688 99.2168 25.2007 29.0525 74.4122 87.5226 4.111 61.3904 45.8536 78.1508 96.8015 92.7196 99.7317 98.5607 25.63 58.6881 62.1663 36.3459 25.0533 86.8043 16.3794 38.9951 17.3462 69.5221 89.5106 43.7575 19.2071 27.3022 5.9331 47.3052 49.5385 89.317 78.6821 87.1841 68.8664 47.0126 89.6112 67.9068 42.8773 87.1907 12.2822 29.3323 99.7051 39.0388 48.7815 3.1251 94.7107 21.0964 70.5222 11.7445 23.5778 94.8837 4.5437 69.2813 32.7281 58.1164 71.2194 30.9743 25.1123 49.5942 94.8862 2.981 82.7802 82.0955 67.1329 65.7323 97.81 89.5659 43.2252 51.149 45.2986 81.0913 76.4199 40.7293 11.2983 96.8427 0.9185 63.8417 1.7795 78.8744 27.818 86.112 69.0527 6.6982 46.6505 44.0623 39.1659 70.3371 31.6455 7.281 47.5077 90.7169 72.4725 55.722 67.8291 51.4228 7.4319 84.5423 38.6648 76.8662 18.3342 58.2931 92.8619 62.8696 65.134 62.5603 81.0325 38.7128 28.4816 24.0426 33.1242 41.7082 40.9122 66.9317 23.1272 8.3273 18.8256 31.0083 47.7614 91.9244 4.7717 69.3525 65.0538 19.3644 62.4663 96.3483 33.7496 84.615 86.3763 21.3859 17.5563 42.0068 13.2905 63.0983 94.3781 79.1335 14.8429 3.5265 41.9741 39.8073 65.627 92.4054 66.944 69.0316 38.7707 95.831 96.952 31.344 56.848 37.706 66.5217 83.9072 79.8777 0.524 30.2408 85.229 6.8196 7.305 65.1373 92.1153 73.0945 44.0089 15.8263 62.5274 30.5447 45.2689 45.7557 11.1474 18.8585 85.6399 31.9487 67.0259 1.8658 60.1235 65.7652 50.9659 0.4318 2.7943 4.1049 12.7507 51.138 45.1858 12.7201 84.5965 12.5386 58.1393 21.0102 38.294 38.7361 75.4 1.3938 90.0038 28.7819 22.8757 25.7831 68.3976 59.7506 3.7891 11.0125 7.464 83.6176 82.5352 92.8956 13.8889 10.13 64.9392 48.1206 43.825 2.644 60.8888 62.5497 39.2731 43.5134 40.289 20.5933 32.4683 50.9528 87.3147 2.6616 97.1474 51.1845 74.5071 71.4791 40.4315 89.4699 75.3515 19.3459 17.3479 83.5554 7.3323 77.7169 58.6236 90.7088 89.872 36.8023 86.4004 90.1227 31.2606 35.5995 77.222 25.7566 65.5205 48.0376 12.88 34.6266 33.1866 40.0758 29.414 87.2457 49.4348 17.0818 70.3434 24.6828 42.379 63.3985 68.3805 91.5626 42.7558 16.0035 62.024 0.4818 90.9237 13.7811 60.2425 64.623 27.4306 49.2572 14.3529 99.8197 76.7693 77.4622 44.0874 50.1322 91.8583 81.8794 7.1439 90.7107 39.4839 71.6162 34.8593 98.2662 14.812 33.4902 61.2212 66.8923 61.6879 83.0499 19.4222 36.6386 47.0203 47.2538 44.4231 4.08 59.8775 91.0341 97.0808 28.6147 43.782 74.0566 87.6985 23.4365 92.5392 58.546 81.0872 71.142 61.722 29.4476 59.6568 36.48 80.7836 58.8703 22.1475 85.02 67.0087 55.2615 58.8913 71.7323 49.3562 69.2512 15.1403 27.5373 94.8837 86.7731 83.4225 40.8583 48.4288 36.591 67.6251 25.9675 47.5962 53.456 9.6253 95.2621 43.2539 83.1018 79.6653 36.9924 33.8488 49.5288 37.5001 14.4439 98.0353 81.856 58.1187 37.2355 52.4233 9.2761 81.1254 70.0614 53.382 19.581 57.0843 64.0542 45.9273 43.2615 67.3326 21.2379 47.4675 29.8618 48.0464 23.44 30.4211 16.958 94.2888 48.0436 10.1337 95.8022 91.0585 11.5654 65.0047 24.0205 29.3613 38.4207 86.179 80.9656 90.2832 5.7705 78.8659 35.3529 25.899 34.5706 51.0557 25.727 78.9031 63.7528 1.5476 71.9991 5.0067 6.0682 24.2668 80.5792 39.9701 77.9746 65.563 71.8821 38.637 96.8908 11.8335 65.6394 40.3046 17.857 14.4207 40.9833 65.161 23.6873 91.6345 86.7819 2.7979 72.5542 88.5867 69.4156 44.9191 81.2524 53.7259 1.8214 97.9556 28.3319 10.0167 90.5309 31.4325 21.1028 11.1201 40.5907 94.7866 30.0422 84.8673 56.453 72.9518 83.5878 89.7627 14.2355 76.8221 6.1903 41.7705 72.3772 56.8615 26.2071 69.7424 20.2968 19.0682 8.0004 79.3784 68.3313 34.9386 30.7053 25.2064 61.6909 30.7349 85.6345 34.8597 52.9059 92.7089 91.8835 72.3197 56.7418 95.6016 63.2799 31.1114 18.5801 2.3734 13.2466 98.0753 11.4525 57.3746 24.9039 8.1568 92.5782 20.2534 51.2335 26.3187 8.0306 6.2105 98.0092 63.4361 77.4807 71.2013 26.4015 65.2361 69.0576 55.7074 30.3289 26.6369 0.2215 7.3306 80.0843 69.4184 30.2208 72.065 38.585 58.063 14.9979 46.1972 69.6548 44.4519 98.6022 17.8135 83.4158 52.8574 48.8825 63.7396 15.1984 7.9449 92.6629 9.0478 43.3698 80.579 91.1421 69.712 85.52 97.8764 59.3963 17.8132 72.4666 24.0768
    ${output}=    Read Until Prompt
    Log    ${output}
    Should Contain X Times    ${output}    === [issueCommand_${component}] writing a command containing :    1
    Should Contain X Times    ${output}    device : target    1
    Should Contain X Times    ${output}    property : lut    1
    Should Contain X Times    ${output}    action :     1
    Should Contain X Times    ${output}    value :     1
    Should Contain X Times    ${output}    xlut : 56.249    1
    Should Contain X Times    ${output}    ylut : 67.1329    1
    Should Contain X Times    ${output}    zlut : 30.2408    1
    Should Contain X Times    ${output}    ulut : 34.6266    1
    Should Contain X Times    ${output}    vlut : 83.1018    1
    Should Contain X Times    ${output}    wlut : 30.0422    1
    Should Contain    ${output}    === command configureLut issued =
    ${CmdComplete}=    Get Line    ${output}    -2
    Should Match Regexp    ${CmdComplete}    (=== \\[waitForCompletion_${component}\\] command )[0-9]+( completed ok :)

Read Controller
    [Tags]    functional
    Switch Connection    Controller
    ${output}=    Read Until    result \ \ : Done : OK
    Log    ${output}
    Should Contain    ${output}    === command configureLut received =
    Should Contain    ${output}    device : target
    Should Contain    ${output}    property : lut
    Should Contain    ${output}    action : 
    Should Contain    ${output}    value : 
    Should Contain X Times    ${output}    xlut : 56.249    1
    Should Contain X Times    ${output}    ylut : 67.1329    1
    Should Contain X Times    ${output}    zlut : 30.2408    1
    Should Contain X Times    ${output}    ulut : 34.6266    1
    Should Contain X Times    ${output}    vlut : 83.1018    1
    Should Contain X Times    ${output}    wlut : 30.0422    1
    Should Contain X Times    ${output}    === [ackCommand_configureLut] acknowledging a command with :    2
    Should Contain    ${output}    seqNum   :
    Should Contain    ${output}    ack      : 301
    Should Contain X Times    ${output}    error \ \ \ : 0    2
    Should Contain    ${output}    result   : Ack : OK
    Should Contain    ${output}    ack      : 303
    Should Contain    ${output}    result   : Done : OK
