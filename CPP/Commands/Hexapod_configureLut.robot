*** Settings ***
Documentation    Hexapod_configureLut commander/controller tests.
Suite Setup    Log Many    ${Host}    ${subSystem}    ${component}    ${timeout}
Suite Teardown    Close All Connections
Library    SSHLibrary
Library    String
Resource    ../../Global_Vars.robot

*** Variables ***
${subSystem}    hexapod
${component}    configureLut
${timeout}    30s

*** Test Cases ***
Create Commander Session
    [Documentation]    Connect to the SAL host.
    [Tags]    smoke
    Comment    Connect to host.
    Open Connection    host=${Host}    alias=Commander    timeout=${timeout}    prompt=${Prompt}
    Comment    Login.
    Log    ${ContInt}
    Login With Public Key    ${UserName}    keyfile=${KeyFile}    password=${PassWord}
    Directory Should Exist    ${SALInstall}
    Directory Should Exist    ${SALHome}
    Directory Should Exist    ${SALWorkDir}/${subSystem}

Create Controller Session
    [Documentation]    Connect to the SAL host.
    [Tags]    smoke
    Comment    Connect to host.
    Open Connection    host=${Host}    alias=Controller    timeout=${timeout}    prompt=${Prompt}
    Comment    Login.
    Log    ${ContInt}
    Login With Public Key    ${UserName}    keyfile=${KeyFile}    password=${PassWord}
    Directory Should Exist    ${SALInstall}
    Directory Should Exist    ${SALHome}
    Directory Should Exist    ${SALWorkDir}/${subSystem}

Verify Component Commander and Controller
    [Tags]    smoke
    File Should Exist    ${SALWorkDir}/${subSystem}/cpp/src/sacpp_${subSystem}_${component}_commander
    File Should Exist    ${SALWorkDir}/${subSystem}/cpp/src/sacpp_${subSystem}_${component}_controller

Start Commander - Verify Missing Inputs Error
    [Tags]    functional
    Switch Connection    Commander
    Comment    Move to working directory.
    Write    cd ${SALWorkDir}/${subSystem}/cpp/src
    Comment    Start Commander.
    ${input}=    Write    ./sacpp_${subSystem}_${component}_commander 
    ${output}=    Read Until Prompt
    Log    ${output}
    Should Contain    ${output}   Usage : \ input parameters...

Start Commander - Verify Timeout without Controller
    [Tags]    functional
    Switch Connection    Commander
    Comment    Move to working directory.
    Write    cd ${SALWorkDir}/${subSystem}/cpp/src
    Comment    Start Commander.
    ${input}=    Write    ./sacpp_${subSystem}_${component}_commander 26.5593 84.9331 54.7995 47.3795 60.1641 45.6816 72.6005 41.4066 7.2135 9.7343 96.9506 43.4664 38.902 19.3696 96.7681 61.827 5.9153 37.0261 92.5948 24.5842 69.3867 14.4423 32.6661 90.7593 70.1162 93.8598 79.6742 60.728 83.8148 98.3415 11.0244 49.6717 40.2831 22.7047 6.6347 92.7642 65.8812 73.7185 80.8058 90.1495 79.4657 92.9564 87.0798 63.2213 41.5196 2.9881 99.2743 41.0298 38.4553 40.2081 18.7394 10.024 57.4666 16.9496 15.3671 62.1797 53.7539 99.3793 56.0995 97.4597 51.3845 81.2588 94.0257 93.2296 40.0876 54.0371 25.2348 92.2149 23.0727 18.9318 51.5681 6.3518 24.8717 63.6808 67.8627 83.2096 1.0715 9.3758 93.7396 57.9128 40.5032 52.2539 40.0363 30.1896 84.3694 54.0726 33.5398 51.8926 64.918 11.5598 83.2048 70.6413 97.1059 91.7605 11.3334 9.3483 74.5012 77.937 28.796 98.62 59.4944 18.9215 82.5792 84.5003 86.1961 56.83 6.7634 85.552 76.3509 58.6035 30.1688 53.8967 6.3377 54.0642 95.8778 4.9602 93.2662 19.2867 21.5134 15.904 25.1719 54.7688 84.891 3.6941 54.3978 55.6905 48.1458 47.043 85.5795 72.1066 16.4306 31.2525 80.6548 65.4914 28.4047 24.8603 28.6238 50.8801 63.7941 74.5742 62.6667 56.5804 20.2761 68.0785 36.9833 13.1627 49.6606 34.9891 72.3961 1.0825 11.7157 11.6406 51.8251 23.0318 43.138 26.8986 96.9228 53.3973 96.4353 54.9257 58.9619 37.1457 2.6726 75.3679 61.9999 80.8791 35.4847 31.1487 61.2405 82.8643 9.6786 75.1567 42.7588 37.7556 75.3107 40.9121 2.0398 44.9449 38.4379 96.1781 15.0567 38.1694 33.9987 66.3826 24.7178 54.9556 10.7453 42.9574 2.7142 70.2547 22.9265 14.4214 59.3923 45.5 72.0459 88.2209 7.7492 31.9218 69.5597 92.717 29.7468 20.1873 18.7798 75.4058 27.0056 97.2485 72.4461 68.1402 59.4656 85.161 96.4293 2.2935 67.9534 29.841 97.8924 66.9703 40.746 37.2563 79.7075 15.8932 97.3112 96.6812 85.1388 31.2718 73.9638 15.1581 16.613 62.6717 82.615 47.8567 6.9574 77.6446 57.6269 69.0211 88.6044 95.3276 74.4301 28.7458 15.1043 8.7702 49.4045 97.9512 68.7188 6.8559 32.4664 85.9385 39.4779 55.3363 10.1393 19.3084 29.6083 91.4726 99.874 41.965 61.2569 96.531 1.6622 61.9196 22.6976 53.6295 93.1143 0.193 67.4256 81.8361 9.43 82.3573 1.4946 99.2218 89.1112 2.8066 37.8235 46.3406 75.2336 38.5332 13.751 34.5871 12.6669 24.1298 57.6836 64.0604 28.1496 46.1091 66.4754 63.0522 46.746 80.6587 29.1273 32.6861 33.7567 93.9274 18.9697 69.3303 11.9366 64.7811 42.4516 5.8758 13.6255 28.1035 67.2498 46.7259 37.054 79.3958 50.6736 80.4454 0.0343 31.2278 69.4935 68.7392 47.2222 91.6135 68.8533 20.6834 94.0572 20.0068 39.9719 40.5909 82.4263 19.6222 64.3845 73.1089 71.4225 22.2848 51.5551 2.9578 17.3793 35.4731 40.6537 53.6818 56.4412 4.4603 59.8957 43.8453 79.0645 36.9869 37.5093 53.3563 49.0534 37.4026 13.3891 9.2086 96.1707 57.38 66.3137 48.4834 19.221 65.3251 96.5827 11.3281 37.9007 70.4066 57.9745 10.7649 64.3563 58.4708 91.6716 86.4509 78.1716 12.3507 59.0301 96.8584 34.041 28.7974 99.5346 77.2912 29.5913 94.7746 23.6892 32.5077 87.2066 13.1111 94.5331 45.2386 0.3858 49.2035 41.0354 35.25 30.5213 72.3962 51.5991 74.2511 2.6969 20.2664 73.2764 41.1462 27.9137 12.4373 8.3124 76.4178 14.362 23.5372 81.8834 87.2209 37.923 44.5326 47.0743 24.8547 40.4094 20.6412 12.08 13.6211 82.8599 47.2323 18.2268 67.6934 92.4482 6.2184 72.1781 10.4472 56.3438 89.724 48.9208 16.1188 61.0598 9.679 78.5936 61.0727 47.7919 75.1406 69.4879 42.3155 64.3649 59.3203 36.453 45.6331 73.0034 5.4956 44.6343 72.7358 53.2096 36.3568 34.1204 58.988 79.3509 27.1234 41.2544 32.8195 50.0295 45.6179 83.7859 42.011 82.9506 14.7491 6.5188 22.3264 8.2697 97.1201 44.799 65.4427 74.3648 76.559 6.7126 76.8988 25.8639 71.2727 38.6473 69.4081 29.6909 54.9622 84.5279 79.3877 31.118 11.9614 96.4554 23.8176 87.1434 35.2379 82.7481 31.3999 73.1253 70.1551 79.6727 12.6238 70.2377 62.8399 63.8773 87.091 3.7149 29.1732 59.6799 57.0647 2.4412 43.7177 64.2322 84.3222 33.0166 40.3691 54.033 18.5801 72.5542 1.356 3.7671 69.4504 14.9926 28.9264 93.9294 53.3131 51.1246 59.2229 56.4983 93.3731 85.0552 74.429 10.3625 89.0561 78.4425 95.7372 24.7342 10.2528 19.3713 28.277 6.7625 24.0997 73.5212 72.0435 29.2319 98.7479 39.5849 48.2558 85.7816 87.7987 50.3389 80.9767 2.1247 32.8088 17.3556 52.8704 32.1539 32.1159 61.1741 62.82 11.6125 16.8301 27.2818 70.7789 98.3233 18.298 99.1678 27.978 10.7214 60.7978
    ${output}=    Read Until Prompt
    Log    ${output}
    ${CmdComplete}=    Get Line    ${output}    -2
    Should Match Regexp    ${CmdComplete}    (=== \\[waitForCompletion_${component}\\] command )[0-9]+( timed out :)

Start Controller
    [Tags]    functional
    Switch Connection    Controller
    Comment    Move to working directory.
    Write    cd ${SALWorkDir}/${subSystem}/cpp/src
    Comment    Start Controller.
    ${input}=    Write    ./sacpp_${subSystem}_${component}_controller
    ${output}=    Read Until    controller ready
    Log    ${output}
    Should Contain    ${output}    ${subSystem}_${component} controller ready

Start Commander
    [Tags]    functional
    Switch Connection    Commander
    Comment    Move to working directory.
    Write    cd ${SALWorkDir}/${subSystem}/cpp/src
    Comment    Start Commander.
    ${input}=    Write    ./sacpp_${subSystem}_${component}_commander 26.5593 84.9331 54.7995 47.3795 60.1641 45.6816 72.6005 41.4066 7.2135 9.7343 96.9506 43.4664 38.902 19.3696 96.7681 61.827 5.9153 37.0261 92.5948 24.5842 69.3867 14.4423 32.6661 90.7593 70.1162 93.8598 79.6742 60.728 83.8148 98.3415 11.0244 49.6717 40.2831 22.7047 6.6347 92.7642 65.8812 73.7185 80.8058 90.1495 79.4657 92.9564 87.0798 63.2213 41.5196 2.9881 99.2743 41.0298 38.4553 40.2081 18.7394 10.024 57.4666 16.9496 15.3671 62.1797 53.7539 99.3793 56.0995 97.4597 51.3845 81.2588 94.0257 93.2296 40.0876 54.0371 25.2348 92.2149 23.0727 18.9318 51.5681 6.3518 24.8717 63.6808 67.8627 83.2096 1.0715 9.3758 93.7396 57.9128 40.5032 52.2539 40.0363 30.1896 84.3694 54.0726 33.5398 51.8926 64.918 11.5598 83.2048 70.6413 97.1059 91.7605 11.3334 9.3483 74.5012 77.937 28.796 98.62 59.4944 18.9215 82.5792 84.5003 86.1961 56.83 6.7634 85.552 76.3509 58.6035 30.1688 53.8967 6.3377 54.0642 95.8778 4.9602 93.2662 19.2867 21.5134 15.904 25.1719 54.7688 84.891 3.6941 54.3978 55.6905 48.1458 47.043 85.5795 72.1066 16.4306 31.2525 80.6548 65.4914 28.4047 24.8603 28.6238 50.8801 63.7941 74.5742 62.6667 56.5804 20.2761 68.0785 36.9833 13.1627 49.6606 34.9891 72.3961 1.0825 11.7157 11.6406 51.8251 23.0318 43.138 26.8986 96.9228 53.3973 96.4353 54.9257 58.9619 37.1457 2.6726 75.3679 61.9999 80.8791 35.4847 31.1487 61.2405 82.8643 9.6786 75.1567 42.7588 37.7556 75.3107 40.9121 2.0398 44.9449 38.4379 96.1781 15.0567 38.1694 33.9987 66.3826 24.7178 54.9556 10.7453 42.9574 2.7142 70.2547 22.9265 14.4214 59.3923 45.5 72.0459 88.2209 7.7492 31.9218 69.5597 92.717 29.7468 20.1873 18.7798 75.4058 27.0056 97.2485 72.4461 68.1402 59.4656 85.161 96.4293 2.2935 67.9534 29.841 97.8924 66.9703 40.746 37.2563 79.7075 15.8932 97.3112 96.6812 85.1388 31.2718 73.9638 15.1581 16.613 62.6717 82.615 47.8567 6.9574 77.6446 57.6269 69.0211 88.6044 95.3276 74.4301 28.7458 15.1043 8.7702 49.4045 97.9512 68.7188 6.8559 32.4664 85.9385 39.4779 55.3363 10.1393 19.3084 29.6083 91.4726 99.874 41.965 61.2569 96.531 1.6622 61.9196 22.6976 53.6295 93.1143 0.193 67.4256 81.8361 9.43 82.3573 1.4946 99.2218 89.1112 2.8066 37.8235 46.3406 75.2336 38.5332 13.751 34.5871 12.6669 24.1298 57.6836 64.0604 28.1496 46.1091 66.4754 63.0522 46.746 80.6587 29.1273 32.6861 33.7567 93.9274 18.9697 69.3303 11.9366 64.7811 42.4516 5.8758 13.6255 28.1035 67.2498 46.7259 37.054 79.3958 50.6736 80.4454 0.0343 31.2278 69.4935 68.7392 47.2222 91.6135 68.8533 20.6834 94.0572 20.0068 39.9719 40.5909 82.4263 19.6222 64.3845 73.1089 71.4225 22.2848 51.5551 2.9578 17.3793 35.4731 40.6537 53.6818 56.4412 4.4603 59.8957 43.8453 79.0645 36.9869 37.5093 53.3563 49.0534 37.4026 13.3891 9.2086 96.1707 57.38 66.3137 48.4834 19.221 65.3251 96.5827 11.3281 37.9007 70.4066 57.9745 10.7649 64.3563 58.4708 91.6716 86.4509 78.1716 12.3507 59.0301 96.8584 34.041 28.7974 99.5346 77.2912 29.5913 94.7746 23.6892 32.5077 87.2066 13.1111 94.5331 45.2386 0.3858 49.2035 41.0354 35.25 30.5213 72.3962 51.5991 74.2511 2.6969 20.2664 73.2764 41.1462 27.9137 12.4373 8.3124 76.4178 14.362 23.5372 81.8834 87.2209 37.923 44.5326 47.0743 24.8547 40.4094 20.6412 12.08 13.6211 82.8599 47.2323 18.2268 67.6934 92.4482 6.2184 72.1781 10.4472 56.3438 89.724 48.9208 16.1188 61.0598 9.679 78.5936 61.0727 47.7919 75.1406 69.4879 42.3155 64.3649 59.3203 36.453 45.6331 73.0034 5.4956 44.6343 72.7358 53.2096 36.3568 34.1204 58.988 79.3509 27.1234 41.2544 32.8195 50.0295 45.6179 83.7859 42.011 82.9506 14.7491 6.5188 22.3264 8.2697 97.1201 44.799 65.4427 74.3648 76.559 6.7126 76.8988 25.8639 71.2727 38.6473 69.4081 29.6909 54.9622 84.5279 79.3877 31.118 11.9614 96.4554 23.8176 87.1434 35.2379 82.7481 31.3999 73.1253 70.1551 79.6727 12.6238 70.2377 62.8399 63.8773 87.091 3.7149 29.1732 59.6799 57.0647 2.4412 43.7177 64.2322 84.3222 33.0166 40.3691 54.033 18.5801 72.5542 1.356 3.7671 69.4504 14.9926 28.9264 93.9294 53.3131 51.1246 59.2229 56.4983 93.3731 85.0552 74.429 10.3625 89.0561 78.4425 95.7372 24.7342 10.2528 19.3713 28.277 6.7625 24.0997 73.5212 72.0435 29.2319 98.7479 39.5849 48.2558 85.7816 87.7987 50.3389 80.9767 2.1247 32.8088 17.3556 52.8704 32.1539 32.1159 61.1741 62.82 11.6125 16.8301 27.2818 70.7789 98.3233 18.298 99.1678 27.978 10.7214 60.7978
    ${output}=    Read Until Prompt
    Log    ${output}
    Should Contain X Times    ${output}    === [issueCommand_${component}] writing a command containing :    1
    Should Contain X Times    ${output}    device : target    1
    Should Contain X Times    ${output}    property : lut    1
    Should Contain X Times    ${output}    action :     1
    Should Contain X Times    ${output}    value :     1
    Should Contain X Times    ${output}    xlut : 26.5593    1
    Should Contain X Times    ${output}    ylut : 83.2048    1
    Should Contain X Times    ${output}    zlut : 15.0567    1
    Should Contain X Times    ${output}    ulut : 37.8235    1
    Should Contain X Times    ${output}    vlut : 34.041    1
    Should Contain X Times    ${output}    wlut : 6.7126    1
    Should Contain    ${output}    === command configureLut issued =
    ${CmdComplete}=    Get Line    ${output}    -2
    Should Match Regexp    ${CmdComplete}    (=== \\[waitForCompletion_${component}\\] command )[0-9]+( completed ok :)

Read Controller
    [Tags]    functional
    Switch Connection    Controller
    ${output}=    Read Until    result \ \ : Done : OK
    Log    ${output}
    Should Contain    ${output}    === command configureLut received =
    Should Contain    ${output}    device : target
    Should Contain    ${output}    property : lut
    Should Contain    ${output}    action : 
    Should Contain    ${output}    value : 
    Should Contain X Times    ${output}    xlut : 26.5593    1
    Should Contain X Times    ${output}    ylut : 83.2048    1
    Should Contain X Times    ${output}    zlut : 15.0567    1
    Should Contain X Times    ${output}    ulut : 37.8235    1
    Should Contain X Times    ${output}    vlut : 34.041    1
    Should Contain X Times    ${output}    wlut : 6.7126    1
    Should Contain X Times    ${output}    === [ackCommand_configureLut] acknowledging a command with :    2
    Should Contain    ${output}    seqNum   :
    Should Contain    ${output}    ack      : 301
    Should Contain X Times    ${output}    error \ \ \ : 0    2
    Should Contain    ${output}    result   : Ack : OK
    Should Contain    ${output}    ack      : 303
    Should Contain    ${output}    result   : Done : OK
