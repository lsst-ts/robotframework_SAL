*** Settings ***
Documentation    Hexapod_configureLut commander/controller tests.
Suite Setup    Log Many    ${Host}    ${subSystem}    ${component}    ${timeout}
Suite Teardown    Close All Connections
Library    SSHLibrary
Resource    ../../Global_Vars.robot

*** Variables ***
${subSystem}    hexapod
${component}    configureLut
${timeout}    30s

*** Test Cases ***
Create Commander Session
    [Documentation]    Connect to the SAL host.
    [Tags]    smoke
    Comment    Connect to host.
    Open Connection    host=${Host}    alias=Commander    timeout=${timeout}    prompt=${Prompt}
    Comment    Login.
    Log    ${ContInt}
    Run Keyword If    "${ContInt}"=="false"    Login    ${UserName}    ${PassWord}
    Run Keyword If    "${ContInt}"=="true"    Login With Public Key    ${UserName}    keyfile=${PassWord}
    Directory Should Exist    ${SALInstall}
    Directory Should Exist    ${SALHome}
    Directory Should Exist    ${SALWorkDir}/${subSystem}

Create Controller Session
    [Documentation]    Connect to the SAL host.
    [Tags]    smoke
    Comment    Connect to host.
    Open Connection    host=${Host}    alias=Controller    timeout=${timeout}    prompt=${Prompt}
    Comment    Login.
    Log    ${ContInt}
    Run Keyword If    "${ContInt}"=="false"    Login    ${UserName}    ${PassWord}
    Run Keyword If    "${ContInt}"=="true"    Login With Public Key    ${UserName}    keyfile=${PassWord}
    Directory Should Exist    ${SALInstall}
    Directory Should Exist    ${SALHome}
    Directory Should Exist    ${SALWorkDir}/${subSystem}

Verify Component Commander and Controller
    [Tags]    smoke
    File Should Exist    ${SALWorkDir}/${subSystem}/cpp/src/sacpp_${subSystem}_${component}_commander
    File Should Exist    ${SALWorkDir}/${subSystem}/cpp/src/sacpp_${subSystem}_${component}_controller

Start Commander - Verify Missing Inputs Error
    [Tags]    functional
    Switch Connection    Commander
    Comment    Move to working directory.
    Write    cd ${SALWorkDir}/${subSystem}/cpp/src
    Comment    Start Commander.
    ${input}=    Write    ./sacpp_${subSystem}_${component}_commander 
    ${output}=    Read Until Prompt
    Log    ${output}
    Should Contain    ${output}   Usage :  input parameters...

Start Commander - Verify Timeout without Controller
    [Tags]    functional
    Switch Connection    Commander
    Comment    Move to working directory.
    Write    cd ${SALWorkDir}/${subSystem}/cpp/src
    Comment    Start Commander.
    ${input}=    Write    ./sacpp_${subSystem}_${component}_commander 17.1946 5.9237 61.0332 85.9808 58.0966 57.0803 66.4166 27.062 50.4111 86.3653 6.4297 29.438 9.7267 46.2435 11.8226 1.3067 70.1461 5.7181 26.5028 89.2485 10.3992 15.9192 90.8158 41.2276 59.093 75.6118 18.8448 21.3853 70.7634 54.1426 43.0701 59.8013 47.746 71.46 53.2902 37.8503 36.9457 22.2689 9.1901 22.2375 45.0511 52.1546 62.3512 22.8527 71.3846 64.8242 59.5986 35.4643 2.3294 47.9754 44.4207 37.7257 41.7953 87.6293 1.3543 73.5605 93.3392 86.9624 85.2756 57.3975 86.8619 15.6653 4.7862 53.584 27.018 35.5322 89.6786 50.6129 97.1842 10.9572 30.4439 48.1852 73.225 63.6532 75.7229 95.4826 34.0292 97.1816 60.6296 98.9053 24.8513 26.401 30.7618 12.3473 4.1965 24.7615 68.5511 51.5603 65.3817 23.2675 30.7292 27.2101 93.3426 13.6374 18.5847 43.7118 76.8975 87.3473 27.8294 15.971 67.7204 34.8068 78.272 80.5688 62.8293 91.5649 55.163 14.7804 34.5758 26.3339 57.3634 35.6938 80.7461 49.4787 75.0212 70.5978 76.8137 44.1466 80.938 48.7456 44.988 87.3243 74.7718 50.223 4.9783 43.4145 83.56 28.486 16.5826 28.6911 84.1627 62.1574 42.43 65.3128 49.2429 71.8919 98.6906 19.379 90.693 0.3139 65.1236 85.4408 33.0035 47.3524 19.4098 62.6672 87.0954 50.9336 91.6704 23.2767 84.0236 1.4828 38.445 11.4418 41.221 36.8064 60.1683 67.4086 17.3842 26.9514 8.4892 71.4338 51.2219 28.6866 18.3187 41.8069 96.0481 46.0322 95.8361 81.9689 75.6836 86.7942 94.34 51.1137 88.0827 32.0183 24.076 2.1671 75.9569 15.6115 70.178 33.0659 22.4371 11.2008 42.3135 30.1403 36.6639 75.3432 60.4216 32.1392 49.2638 25.9233 87.0295 39.8389 89.801 54.5231 24.5005 19.5046 36.3875 81.7278 21.8989 61.8369 35.3391 18.8246 35.6181 37.3859 37.6349 45.1563 76.4009 68.4355 71.1174 96.4792 79.0877 44.0087 16.8019 79.7608 87.9607 74.6121 43.4691 15.8279 49.1635 94.7611 86.7998 97.7716 18.4436 10.1467 58.7044 56.9352 4.5492 10.1163 27.9221 16.2017 10.3132 91.7541 59.3175 13.9511 13.4375 84.9066 98.4818 34.2686 88.9258 29.4317 77.1129 33.9281 99.0135 34.2536 46.1062 49.9841 43.7525 30.7863 34.2028 26.591 82.1229 31.3124 83.1849 53.542 84.278 98.3717 3.5185 1.726 98.4665 33.2205 2.0543 81.9452 86.7767 39.8506 50.2711 36.9347 33.4738 12.9957 80.427 98.8893 38.8639 18.2082 3.0807 6.4395 70.2383 85.4757 1.2085 23.6585 12.6345 28.1908 10.3812 1.5058 48.7611 30.6696 5.7354 11.9289 3.3907 30.8046 86.853 39.7573 65.7978 97.7517 14.8996 36.379 88.906 83.59 21.1514 90.4851 15.662 79.6061 12.6025 54.0676 39.5885 16.9374 2.5133 70.8102 29.3036 31.7615 88.1864 13.1069 90.3932 1.7423 41.736 12.5348 57.3337 39.9768 45.944 44.0843 75.0462 50.1292 36.7041 79.0227 58.9322 7.7995 91.0423 41.5263 65.1423 84.9416 4.5096 90.9799 34.0656 23.094 66.178 35.3239 96.2645 54.2201 0.1745 1.6356 98.9717 48.4416 67.0779 2.705 92.1472 18.2294 2.7986 11.8527 32.3926 54.0891 3.4367 55.9129 70.3489 48.417 13.5529 79.7379 97.1953 13.8275 21.7115 62.8982 68.9106 30.2331 13.2762 20.7749 26.1563 72.7091 5.9022 1.6551 9.5859 34.2648 96.2858 80.9407 50.8776 3.0935 88.0279 92.365 97.6995 23.9618 8.0399 39.8173 4.974 42.5042 96.0135 68.6973 50.0183 18.5881 95.002 37.4108 86.0699 15.5926 50.0539 22.3342 95.2529 54.7004 26.6649 36.5487 25.5865 32.6408 66.4605 80.6135 88.7444 57.1983 41.9762 79.3969 31.7499 35.7337 23.9765 71.0933 56.962 25.4429 31.2657 95.4045 89.1605 26.6618 15.3459 88.2286 47.1894 53.2224 23.1036 73.4661 53.1703 68.6457 75.7779 23.8353 86.571 44.0361 12.9883 23.1464 40.4475 55.2227 38.1135 96.8966 98.8627 92.9296 73.3047 95.9597 69.6794 0.6067 48.1526 62.2626 17.6711 9.7465 68.5351 11.3599 66.5767 45.2292 0.6885 11.0656 0.1885 0.0784 89.7395 68.3648 72.9584 84.4237 20.6037 1.8327 58.0187 9.9365 52.2011 21.8672 80.6569 37.7042 63.148 23.2155 23.6128 95.5284 77.9215 64.8161 71.0016 22.2192 61.0154 91.6155 44.1839 63.9645 76.3161 50.0879 58.3589 85.2106 41.2076 80.838 51.2616 65.149 85.7694 77.7193 78.814 17.8457 57.9095 69.7597 73.7549 56.2449 16.065 92.0887 36.7426 45.1671 95.7346 44.9585 82.156 84.0888 14.6384 79.0282 19.4578 87.733 44.3186 48.1433 40.5904 25.6748 8.8612 94.7954 65.1984 96.8519 40.3029 30.4738 24.5639 36.4605 7.448 22.1638 76.0382 57.5547 22.5777 87.123 66.5731 33.9116 45.1837 15.6064 97.4933 55.4072 25.1805 69.6164 93.8498 60.8819 29.9996 56.4816 74.3415 28.3807 25.0572 98.8804 20.3959 47.7186 51.7107 15.928
    ${output}=    Read Until Prompt
    Log    ${output}
    Should Contain    ${output}    === [waitForCompletion_${component}] command 0 timed out :

Start Controller
    [Tags]    functional
    Switch Connection    Controller
    Comment    Move to working directory.
    Write    cd ${SALWorkDir}/${subSystem}/cpp/src
    Comment    Start Controller.
    ${input}=    Write    ./sacpp_${subSystem}_${component}_controller
    ${output}=    Read
    Log    ${output}
    Should Be Empty    ${output}

Start Commander
    [Tags]    functional
    Switch Connection    Commander
    Comment    Move to working directory.
    Write    cd ${SALWorkDir}/${subSystem}/cpp/src
    Comment    Start Commander.
    ${input}=    Write    ./sacpp_${subSystem}_${component}_commander 17.1946 5.9237 61.0332 85.9808 58.0966 57.0803 66.4166 27.062 50.4111 86.3653 6.4297 29.438 9.7267 46.2435 11.8226 1.3067 70.1461 5.7181 26.5028 89.2485 10.3992 15.9192 90.8158 41.2276 59.093 75.6118 18.8448 21.3853 70.7634 54.1426 43.0701 59.8013 47.746 71.46 53.2902 37.8503 36.9457 22.2689 9.1901 22.2375 45.0511 52.1546 62.3512 22.8527 71.3846 64.8242 59.5986 35.4643 2.3294 47.9754 44.4207 37.7257 41.7953 87.6293 1.3543 73.5605 93.3392 86.9624 85.2756 57.3975 86.8619 15.6653 4.7862 53.584 27.018 35.5322 89.6786 50.6129 97.1842 10.9572 30.4439 48.1852 73.225 63.6532 75.7229 95.4826 34.0292 97.1816 60.6296 98.9053 24.8513 26.401 30.7618 12.3473 4.1965 24.7615 68.5511 51.5603 65.3817 23.2675 30.7292 27.2101 93.3426 13.6374 18.5847 43.7118 76.8975 87.3473 27.8294 15.971 67.7204 34.8068 78.272 80.5688 62.8293 91.5649 55.163 14.7804 34.5758 26.3339 57.3634 35.6938 80.7461 49.4787 75.0212 70.5978 76.8137 44.1466 80.938 48.7456 44.988 87.3243 74.7718 50.223 4.9783 43.4145 83.56 28.486 16.5826 28.6911 84.1627 62.1574 42.43 65.3128 49.2429 71.8919 98.6906 19.379 90.693 0.3139 65.1236 85.4408 33.0035 47.3524 19.4098 62.6672 87.0954 50.9336 91.6704 23.2767 84.0236 1.4828 38.445 11.4418 41.221 36.8064 60.1683 67.4086 17.3842 26.9514 8.4892 71.4338 51.2219 28.6866 18.3187 41.8069 96.0481 46.0322 95.8361 81.9689 75.6836 86.7942 94.34 51.1137 88.0827 32.0183 24.076 2.1671 75.9569 15.6115 70.178 33.0659 22.4371 11.2008 42.3135 30.1403 36.6639 75.3432 60.4216 32.1392 49.2638 25.9233 87.0295 39.8389 89.801 54.5231 24.5005 19.5046 36.3875 81.7278 21.8989 61.8369 35.3391 18.8246 35.6181 37.3859 37.6349 45.1563 76.4009 68.4355 71.1174 96.4792 79.0877 44.0087 16.8019 79.7608 87.9607 74.6121 43.4691 15.8279 49.1635 94.7611 86.7998 97.7716 18.4436 10.1467 58.7044 56.9352 4.5492 10.1163 27.9221 16.2017 10.3132 91.7541 59.3175 13.9511 13.4375 84.9066 98.4818 34.2686 88.9258 29.4317 77.1129 33.9281 99.0135 34.2536 46.1062 49.9841 43.7525 30.7863 34.2028 26.591 82.1229 31.3124 83.1849 53.542 84.278 98.3717 3.5185 1.726 98.4665 33.2205 2.0543 81.9452 86.7767 39.8506 50.2711 36.9347 33.4738 12.9957 80.427 98.8893 38.8639 18.2082 3.0807 6.4395 70.2383 85.4757 1.2085 23.6585 12.6345 28.1908 10.3812 1.5058 48.7611 30.6696 5.7354 11.9289 3.3907 30.8046 86.853 39.7573 65.7978 97.7517 14.8996 36.379 88.906 83.59 21.1514 90.4851 15.662 79.6061 12.6025 54.0676 39.5885 16.9374 2.5133 70.8102 29.3036 31.7615 88.1864 13.1069 90.3932 1.7423 41.736 12.5348 57.3337 39.9768 45.944 44.0843 75.0462 50.1292 36.7041 79.0227 58.9322 7.7995 91.0423 41.5263 65.1423 84.9416 4.5096 90.9799 34.0656 23.094 66.178 35.3239 96.2645 54.2201 0.1745 1.6356 98.9717 48.4416 67.0779 2.705 92.1472 18.2294 2.7986 11.8527 32.3926 54.0891 3.4367 55.9129 70.3489 48.417 13.5529 79.7379 97.1953 13.8275 21.7115 62.8982 68.9106 30.2331 13.2762 20.7749 26.1563 72.7091 5.9022 1.6551 9.5859 34.2648 96.2858 80.9407 50.8776 3.0935 88.0279 92.365 97.6995 23.9618 8.0399 39.8173 4.974 42.5042 96.0135 68.6973 50.0183 18.5881 95.002 37.4108 86.0699 15.5926 50.0539 22.3342 95.2529 54.7004 26.6649 36.5487 25.5865 32.6408 66.4605 80.6135 88.7444 57.1983 41.9762 79.3969 31.7499 35.7337 23.9765 71.0933 56.962 25.4429 31.2657 95.4045 89.1605 26.6618 15.3459 88.2286 47.1894 53.2224 23.1036 73.4661 53.1703 68.6457 75.7779 23.8353 86.571 44.0361 12.9883 23.1464 40.4475 55.2227 38.1135 96.8966 98.8627 92.9296 73.3047 95.9597 69.6794 0.6067 48.1526 62.2626 17.6711 9.7465 68.5351 11.3599 66.5767 45.2292 0.6885 11.0656 0.1885 0.0784 89.7395 68.3648 72.9584 84.4237 20.6037 1.8327 58.0187 9.9365 52.2011 21.8672 80.6569 37.7042 63.148 23.2155 23.6128 95.5284 77.9215 64.8161 71.0016 22.2192 61.0154 91.6155 44.1839 63.9645 76.3161 50.0879 58.3589 85.2106 41.2076 80.838 51.2616 65.149 85.7694 77.7193 78.814 17.8457 57.9095 69.7597 73.7549 56.2449 16.065 92.0887 36.7426 45.1671 95.7346 44.9585 82.156 84.0888 14.6384 79.0282 19.4578 87.733 44.3186 48.1433 40.5904 25.6748 8.8612 94.7954 65.1984 96.8519 40.3029 30.4738 24.5639 36.4605 7.448 22.1638 76.0382 57.5547 22.5777 87.123 66.5731 33.9116 45.1837 15.6064 97.4933 55.4072 25.1805 69.6164 93.8498 60.8819 29.9996 56.4816 74.3415 28.3807 25.0572 98.8804 20.3959 47.7186 51.7107 15.928
    ${output}=    Read Until Prompt
    Log    ${output}
    Should Contain X Times    ${output}    === [issueCommand_${component}] writing a command containing :    1
    Should Contain X Times    ${output}    device : target    1
    Should Contain X Times    ${output}    property : lut    1
    Should Contain X Times    ${output}    action :     1
    Should Contain X Times    ${output}    value :     1
    Should Contain X Times    ${output}    xlut : 17.1946    1
    Should Contain X Times    ${output}    ylut : 5.9237    1
    Should Contain X Times    ${output}    zlut : 61.0332    1
    Should Contain X Times    ${output}    ulut : 85.9808    1
    Should Contain X Times    ${output}    vlut : 58.0966    1
    Should Contain X Times    ${output}    wlut : 57.0803    1
    Should Contain    ${output}    === command configureLut issued =
    Should Contain    ${output}    === [waitForCompletion_${component}] command 0 completed ok :

Read Controller
    [Tags]    functional
    Switch Connection    Controller
    ${output}=    Read Until    result \ \ : Done : OK
    Log    ${output}
    Should Contain    ${output}    === command configureLut received =
    Should Contain    ${output}    device : target
    Should Contain    ${output}    property : lut
    Should Contain    ${output}    action : 
    Should Contain    ${output}    value : 
    Should Contain X Times    ${output}    xlut : 17.1946    1
    Should Contain X Times    ${output}    ylut : 30.7292    1
    Should Contain X Times    ${output}    zlut : 70.178    1
    Should Contain X Times    ${output}    ulut : 80.427    1
    Should Contain X Times    ${output}    vlut : 68.9106    1
    Should Contain X Times    ${output}    wlut : 89.7395    1
    Should Contain X Times    ${output}    === [ackCommand_configureLut] acknowledging a command with :    2
    Should Contain    ${output}    seqNum   :
    Should Contain    ${output}    ack      : 301
    Should Contain X Times    ${output}    error \ \ \ : 0    2
    Should Contain    ${output}    result   : Ack : OK
    Should Contain    ${output}    ack      : 303
    Should Contain    ${output}    result   : Done : OK
