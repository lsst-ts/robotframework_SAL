*** Settings ***
Documentation    Hexapod_configureLut commander/controller tests.
Force Tags    cpp
Suite Setup    Run Keywords    Log Many    ${Host}    ${subSystem}    ${component}    ${timeout}
...    AND    Create Session    Commander    AND    Create Session    Controller
Suite Teardown    Close All Connections
Library    SSHLibrary
Library    String
Resource    ../../Global_Vars.robot
Resource    ../../common.robot

*** Variables ***
${subSystem}    hexapod
${component}    configureLut
${timeout}    30s

*** Test Cases ***
Verify Component Commander and Controller
    [Tags]    smoke
    File Should Exist    ${SALWorkDir}/${subSystem}/cpp/src/sacpp_${subSystem}_${component}_commander
    File Should Exist    ${SALWorkDir}/${subSystem}/cpp/src/sacpp_${subSystem}_${component}_controller

Start Commander - Verify Missing Inputs Error
    [Tags]    functional
    Switch Connection    Commander
    Comment    Move to working directory.
    Write    cd ${SALWorkDir}/${subSystem}/cpp/src
    Comment    Start Commander.
    ${input}=    Write    ./sacpp_${subSystem}_${component}_commander 
    ${output}=    Read Until Prompt
    Log    ${output}
    Should Contain    ${output}   Usage : \ input parameters...

Start Commander - Verify Timeout without Controller
    [Tags]    functional
    Switch Connection    Commander
    Comment    Move to working directory.
    Write    cd ${SALWorkDir}/${subSystem}/cpp/src
    Comment    Start Commander.
    ${input}=    Write    ./sacpp_${subSystem}_${component}_commander 86.8511 48.2178 62.8433 16.8721 88.0072 6.3868 63.5685 44.7388 50.8968 92.576 31.0462 69.78 82.6666 46.0712 76.1478 69.13 81.5546 67.2119 82.7106 36.1412 99.4279 87.514 60.3796 49.8463 81.4836 71.8926 91.4512 47.4797 90.6434 40.1385 61.3578 51.5337 76.78 35.245 39.944 79.3857 72.0877 65.3992 42.7715 93.6199 61.3842 3.2742 48.7166 70.8118 67.997 16.5917 7.3692 29.4623 11.4584 30.7917 50.7696 39.6824 75.0527 66.4152 0.8189 77.0754 19.1475 67.881 32.9942 37.4341 51.3113 96.1469 52.8359 12.0324 50.0028 55.3487 83.4716 37.0835 59.1673 65.2888 13.5917 10.4513 24.1371 2.358 12.7442 60.8639 27.8734 35.0276 37.5257 11.1438 29.8269 69.8806 87.1 67.4075 39.4688 98.5133 95.8969 76.0132 37.9566 82.192 71.5795 63.7566 46.7229 86.5017 45.4198 87.3445 79.9292 59.8854 39.4885 73.5204 6.2489 12.6743 90.3958 55.1268 82.1107 4.0191 34.8144 81.9042 90.0327 25.7976 56.1397 68.4352 21.9832 19.327 72.6203 83.881 63.79 94.5397 66.1795 19.7678 87.5057 77.1551 86.0535 26.5489 11.0915 50.8758 28.533 57.7381 19.8854 33.4163 50.892 46.3492 34.5315 73.2193 48.6564 96.7655 65.6557 39.4754 63.99 98.7718 39.1625 99.4383 94.2475 38.5702 34.6193 14.86 0.0524 67.4538 7.0839 79.0413 81.7802 2.1894 54.4747 96.3118 34.7168 91.291 54.1641 22.3807 81.1034 62.7534 34.1441 47.7743 62.7168 23.6209 92.1187 4.9669 45.1783 95.9217 35.1893 0.4858 38.5627 52.2708 23.5243 91.1638 78.5802 91.9019 39.6224 72.4265 6.2047 7.3952 90.0522 79.4074 84.2639 17.6379 7.1785 49.7257 21.9219 27.0351 53.3332 77.0955 73.5343 67.5284 30.5373 40.0215 43.778 91.9854 59.9001 32.6501 31.5324 55.3905 23.5884 70.6795 93.4444 23.1786 52.2752 31.811 85.88 25.5178 3.8784 84.2786 97.1309 39.879 57.7304 71.7071 61.8455 20.0868 46.2395 13.194 23.1168 44.4788 46.7106 93.2661 35.2548 55.1354 54.0254 15.689 93.007 50.3778 22.9979 60.3053 67.4439 25.8356 84.0011 35.6476 1.5401 52.9135 29.5691 24.4405 37.312 36.469 42.1991 83.2608 58.8865 84.1972 24.1659 29.7927 19.2984 58.7305 91.7894 86.4235 90.1207 68.1218 25.2547 94.3375 82.2794 75.0502 76.1703 41.8364 85.7523 54.3012 11.7358 66.8166 52.7817 56.9275 94.7589 69.1295 60.719 33.9226 64.3963 14.9765 25.9387 58.6045 5.7361 59.3354 38.2559 44.4983 32.0231 99.728 39.2994 10.6783 51.596 57.1132 61.1667 69.7191 4.5855 26.5686 48.2528 66.5224 46.9135 31.9314 52.211 52.049 29.6732 18.8418 5.2986 91.5048 82.6569 66.3312 39.5285 99.938 87.8463 61.7525 59.1673 12.8662 94.0831 6.9421 64.3593 29.4432 26.2871 73.2023 21.0653 97.8196 76.1752 51.1657 29.6321 61.3467 31.8339 87.2476 90.7322 5.6301 34.732 21.0446 9.5037 90.945 63.7776 72.6156 69.8243 85.1068 31.4123 74.7344 65.6497 59.055 9.5236 75.6253 8.7254 9.3834 56.9928 21.9095 28.448 97.8451 21.6602 40.3923 42.6545 60.8562 98.8487 78.6949 76.2744 1.1989 78.3253 66.2907 50.8919 49.3137 31.4205 28.7414 41.1812 47.2907 50.4258 73.2993 36.9796 91.7049 52.253 42.0048 40.2584 26.5233 67.5255 85.2169 69.4108 97.2106 52.5508 39.4344 28.1096 46.8886 72.8492 14.9821 1.0089 23.0139 31.5095 26.4527 49.0879 24.0526 19.1154 8.1748 55.9424 84.3793 72.4963 70.4734 50.5061 20.9909 81.9278 96.5616 59.5604 20.1652 63.1182 71.5124 29.6444 25.3739 24.7062 80.4925 79.944 0.8906 40.434 2.7567 86.69 39.197 53.7123 72.8743 90.1501 64.1086 97.1584 94.3862 4.5172 60.304 67.4075 7.9818 72.093 71.5162 93.1656 78.7295 12.6149 26.8172 60.3731 17.1746 50.2023 43.7349 69.7894 11.9045 26.3152 3.0212 13.7014 29.6045 93.9679 64.4209 48.257 10.4853 83.9136 9.4142 61.7822 13.6405 59.5618 23.3007 96.7014 81.8809 28.7177 78.9522 56.9428 21.5175 88.2146 29.7042 45.9205 41.8932 92.5418 92.9534 47.6638 97.9058 81.7694 92.3129 62.8109 74.1012 2.4176 45.1214 85.1665 9.7202 29.1056 7.1166 26.4572 7.8892 92.6245 48.6484 17.1288 60.6486 2.3703 20.9953 94.0132 66.3239 89.8409 31.8445 53.6627 30.5102 95.1775 11.5943 3.2623 16.0733 67.4429 81.6428 70.1337 0.5279 87.5554 12.5315 43.0596 32.9415 3.1175 13.1713 64.3652 80.2157 60.6529 85.2022 29.4427 79.3307 23.0086 43.541 23.6888 96.2873 24.2972 2.1159 61.7185 4.1942 2.0696 19.8746 88.206 38.0375 69.5117 19.1309 51.7449 41.583 42.5154 32.9761 78.3428 57.0294 52.535 96.3164 80.5215 3.9869 54.7833 76.5383 78.9941 98.281 32.6623 69.8839 33.94 60.2669 6.3088 68.7252 18.9034 29.1044 22.4578 60.7831 78.4317 62.8281 22.9071 74.7822
    ${output}=    Read Until Prompt
    Log    ${output}
    ${CmdComplete}=    Get Line    ${output}    -2
    Should Match Regexp    ${CmdComplete}    (=== \\[waitForCompletion_${component}\\] command )[0-9]+( timed out :)

Start Controller
    [Tags]    functional
    Switch Connection    Controller
    Comment    Move to working directory.
    Write    cd ${SALWorkDir}/${subSystem}/cpp/src
    Comment    Start Controller.
    ${input}=    Write    ./sacpp_${subSystem}_${component}_controller
    ${output}=    Read Until    controller ready
    Log    ${output}
    Should Contain    ${output}    ${subSystem}_${component} controller ready

Start Commander
    [Tags]    functional
    Switch Connection    Commander
    Comment    Move to working directory.
    Write    cd ${SALWorkDir}/${subSystem}/cpp/src
    Comment    Start Commander.
    ${input}=    Write    ./sacpp_${subSystem}_${component}_commander 86.8511 48.2178 62.8433 16.8721 88.0072 6.3868 63.5685 44.7388 50.8968 92.576 31.0462 69.78 82.6666 46.0712 76.1478 69.13 81.5546 67.2119 82.7106 36.1412 99.4279 87.514 60.3796 49.8463 81.4836 71.8926 91.4512 47.4797 90.6434 40.1385 61.3578 51.5337 76.78 35.245 39.944 79.3857 72.0877 65.3992 42.7715 93.6199 61.3842 3.2742 48.7166 70.8118 67.997 16.5917 7.3692 29.4623 11.4584 30.7917 50.7696 39.6824 75.0527 66.4152 0.8189 77.0754 19.1475 67.881 32.9942 37.4341 51.3113 96.1469 52.8359 12.0324 50.0028 55.3487 83.4716 37.0835 59.1673 65.2888 13.5917 10.4513 24.1371 2.358 12.7442 60.8639 27.8734 35.0276 37.5257 11.1438 29.8269 69.8806 87.1 67.4075 39.4688 98.5133 95.8969 76.0132 37.9566 82.192 71.5795 63.7566 46.7229 86.5017 45.4198 87.3445 79.9292 59.8854 39.4885 73.5204 6.2489 12.6743 90.3958 55.1268 82.1107 4.0191 34.8144 81.9042 90.0327 25.7976 56.1397 68.4352 21.9832 19.327 72.6203 83.881 63.79 94.5397 66.1795 19.7678 87.5057 77.1551 86.0535 26.5489 11.0915 50.8758 28.533 57.7381 19.8854 33.4163 50.892 46.3492 34.5315 73.2193 48.6564 96.7655 65.6557 39.4754 63.99 98.7718 39.1625 99.4383 94.2475 38.5702 34.6193 14.86 0.0524 67.4538 7.0839 79.0413 81.7802 2.1894 54.4747 96.3118 34.7168 91.291 54.1641 22.3807 81.1034 62.7534 34.1441 47.7743 62.7168 23.6209 92.1187 4.9669 45.1783 95.9217 35.1893 0.4858 38.5627 52.2708 23.5243 91.1638 78.5802 91.9019 39.6224 72.4265 6.2047 7.3952 90.0522 79.4074 84.2639 17.6379 7.1785 49.7257 21.9219 27.0351 53.3332 77.0955 73.5343 67.5284 30.5373 40.0215 43.778 91.9854 59.9001 32.6501 31.5324 55.3905 23.5884 70.6795 93.4444 23.1786 52.2752 31.811 85.88 25.5178 3.8784 84.2786 97.1309 39.879 57.7304 71.7071 61.8455 20.0868 46.2395 13.194 23.1168 44.4788 46.7106 93.2661 35.2548 55.1354 54.0254 15.689 93.007 50.3778 22.9979 60.3053 67.4439 25.8356 84.0011 35.6476 1.5401 52.9135 29.5691 24.4405 37.312 36.469 42.1991 83.2608 58.8865 84.1972 24.1659 29.7927 19.2984 58.7305 91.7894 86.4235 90.1207 68.1218 25.2547 94.3375 82.2794 75.0502 76.1703 41.8364 85.7523 54.3012 11.7358 66.8166 52.7817 56.9275 94.7589 69.1295 60.719 33.9226 64.3963 14.9765 25.9387 58.6045 5.7361 59.3354 38.2559 44.4983 32.0231 99.728 39.2994 10.6783 51.596 57.1132 61.1667 69.7191 4.5855 26.5686 48.2528 66.5224 46.9135 31.9314 52.211 52.049 29.6732 18.8418 5.2986 91.5048 82.6569 66.3312 39.5285 99.938 87.8463 61.7525 59.1673 12.8662 94.0831 6.9421 64.3593 29.4432 26.2871 73.2023 21.0653 97.8196 76.1752 51.1657 29.6321 61.3467 31.8339 87.2476 90.7322 5.6301 34.732 21.0446 9.5037 90.945 63.7776 72.6156 69.8243 85.1068 31.4123 74.7344 65.6497 59.055 9.5236 75.6253 8.7254 9.3834 56.9928 21.9095 28.448 97.8451 21.6602 40.3923 42.6545 60.8562 98.8487 78.6949 76.2744 1.1989 78.3253 66.2907 50.8919 49.3137 31.4205 28.7414 41.1812 47.2907 50.4258 73.2993 36.9796 91.7049 52.253 42.0048 40.2584 26.5233 67.5255 85.2169 69.4108 97.2106 52.5508 39.4344 28.1096 46.8886 72.8492 14.9821 1.0089 23.0139 31.5095 26.4527 49.0879 24.0526 19.1154 8.1748 55.9424 84.3793 72.4963 70.4734 50.5061 20.9909 81.9278 96.5616 59.5604 20.1652 63.1182 71.5124 29.6444 25.3739 24.7062 80.4925 79.944 0.8906 40.434 2.7567 86.69 39.197 53.7123 72.8743 90.1501 64.1086 97.1584 94.3862 4.5172 60.304 67.4075 7.9818 72.093 71.5162 93.1656 78.7295 12.6149 26.8172 60.3731 17.1746 50.2023 43.7349 69.7894 11.9045 26.3152 3.0212 13.7014 29.6045 93.9679 64.4209 48.257 10.4853 83.9136 9.4142 61.7822 13.6405 59.5618 23.3007 96.7014 81.8809 28.7177 78.9522 56.9428 21.5175 88.2146 29.7042 45.9205 41.8932 92.5418 92.9534 47.6638 97.9058 81.7694 92.3129 62.8109 74.1012 2.4176 45.1214 85.1665 9.7202 29.1056 7.1166 26.4572 7.8892 92.6245 48.6484 17.1288 60.6486 2.3703 20.9953 94.0132 66.3239 89.8409 31.8445 53.6627 30.5102 95.1775 11.5943 3.2623 16.0733 67.4429 81.6428 70.1337 0.5279 87.5554 12.5315 43.0596 32.9415 3.1175 13.1713 64.3652 80.2157 60.6529 85.2022 29.4427 79.3307 23.0086 43.541 23.6888 96.2873 24.2972 2.1159 61.7185 4.1942 2.0696 19.8746 88.206 38.0375 69.5117 19.1309 51.7449 41.583 42.5154 32.9761 78.3428 57.0294 52.535 96.3164 80.5215 3.9869 54.7833 76.5383 78.9941 98.281 32.6623 69.8839 33.94 60.2669 6.3088 68.7252 18.9034 29.1044 22.4578 60.7831 78.4317 62.8281 22.9071 74.7822
    ${output}=    Read Until Prompt
    Log    ${output}
    Should Contain X Times    ${output}    === [issueCommand_${component}] writing a command containing :    1
    Should Contain X Times    ${output}    device : target    1
    Should Contain X Times    ${output}    property : lut    1
    Should Contain X Times    ${output}    action :     1
    Should Contain X Times    ${output}    value :     1
    Should Contain X Times    ${output}    xlut : 86.8511    1
    Should Contain X Times    ${output}    ylut : 71.5795    1
    Should Contain X Times    ${output}    zlut : 90.0522    1
    Should Contain X Times    ${output}    ulut : 25.9387    1
    Should Contain X Times    ${output}    vlut : 52.253    1
    Should Contain X Times    ${output}    wlut : 92.5418    1
    Should Contain    ${output}    === command configureLut issued =
    ${CmdComplete}=    Get Line    ${output}    -2
    Should Match Regexp    ${CmdComplete}    (=== \\[waitForCompletion_${component}\\] command )[0-9]+( completed ok :)

Read Controller
    [Tags]    functional
    Switch Connection    Controller
    ${output}=    Read Until    result \ \ : Done : OK
    Log    ${output}
    Should Contain    ${output}    === command configureLut received =
    Should Contain    ${output}    device : target
    Should Contain    ${output}    property : lut
    Should Contain    ${output}    action : 
    Should Contain    ${output}    value : 
    Should Contain X Times    ${output}    xlut : 86.8511    1
    Should Contain X Times    ${output}    ylut : 71.5795    1
    Should Contain X Times    ${output}    zlut : 90.0522    1
    Should Contain X Times    ${output}    ulut : 25.9387    1
    Should Contain X Times    ${output}    vlut : 52.253    1
    Should Contain X Times    ${output}    wlut : 92.5418    1
    Should Contain X Times    ${output}    === [ackCommand_configureLut] acknowledging a command with :    2
    Should Contain    ${output}    seqNum   :
    Should Contain    ${output}    ack      : 301
    Should Contain X Times    ${output}    error \ \ \ : 0    2
    Should Contain    ${output}    result   : Ack : OK
    Should Contain    ${output}    ack      : 303
    Should Contain    ${output}    result   : Done : OK
