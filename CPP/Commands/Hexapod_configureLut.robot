*** Settings ***
Documentation    Hexapod_configureLut commander/controller tests.
Force Tags    cpp
Suite Setup    Log Many    ${Host}    ${subSystem}    ${component}    ${timeout}
Suite Teardown    Close All Connections
Library    SSHLibrary
Library    String
Resource    ../../Global_Vars.robot

*** Variables ***
${subSystem}    hexapod
${component}    configureLut
${timeout}    30s

*** Test Cases ***
Create Commander Session
    [Documentation]    Connect to the SAL host.
    [Tags]    smoke
    Comment    Connect to host.
    Open Connection    host=${Host}    alias=Commander    timeout=${timeout}    prompt=${Prompt}
    Comment    Login.
    Log    ${ContInt}
    Login With Public Key    ${UserName}    keyfile=${KeyFile}    password=${PassWord}
    Directory Should Exist    ${SALInstall}
    Directory Should Exist    ${SALHome}

Create Controller Session
    [Documentation]    Connect to the SAL host.
    [Tags]    smoke
    Comment    Connect to host.
    Open Connection    host=${Host}    alias=Controller    timeout=${timeout}    prompt=${Prompt}
    Comment    Login.
    Log    ${ContInt}
    Login With Public Key    ${UserName}    keyfile=${KeyFile}    password=${PassWord}
    Directory Should Exist    ${SALInstall}
    Directory Should Exist    ${SALHome}

Verify Component Commander and Controller
    [Tags]    smoke
    File Should Exist    ${SALWorkDir}/${subSystem}/cpp/src/sacpp_${subSystem}_${component}_commander
    File Should Exist    ${SALWorkDir}/${subSystem}/cpp/src/sacpp_${subSystem}_${component}_controller

Start Commander - Verify Missing Inputs Error
    [Tags]    functional
    Switch Connection    Commander
    Comment    Move to working directory.
    Write    cd ${SALWorkDir}/${subSystem}/cpp/src
    Comment    Start Commander.
    ${input}=    Write    ./sacpp_${subSystem}_${component}_commander 
    ${output}=    Read Until Prompt
    Log    ${output}
    Should Contain    ${output}   Usage : \ input parameters...

Start Commander - Verify Timeout without Controller
    [Tags]    functional
    Switch Connection    Commander
    Comment    Move to working directory.
    Write    cd ${SALWorkDir}/${subSystem}/cpp/src
    Comment    Start Commander.
    ${input}=    Write    ./sacpp_${subSystem}_${component}_commander 88.469 99.3695 69.0555 59.2471 19.8689 75.9781 58.4772 14.6891 25.1859 10.1051 58.1576 6.0007 1.3867 81.0135 37.4733 70.0177 29.1373 7.9419 64.0023 60.974 70.0393 33.7561 25.6727 52.9428 29.1507 97.785 33.5442 65.5404 8.2612 91.2944 25.8237 41.1058 12.8999 40.8731 7.6775 3.3205 45.126 71.0796 50.3937 3.7012 32.1261 14.4695 81.25 94.243 97.8809 61.6107 39.1928 23.5408 12.7626 64.7043 79.3149 6.5557 68.0033 5.8028 59.0596 63.8679 26.7936 2.9882 75.9509 52.7414 76.6696 43.8861 12.0832 71.2742 38.659 29.2931 51.2123 73.9931 84.7137 76.265 32.9327 19.7346 7.9544 49.8734 50.8309 99.3844 26.4316 67.7891 9.367 80.1931 35.6189 5.8618 20.6602 19.0505 97.728 45.7471 69.1207 43.6612 1.8763 15.5828 62.2946 45.3821 23.2544 57.4319 50.2258 59.0739 73.1612 96.9832 48.5945 71.9648 27.304 50.7569 1.4826 47.5696 64.6144 86.8979 28.1737 79.7547 17.4282 98.1844 84.1851 54.3719 60.6434 7.2928 60.4638 73.582 31.7623 47.6089 95.328 59.6117 57.8463 99.5006 96.1505 75.4877 91.344 42.4154 83.0251 33.6884 3.6234 71.122 38.297 16.8362 77.034 27.114 49.6246 3.1269 10.7472 25.8011 74.5222 39.892 80.2036 28.8866 55.3838 67.6695 58.2589 33.1215 47.5642 84.7938 28.6472 83.4179 82.5092 56.7264 94.881 10.4285 43.9917 99.5151 37.9241 50.9642 64.474 95.0171 92.9663 39.8066 19.0031 27.2362 75.2879 37.0743 53.2442 86.9706 75.9589 41.2546 69.0851 11.6236 93.1628 55.2727 23.5265 75.1577 22.8709 11.0623 56.9988 28.9044 28.3118 17.4442 81.2698 81.0091 93.087 11.9231 29.1284 61.252 57.7374 86.9803 3.6815 11.4245 50.7977 89.9789 49.0739 72.1613 14.4795 8.7271 19.3182 92.9786 10.1569 18.1111 25.1492 75.6683 27.5414 79.0405 52.4344 75.1448 53.068 13.3479 85.0959 68.6125 25.7968 25.8495 62.8633 56.0416 80.7054 83.596 65.9939 48.6263 92.9956 46.2007 27.4058 36.4357 19.3486 7.4625 31.3013 98.2644 23.889 27.4532 71.1097 10.7059 65.9134 52.261 33.3784 17.3089 13.5718 45.6118 21.6724 81.0768 58.4596 80.9725 91.4604 89.9602 73.3215 78.2618 78.3939 85.2111 18.8015 62.3726 37.2151 32.6762 54.0396 66.5884 92.0397 39.0061 81.5523 86.7746 67.7506 35.4764 91.2568 1.7265 62.2226 86.5511 26.56 34.6965 68.7662 56.3425 10.5231 89.5209 20.242 89.4787 12.3571 38.0819 81.1043 36.4267 53.5212 15.0945 35.7935 22.6939 73.3343 92.1475 39.6402 99.1009 76.8109 96.4813 37.1698 30.3242 24.7719 72.2803 28.7022 75.695 75.3147 59.5085 69.1445 48.9014 77.5056 87.1206 94.5147 33.9806 69.0333 35.8657 42.8757 12.6035 5.0392 92.9489 20.5147 85.8626 28.636 8.8076 53.0664 14.6274 66.6366 43.8391 19.575 85.2238 26.135 66.1281 52.3416 9.4371 28.0367 20.573 23.9686 79.7602 56.8394 19.4564 76.3507 58.8968 92.2365 73.4258 76.7132 70.3642 78.8833 67.9248 20.7506 60.0484 32.3563 38.547 27.6115 87.1839 86.7704 64.8816 52.2411 26.4507 7.4259 63.5643 55.1518 65.788 29.8802 4.2103 72.7355 24.3041 84.1743 37.1645 47.066 90.4003 88.159 24.8686 18.89 3.5917 45.7259 92.4248 6.1926 0.5345 13.3648 77.0773 96.4946 96.1064 39.6851 13.5243 43.3281 73.7762 19.7791 68.7382 84.4135 75.3986 32.6112 78.5094 2.0831 65.0873 78.6079 74.1017 43.3873 96.507 29.6306 28.3297 30.6675 77.2433 59.5813 8.7799 53.3578 97.2488 50.7748 44.6282 52.7991 63.5472 60.9778 69.3347 1.0255 30.1546 43.5043 82.2224 48.8859 6.9592 83.9778 58.6669 67.8112 75.6602 8.9073 42.0322 2.1758 69.4494 20.2232 13.4996 14.28 82.8146 72.3372 83.4979 37.5392 90.7055 17.8167 40.3695 57.9683 44.6287 37.6075 62.3208 46.5335 73.9765 77.7851 37.4088 12.0712 34.7012 46.7855 46.5267 25.3954 67.2606 59.9371 70.0939 86.3449 15.4395 0.8768 59.6726 13.094 64.234 0.2302 84.1319 77.7385 18.5503 33.9122 9.1896 55.3043 34.3123 25.9057 61.4988 48.9855 11.2608 79.9197 3.8396 85.9925 29.8051 90.4196 43.1901 32.0737 11.2202 62.9527 4.2969 46.4346 26.7068 96.4622 66.9917 38.8472 73.7708 49.1206 29.6899 78.0785 19.3905 33.3575 97.6208 82.0043 55.4814 50.4029 29.6858 4.3827 32.8988 66.9569 33.1232 72.1439 20.6268 66.3033 2.3334 46.0953 94.3606 94.6046 86.7005 15.9928 39.349 94.8849 35.1999 62.0484 87.2559 76.5614 75.0883 45.4213 7.384 50.8172 70.3148 9.976 47.2402 64.7543 81.7909 66.5705 24.5684 53.8426 17.0322 60.8175 45.548 59.5729 24.0313 8.1269 47.6595 76.5844 49.8484 80.9543 6.4816 36.7477 52.2991 87.8623 48.1662 49.7805 15.0924 71.7316 88.3611 93.9627 90.2866 3.3892 41.1744 35.1704 31.4504 58.4672 66.623
    ${output}=    Read Until Prompt
    Log    ${output}
    ${CmdComplete}=    Get Line    ${output}    -2
    Should Match Regexp    ${CmdComplete}    (=== \\[waitForCompletion_${component}\\] command )[0-9]+( timed out :)

Start Controller
    [Tags]    functional
    Switch Connection    Controller
    Comment    Move to working directory.
    Write    cd ${SALWorkDir}/${subSystem}/cpp/src
    Comment    Start Controller.
    ${input}=    Write    ./sacpp_${subSystem}_${component}_controller
    ${output}=    Read Until    controller ready
    Log    ${output}
    Should Contain    ${output}    ${subSystem}_${component} controller ready

Start Commander
    [Tags]    functional
    Switch Connection    Commander
    Comment    Move to working directory.
    Write    cd ${SALWorkDir}/${subSystem}/cpp/src
    Comment    Start Commander.
    ${input}=    Write    ./sacpp_${subSystem}_${component}_commander 88.469 99.3695 69.0555 59.2471 19.8689 75.9781 58.4772 14.6891 25.1859 10.1051 58.1576 6.0007 1.3867 81.0135 37.4733 70.0177 29.1373 7.9419 64.0023 60.974 70.0393 33.7561 25.6727 52.9428 29.1507 97.785 33.5442 65.5404 8.2612 91.2944 25.8237 41.1058 12.8999 40.8731 7.6775 3.3205 45.126 71.0796 50.3937 3.7012 32.1261 14.4695 81.25 94.243 97.8809 61.6107 39.1928 23.5408 12.7626 64.7043 79.3149 6.5557 68.0033 5.8028 59.0596 63.8679 26.7936 2.9882 75.9509 52.7414 76.6696 43.8861 12.0832 71.2742 38.659 29.2931 51.2123 73.9931 84.7137 76.265 32.9327 19.7346 7.9544 49.8734 50.8309 99.3844 26.4316 67.7891 9.367 80.1931 35.6189 5.8618 20.6602 19.0505 97.728 45.7471 69.1207 43.6612 1.8763 15.5828 62.2946 45.3821 23.2544 57.4319 50.2258 59.0739 73.1612 96.9832 48.5945 71.9648 27.304 50.7569 1.4826 47.5696 64.6144 86.8979 28.1737 79.7547 17.4282 98.1844 84.1851 54.3719 60.6434 7.2928 60.4638 73.582 31.7623 47.6089 95.328 59.6117 57.8463 99.5006 96.1505 75.4877 91.344 42.4154 83.0251 33.6884 3.6234 71.122 38.297 16.8362 77.034 27.114 49.6246 3.1269 10.7472 25.8011 74.5222 39.892 80.2036 28.8866 55.3838 67.6695 58.2589 33.1215 47.5642 84.7938 28.6472 83.4179 82.5092 56.7264 94.881 10.4285 43.9917 99.5151 37.9241 50.9642 64.474 95.0171 92.9663 39.8066 19.0031 27.2362 75.2879 37.0743 53.2442 86.9706 75.9589 41.2546 69.0851 11.6236 93.1628 55.2727 23.5265 75.1577 22.8709 11.0623 56.9988 28.9044 28.3118 17.4442 81.2698 81.0091 93.087 11.9231 29.1284 61.252 57.7374 86.9803 3.6815 11.4245 50.7977 89.9789 49.0739 72.1613 14.4795 8.7271 19.3182 92.9786 10.1569 18.1111 25.1492 75.6683 27.5414 79.0405 52.4344 75.1448 53.068 13.3479 85.0959 68.6125 25.7968 25.8495 62.8633 56.0416 80.7054 83.596 65.9939 48.6263 92.9956 46.2007 27.4058 36.4357 19.3486 7.4625 31.3013 98.2644 23.889 27.4532 71.1097 10.7059 65.9134 52.261 33.3784 17.3089 13.5718 45.6118 21.6724 81.0768 58.4596 80.9725 91.4604 89.9602 73.3215 78.2618 78.3939 85.2111 18.8015 62.3726 37.2151 32.6762 54.0396 66.5884 92.0397 39.0061 81.5523 86.7746 67.7506 35.4764 91.2568 1.7265 62.2226 86.5511 26.56 34.6965 68.7662 56.3425 10.5231 89.5209 20.242 89.4787 12.3571 38.0819 81.1043 36.4267 53.5212 15.0945 35.7935 22.6939 73.3343 92.1475 39.6402 99.1009 76.8109 96.4813 37.1698 30.3242 24.7719 72.2803 28.7022 75.695 75.3147 59.5085 69.1445 48.9014 77.5056 87.1206 94.5147 33.9806 69.0333 35.8657 42.8757 12.6035 5.0392 92.9489 20.5147 85.8626 28.636 8.8076 53.0664 14.6274 66.6366 43.8391 19.575 85.2238 26.135 66.1281 52.3416 9.4371 28.0367 20.573 23.9686 79.7602 56.8394 19.4564 76.3507 58.8968 92.2365 73.4258 76.7132 70.3642 78.8833 67.9248 20.7506 60.0484 32.3563 38.547 27.6115 87.1839 86.7704 64.8816 52.2411 26.4507 7.4259 63.5643 55.1518 65.788 29.8802 4.2103 72.7355 24.3041 84.1743 37.1645 47.066 90.4003 88.159 24.8686 18.89 3.5917 45.7259 92.4248 6.1926 0.5345 13.3648 77.0773 96.4946 96.1064 39.6851 13.5243 43.3281 73.7762 19.7791 68.7382 84.4135 75.3986 32.6112 78.5094 2.0831 65.0873 78.6079 74.1017 43.3873 96.507 29.6306 28.3297 30.6675 77.2433 59.5813 8.7799 53.3578 97.2488 50.7748 44.6282 52.7991 63.5472 60.9778 69.3347 1.0255 30.1546 43.5043 82.2224 48.8859 6.9592 83.9778 58.6669 67.8112 75.6602 8.9073 42.0322 2.1758 69.4494 20.2232 13.4996 14.28 82.8146 72.3372 83.4979 37.5392 90.7055 17.8167 40.3695 57.9683 44.6287 37.6075 62.3208 46.5335 73.9765 77.7851 37.4088 12.0712 34.7012 46.7855 46.5267 25.3954 67.2606 59.9371 70.0939 86.3449 15.4395 0.8768 59.6726 13.094 64.234 0.2302 84.1319 77.7385 18.5503 33.9122 9.1896 55.3043 34.3123 25.9057 61.4988 48.9855 11.2608 79.9197 3.8396 85.9925 29.8051 90.4196 43.1901 32.0737 11.2202 62.9527 4.2969 46.4346 26.7068 96.4622 66.9917 38.8472 73.7708 49.1206 29.6899 78.0785 19.3905 33.3575 97.6208 82.0043 55.4814 50.4029 29.6858 4.3827 32.8988 66.9569 33.1232 72.1439 20.6268 66.3033 2.3334 46.0953 94.3606 94.6046 86.7005 15.9928 39.349 94.8849 35.1999 62.0484 87.2559 76.5614 75.0883 45.4213 7.384 50.8172 70.3148 9.976 47.2402 64.7543 81.7909 66.5705 24.5684 53.8426 17.0322 60.8175 45.548 59.5729 24.0313 8.1269 47.6595 76.5844 49.8484 80.9543 6.4816 36.7477 52.2991 87.8623 48.1662 49.7805 15.0924 71.7316 88.3611 93.9627 90.2866 3.3892 41.1744 35.1704 31.4504 58.4672 66.623
    ${output}=    Read Until Prompt
    Log    ${output}
    Should Contain X Times    ${output}    === [issueCommand_${component}] writing a command containing :    1
    Should Contain X Times    ${output}    device : target    1
    Should Contain X Times    ${output}    property : lut    1
    Should Contain X Times    ${output}    action :     1
    Should Contain X Times    ${output}    value :     1
    Should Contain X Times    ${output}    xlut : 88.469    1
    Should Contain X Times    ${output}    ylut : 62.2946    1
    Should Contain X Times    ${output}    zlut : 28.3118    1
    Should Contain X Times    ${output}    ulut : 20.242    1
    Should Contain X Times    ${output}    vlut : 45.7259    1
    Should Contain X Times    ${output}    wlut : 55.3043    1
    Should Contain    ${output}    === command configureLut issued =
    ${CmdComplete}=    Get Line    ${output}    -2
    Should Match Regexp    ${CmdComplete}    (=== \\[waitForCompletion_${component}\\] command )[0-9]+( completed ok :)

Read Controller
    [Tags]    functional
    Switch Connection    Controller
    ${output}=    Read Until    result \ \ : Done : OK
    Log    ${output}
    Should Contain    ${output}    === command configureLut received =
    Should Contain    ${output}    device : target
    Should Contain    ${output}    property : lut
    Should Contain    ${output}    action : 
    Should Contain    ${output}    value : 
    Should Contain X Times    ${output}    xlut : 88.469    1
    Should Contain X Times    ${output}    ylut : 62.2946    1
    Should Contain X Times    ${output}    zlut : 28.3118    1
    Should Contain X Times    ${output}    ulut : 20.242    1
    Should Contain X Times    ${output}    vlut : 45.7259    1
    Should Contain X Times    ${output}    wlut : 55.3043    1
    Should Contain X Times    ${output}    === [ackCommand_configureLut] acknowledging a command with :    2
    Should Contain    ${output}    seqNum   :
    Should Contain    ${output}    ack      : 301
    Should Contain X Times    ${output}    error \ \ \ : 0    2
    Should Contain    ${output}    result   : Ack : OK
    Should Contain    ${output}    ack      : 303
    Should Contain    ${output}    result   : Done : OK
