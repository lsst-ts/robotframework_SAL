*** Settings ***
Documentation    Hexapod_configureLut commander/controller tests.
Force Tags    cpp
Suite Setup    Log Many    ${Host}    ${subSystem}    ${component}    ${timeout}
Suite Teardown    Close All Connections
Library    SSHLibrary
Library    String
Resource    ../../Global_Vars.robot

*** Variables ***
${subSystem}    hexapod
${component}    configureLut
${timeout}    30s

*** Test Cases ***
Create Commander Session
    [Documentation]    Connect to the SAL host.
    [Tags]    smoke
    Comment    Connect to host.
    Open Connection    host=${Host}    alias=Commander    timeout=${timeout}    prompt=${Prompt}
    Comment    Login.
    Log    ${ContInt}
    Login With Public Key    ${UserName}    keyfile=${KeyFile}    password=${PassWord}
    Directory Should Exist    ${SALInstall}
    Directory Should Exist    ${SALHome}

Create Controller Session
    [Documentation]    Connect to the SAL host.
    [Tags]    smoke
    Comment    Connect to host.
    Open Connection    host=${Host}    alias=Controller    timeout=${timeout}    prompt=${Prompt}
    Comment    Login.
    Log    ${ContInt}
    Login With Public Key    ${UserName}    keyfile=${KeyFile}    password=${PassWord}
    Directory Should Exist    ${SALInstall}
    Directory Should Exist    ${SALHome}

Verify Component Commander and Controller
    [Tags]    smoke
    File Should Exist    ${SALWorkDir}/${subSystem}/cpp/src/sacpp_${subSystem}_${component}_commander
    File Should Exist    ${SALWorkDir}/${subSystem}/cpp/src/sacpp_${subSystem}_${component}_controller

Start Commander - Verify Missing Inputs Error
    [Tags]    functional
    Switch Connection    Commander
    Comment    Move to working directory.
    Write    cd ${SALWorkDir}/${subSystem}/cpp/src
    Comment    Start Commander.
    ${input}=    Write    ./sacpp_${subSystem}_${component}_commander 
    ${output}=    Read Until Prompt
    Log    ${output}
    Should Contain    ${output}   Usage : \ input parameters...

Start Commander - Verify Timeout without Controller
    [Tags]    functional
    Switch Connection    Commander
    Comment    Move to working directory.
    Write    cd ${SALWorkDir}/${subSystem}/cpp/src
    Comment    Start Commander.
    ${input}=    Write    ./sacpp_${subSystem}_${component}_commander 12.1009 53.6607 97.3751 16.6811 91.2773 51.3125 46.052 70.4921 56.2542 2.2205 57.7715 27.4498 99.9458 85.7348 85.9285 81.2616 91.7214 7.0152 65.4256 26.0798 30.654 88.1663 23.7908 40.7658 90.9106 59.5937 8.0343 83.2861 54.9366 66.1012 37.5318 7.1975 20.345 60.9819 7.5029 40.5472 79.0443 35.946 6.0893 17.6784 81.6876 86.7022 31.726 17.7248 93.5471 55.7192 8.0768 19.835 84.8432 99.0702 7.4482 45.0315 29.1325 61.3924 24.7585 26.9132 24.7937 62.8869 39.8754 48.2083 38.4341 28.9134 96.8431 78.6165 31.8207 82.2546 5.8157 30.8773 1.525 18.6546 32.8082 89.3304 21.2 57.745 43.2377 9.1663 67.0065 59.5675 18.8402 62.9441 85.7785 41.6699 27.7248 47.4369 32.3837 2.0856 1.2184 60.0154 24.2339 80.5863 53.4896 77.8928 68.4922 89.2681 46.1357 34.085 83.8667 75.4303 96.3763 46.6515 69.362 40.6652 48.3017 62.5651 79.8756 84.9487 13.1718 96.3059 99.142 98.5248 72.8622 25.6891 46.7291 11.2413 35.3833 98.2048 43.4969 47.7846 45.5915 33.4934 44.3407 31.3634 30.726 54.6768 99.0689 61.6254 49.8701 26.2194 10.9812 33.6846 35.0433 70.3791 16.9428 24.2911 80.3568 67.018 46.6095 28.0081 62.7252 61.5251 3.9764 50.2806 91.9734 55.3259 68.291 71.3993 85.0623 41.9835 69.8993 19.3942 82.3939 21.0766 31.8128 72.103 87.2924 18.7836 79.2322 98.6053 13.3841 88.9227 9.1068 48.0531 73.0104 87.5307 59.7312 7.7413 54.4241 62.9332 82.6706 36.9314 61.5555 94.4993 72.4149 67.9287 70.2255 67.2427 74.5033 43.3764 18.4283 4.696 37.2926 81.4435 83.3841 59.0452 45.2491 98.9925 19.2509 62.1655 12.7963 83.6608 91.3985 32.7502 4.763 37.4501 51.6207 6.4476 44.9289 26.1868 39.9517 86.6472 99.9695 46.3528 70.6263 44.0481 23.6 53.7535 64.2484 22.0082 36.2167 50.084 56.8958 49.9247 81.8273 15.2805 24.5589 40.9769 94.8465 78.2248 55.7298 51.5935 25.8638 32.4161 73.186 3.2942 41.6638 12.1544 41.0916 7.4185 33.738 55.2944 34.8114 75.2612 21.3496 41.3683 85.7171 33.0413 12.3074 85.9802 4.2686 87.1268 38.1225 4.342 36.3898 89.8634 16.5499 56.0536 31.4657 40.8149 72.3073 82.4048 15.6592 71.8361 11.8735 64.6613 64.9237 49.3735 57.7369 53.6967 43.4668 66.3495 0.532 39.2422 90.3673 72.0714 78.5839 0.7767 93.4996 84.8884 56.2581 0.0826 15.7843 25.1344 64.2141 60.4885 59.3516 97.8696 35.6935 27.5294 56.6571 2.4808 95.8199 45.589 6.484 34.8222 7.1052 61.3736 42.9272 44.6347 43.788 47.2615 73.3813 1.7554 95.6157 53.1998 12.4617 54.5033 36.3678 6.0995 71.1015 18.0199 6.4091 60.7469 49.1094 53.6395 87.7314 80.772 12.9678 45.7549 63.8804 41.7803 78.9793 51.3645 17.1698 68.5799 6.5062 80.3401 72.7448 43.9033 75.2832 1.9536 8.1714 72.8486 35.8181 1.7262 58.7973 97.6391 6.5592 50.3916 5.7052 25.5573 26.318 75.1444 72.0037 24.4844 24.6595 33.1849 91.9165 91.3857 55.0654 80.7422 59.2478 86.3184 58.05 51.3989 70.3943 82.5471 36.6042 45.1572 42.9273 83.0024 50.2346 54.5693 99.7326 34.2428 98.4956 37.1999 58.7852 37.8276 92.3172 99.0347 41.993 6.0395 79.0361 79.7581 43.2634 98.7232 61.6069 69.1068 82.1193 88.6168 35.4945 31.4823 72.834 51.5381 91.3572 78.441 73.4838 98.309 16.3895 39.355 6.2312 32.7337 88.5935 16.5369 52.1806 24.9972 81.8711 92.2304 57.9866 23.2278 79.4716 60.9767 14.2502 38.9618 97.6766 27.8283 25.1339 69.8496 89.272 5.3239 60.5715 25.1623 33.0301 47.6292 23.4449 55.9812 95.8757 1.8016 14.6923 65.4034 45.9019 26.1401 61.5175 15.6315 69.8634 25.9011 23.8942 66.923 8.6028 9.0538 21.6629 47.7379 64.782 61.5785 51.1138 52.1198 25.5103 22.7491 53.1195 89.3096 25.1277 45.8896 91.02 62.6655 58.2098 19.9769 29.125 8.017 86.3365 18.3998 66.022 7.2724 80.362 67.0719 80.4347 36.0136 40.0676 28.4947 61.7481 0.6689 65.931 98.733 48.8987 36.0951 23.8391 53.871 59.0605 98.0485 39.8011 2.2962 39.4851 36.0002 58.1402 21.9153 40.3273 25.6609 20.6707 97.0286 50.52 24.0034 19.4888 38.8433 7.2628 5.324 19.2079 52.8006 32.5694 61.5785 95.813 31.3189 83.5511 46.9347 10.134 73.2229 71.855 28.9979 14.7167 83.2982 38.3179 30.1362 6.9686 27.2127 70.2969 27.299 12.3345 60.3581 32.014 90.3375 4.9311 49.2174 72.6202 74.9461 64.4721 43.6161 57.7634 41.9286 30.0199 18.0411 74.5516 20.3496 59.4528 85.991 92.6606 97.9811 42.6125 91.3884 16.3344 21.9098 88.7044 89.243 65.6262 25.5252 39.9447 72.643 87.6325 18.2884 26.998 59.9424 23.6784 97.8902 83.3534 41.8295 28.371 86.307 2.4931 51.9928 85.7636 8.634 81.6673 31.8489
    ${output}=    Read Until Prompt
    Log    ${output}
    ${CmdComplete}=    Get Line    ${output}    -2
    Should Match Regexp    ${CmdComplete}    (=== \\[waitForCompletion_${component}\\] command )[0-9]+( timed out :)

Start Controller
    [Tags]    functional
    Switch Connection    Controller
    Comment    Move to working directory.
    Write    cd ${SALWorkDir}/${subSystem}/cpp/src
    Comment    Start Controller.
    ${input}=    Write    ./sacpp_${subSystem}_${component}_controller
    ${output}=    Read Until    controller ready
    Log    ${output}
    Should Contain    ${output}    ${subSystem}_${component} controller ready

Start Commander
    [Tags]    functional
    Switch Connection    Commander
    Comment    Move to working directory.
    Write    cd ${SALWorkDir}/${subSystem}/cpp/src
    Comment    Start Commander.
    ${input}=    Write    ./sacpp_${subSystem}_${component}_commander 12.1009 53.6607 97.3751 16.6811 91.2773 51.3125 46.052 70.4921 56.2542 2.2205 57.7715 27.4498 99.9458 85.7348 85.9285 81.2616 91.7214 7.0152 65.4256 26.0798 30.654 88.1663 23.7908 40.7658 90.9106 59.5937 8.0343 83.2861 54.9366 66.1012 37.5318 7.1975 20.345 60.9819 7.5029 40.5472 79.0443 35.946 6.0893 17.6784 81.6876 86.7022 31.726 17.7248 93.5471 55.7192 8.0768 19.835 84.8432 99.0702 7.4482 45.0315 29.1325 61.3924 24.7585 26.9132 24.7937 62.8869 39.8754 48.2083 38.4341 28.9134 96.8431 78.6165 31.8207 82.2546 5.8157 30.8773 1.525 18.6546 32.8082 89.3304 21.2 57.745 43.2377 9.1663 67.0065 59.5675 18.8402 62.9441 85.7785 41.6699 27.7248 47.4369 32.3837 2.0856 1.2184 60.0154 24.2339 80.5863 53.4896 77.8928 68.4922 89.2681 46.1357 34.085 83.8667 75.4303 96.3763 46.6515 69.362 40.6652 48.3017 62.5651 79.8756 84.9487 13.1718 96.3059 99.142 98.5248 72.8622 25.6891 46.7291 11.2413 35.3833 98.2048 43.4969 47.7846 45.5915 33.4934 44.3407 31.3634 30.726 54.6768 99.0689 61.6254 49.8701 26.2194 10.9812 33.6846 35.0433 70.3791 16.9428 24.2911 80.3568 67.018 46.6095 28.0081 62.7252 61.5251 3.9764 50.2806 91.9734 55.3259 68.291 71.3993 85.0623 41.9835 69.8993 19.3942 82.3939 21.0766 31.8128 72.103 87.2924 18.7836 79.2322 98.6053 13.3841 88.9227 9.1068 48.0531 73.0104 87.5307 59.7312 7.7413 54.4241 62.9332 82.6706 36.9314 61.5555 94.4993 72.4149 67.9287 70.2255 67.2427 74.5033 43.3764 18.4283 4.696 37.2926 81.4435 83.3841 59.0452 45.2491 98.9925 19.2509 62.1655 12.7963 83.6608 91.3985 32.7502 4.763 37.4501 51.6207 6.4476 44.9289 26.1868 39.9517 86.6472 99.9695 46.3528 70.6263 44.0481 23.6 53.7535 64.2484 22.0082 36.2167 50.084 56.8958 49.9247 81.8273 15.2805 24.5589 40.9769 94.8465 78.2248 55.7298 51.5935 25.8638 32.4161 73.186 3.2942 41.6638 12.1544 41.0916 7.4185 33.738 55.2944 34.8114 75.2612 21.3496 41.3683 85.7171 33.0413 12.3074 85.9802 4.2686 87.1268 38.1225 4.342 36.3898 89.8634 16.5499 56.0536 31.4657 40.8149 72.3073 82.4048 15.6592 71.8361 11.8735 64.6613 64.9237 49.3735 57.7369 53.6967 43.4668 66.3495 0.532 39.2422 90.3673 72.0714 78.5839 0.7767 93.4996 84.8884 56.2581 0.0826 15.7843 25.1344 64.2141 60.4885 59.3516 97.8696 35.6935 27.5294 56.6571 2.4808 95.8199 45.589 6.484 34.8222 7.1052 61.3736 42.9272 44.6347 43.788 47.2615 73.3813 1.7554 95.6157 53.1998 12.4617 54.5033 36.3678 6.0995 71.1015 18.0199 6.4091 60.7469 49.1094 53.6395 87.7314 80.772 12.9678 45.7549 63.8804 41.7803 78.9793 51.3645 17.1698 68.5799 6.5062 80.3401 72.7448 43.9033 75.2832 1.9536 8.1714 72.8486 35.8181 1.7262 58.7973 97.6391 6.5592 50.3916 5.7052 25.5573 26.318 75.1444 72.0037 24.4844 24.6595 33.1849 91.9165 91.3857 55.0654 80.7422 59.2478 86.3184 58.05 51.3989 70.3943 82.5471 36.6042 45.1572 42.9273 83.0024 50.2346 54.5693 99.7326 34.2428 98.4956 37.1999 58.7852 37.8276 92.3172 99.0347 41.993 6.0395 79.0361 79.7581 43.2634 98.7232 61.6069 69.1068 82.1193 88.6168 35.4945 31.4823 72.834 51.5381 91.3572 78.441 73.4838 98.309 16.3895 39.355 6.2312 32.7337 88.5935 16.5369 52.1806 24.9972 81.8711 92.2304 57.9866 23.2278 79.4716 60.9767 14.2502 38.9618 97.6766 27.8283 25.1339 69.8496 89.272 5.3239 60.5715 25.1623 33.0301 47.6292 23.4449 55.9812 95.8757 1.8016 14.6923 65.4034 45.9019 26.1401 61.5175 15.6315 69.8634 25.9011 23.8942 66.923 8.6028 9.0538 21.6629 47.7379 64.782 61.5785 51.1138 52.1198 25.5103 22.7491 53.1195 89.3096 25.1277 45.8896 91.02 62.6655 58.2098 19.9769 29.125 8.017 86.3365 18.3998 66.022 7.2724 80.362 67.0719 80.4347 36.0136 40.0676 28.4947 61.7481 0.6689 65.931 98.733 48.8987 36.0951 23.8391 53.871 59.0605 98.0485 39.8011 2.2962 39.4851 36.0002 58.1402 21.9153 40.3273 25.6609 20.6707 97.0286 50.52 24.0034 19.4888 38.8433 7.2628 5.324 19.2079 52.8006 32.5694 61.5785 95.813 31.3189 83.5511 46.9347 10.134 73.2229 71.855 28.9979 14.7167 83.2982 38.3179 30.1362 6.9686 27.2127 70.2969 27.299 12.3345 60.3581 32.014 90.3375 4.9311 49.2174 72.6202 74.9461 64.4721 43.6161 57.7634 41.9286 30.0199 18.0411 74.5516 20.3496 59.4528 85.991 92.6606 97.9811 42.6125 91.3884 16.3344 21.9098 88.7044 89.243 65.6262 25.5252 39.9447 72.643 87.6325 18.2884 26.998 59.9424 23.6784 97.8902 83.3534 41.8295 28.371 86.307 2.4931 51.9928 85.7636 8.634 81.6673 31.8489
    ${output}=    Read Until Prompt
    Log    ${output}
    Should Contain X Times    ${output}    === [issueCommand_${component}] writing a command containing :    1
    Should Contain X Times    ${output}    device : target    1
    Should Contain X Times    ${output}    property : lut    1
    Should Contain X Times    ${output}    action :     1
    Should Contain X Times    ${output}    value :     1
    Should Contain X Times    ${output}    xlut : 12.1009    1
    Should Contain X Times    ${output}    ylut : 53.4896    1
    Should Contain X Times    ${output}    zlut : 37.2926    1
    Should Contain X Times    ${output}    ulut : 15.7843    1
    Should Contain X Times    ${output}    vlut : 41.993    1
    Should Contain X Times    ${output}    wlut : 65.931    1
    Should Contain    ${output}    === command configureLut issued =
    ${CmdComplete}=    Get Line    ${output}    -2
    Should Match Regexp    ${CmdComplete}    (=== \\[waitForCompletion_${component}\\] command )[0-9]+( completed ok :)

Read Controller
    [Tags]    functional
    Switch Connection    Controller
    ${output}=    Read Until    result \ \ : Done : OK
    Log    ${output}
    Should Contain    ${output}    === command configureLut received =
    Should Contain    ${output}    device : target
    Should Contain    ${output}    property : lut
    Should Contain    ${output}    action : 
    Should Contain    ${output}    value : 
    Should Contain X Times    ${output}    xlut : 12.1009    1
    Should Contain X Times    ${output}    ylut : 53.4896    1
    Should Contain X Times    ${output}    zlut : 37.2926    1
    Should Contain X Times    ${output}    ulut : 15.7843    1
    Should Contain X Times    ${output}    vlut : 41.993    1
    Should Contain X Times    ${output}    wlut : 65.931    1
    Should Contain X Times    ${output}    === [ackCommand_configureLut] acknowledging a command with :    2
    Should Contain    ${output}    seqNum   :
    Should Contain    ${output}    ack      : 301
    Should Contain X Times    ${output}    error \ \ \ : 0    2
    Should Contain    ${output}    result   : Ack : OK
    Should Contain    ${output}    ack      : 303
    Should Contain    ${output}    result   : Done : OK
