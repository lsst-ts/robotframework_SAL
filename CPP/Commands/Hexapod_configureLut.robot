*** Settings ***
Documentation    Hexapod_configureLut commander/controller tests.
Force Tags    cpp
Suite Setup    Log Many    ${Host}    ${subSystem}    ${component}    ${timeout}
Suite Teardown    Close All Connections
Library    SSHLibrary
Library    String
Resource    ../../Global_Vars.robot

*** Variables ***
${subSystem}    hexapod
${component}    configureLut
${timeout}    30s

*** Test Cases ***
Create Commander Session
    [Documentation]    Connect to the SAL host.
    [Tags]    smoke
    Comment    Connect to host.
    Open Connection    host=${Host}    alias=Commander    timeout=${timeout}    prompt=${Prompt}
    Comment    Login.
    Log    ${ContInt}
    Login With Public Key    ${UserName}    keyfile=${KeyFile}    password=${PassWord}
    Directory Should Exist    ${SALInstall}
    Directory Should Exist    ${SALHome}

Create Controller Session
    [Documentation]    Connect to the SAL host.
    [Tags]    smoke
    Comment    Connect to host.
    Open Connection    host=${Host}    alias=Controller    timeout=${timeout}    prompt=${Prompt}
    Comment    Login.
    Log    ${ContInt}
    Login With Public Key    ${UserName}    keyfile=${KeyFile}    password=${PassWord}
    Directory Should Exist    ${SALInstall}
    Directory Should Exist    ${SALHome}

Verify Component Commander and Controller
    [Tags]    smoke
    File Should Exist    ${SALWorkDir}/${subSystem}/cpp/src/sacpp_${subSystem}_${component}_commander
    File Should Exist    ${SALWorkDir}/${subSystem}/cpp/src/sacpp_${subSystem}_${component}_controller

Start Commander - Verify Missing Inputs Error
    [Tags]    functional
    Switch Connection    Commander
    Comment    Move to working directory.
    Write    cd ${SALWorkDir}/${subSystem}/cpp/src
    Comment    Start Commander.
    ${input}=    Write    ./sacpp_${subSystem}_${component}_commander 
    ${output}=    Read Until Prompt
    Log    ${output}
    Should Contain    ${output}   Usage : \ input parameters...

Start Commander - Verify Timeout without Controller
    [Tags]    functional
    Switch Connection    Commander
    Comment    Move to working directory.
    Write    cd ${SALWorkDir}/${subSystem}/cpp/src
    Comment    Start Commander.
    ${input}=    Write    ./sacpp_${subSystem}_${component}_commander 86.8182 75.3604 3.4375 42.0748 81.879 59.5541 68.68 50.5114 57.376 81.5892 0.8662 29.8373 5.9394 42.8764 92.5601 20.9297 49.3404 1.6705 46.4123 78.0561 47.3462 21.8376 88.9941 97.8569 7.1126 1.8674 60.4722 81.3791 68.1415 56.3244 80.5928 32.9666 17.6712 87.4896 9.0864 27.209 51.5676 51.2508 68.5177 7.2585 93.6682 50.1011 79.3233 51.3171 33.2812 55.8734 38.0714 94.3449 40.0804 75.9144 94.5809 20.4112 51.8327 26.5558 45.9708 11.9922 9.2649 42.7348 24.1187 40.8138 20.8978 48.3736 14.457 83.5394 37.7926 96.437 96.1991 96.522 55.9358 87.4987 18.9386 10.2919 51.8353 64.4005 94.6575 15.9935 86.3516 33.1172 17.7931 64.2216 5.2116 59.1833 13.1091 4.3665 34.8012 32.421 8.0609 12.5714 33.7442 56.9325 78.2109 95.0327 28.7671 13.8594 84.6877 93.534 77.1524 16.0544 20.6912 44.7234 54.234 10.6649 69.163 40.6638 67.8055 21.1057 74.4035 83.9594 27.1276 17.8228 54.4677 90.721 80.4297 84.6479 45.3649 86.7487 46.6116 70.9005 82.4216 83.7321 37.7981 30.1847 29.9361 18.2006 49.8203 31.7543 3.3075 9.0837 57.2499 69.7153 58.8918 92.5051 52.074 95.5247 68.0405 70.0713 90.5445 0.426 69.8295 5.363 97.9321 78.4989 9.0185 95.4624 88.3427 71.6126 21.5608 45.6556 49.8912 12.2263 86.2796 22.1547 50.3371 99.86 45.0639 91.3247 91.1143 74.974 48.4398 60.4337 74.896 51.6996 31.1815 19.7997 15.6414 42.1591 63.3211 37.0972 0.6669 50.1182 26.5034 34.4467 74.3511 48.2706 85.5908 48.4409 96.0076 83.9353 61.4398 47.7753 41.8878 19.9089 68.493 23.9076 23.5491 0.2131 58.6785 23.9789 18.5778 51.451 40.1987 99.653 11.9191 31.2671 99.7154 18.8924 50.5782 66.8727 91.3434 81.6231 4.4433 80.0587 31.2483 64.0838 74.9115 11.3881 91.5303 22.0346 57.2814 94.6689 88.8043 90.7147 64.7368 19.7151 8.0347 19.7205 58.7513 43.1782 29.5868 29.7675 96.3706 13.3883 96.7972 99.4692 46.7915 10.5747 3.6173 74.7254 49.9524 38.4159 14.2578 6.4716 32.2877 89.6599 36.5155 48.8395 40.8339 12.747 34.368 60.5637 99.4183 76.5704 32.7914 72.9736 59.3175 81.8353 36.7983 80.7716 66.7873 89.5836 86.5642 20.6288 15.7818 51.4737 58.0883 77.8212 87.2459 45.345 23.5075 49.4138 9.4149 86.0539 85.7705 96.4899 11.8187 8.2415 62.5587 52.1004 26.2938 88.0648 82.3155 76.2008 31.3207 74.5318 23.3837 37.292 93.8285 81.1372 69.5503 27.4128 45.2971 76.99 40.2856 17.1662 40.9586 62.3239 19.8993 90.1127 10.9657 42.2074 21.4148 77.2435 32.2364 13.8222 69.5094 61.9516 77.7553 27.5956 64.5943 42.5957 27.901 92.1851 89.3615 38.8253 4.9492 70.7628 63.2287 75.3471 1.1229 82.6991 7.7969 91.6437 3.7778 87.7062 13.591 28.5822 70.5753 11.6965 67.7413 52.2446 17.6814 81.8294 36.1096 18.6461 50.9957 60.3002 54.2511 0.5906 92.7357 25.9696 49.8378 5.9774 80.2955 38.7941 72.5755 0.0364 27.6074 74.4238 9.9373 27.1666 8.1697 41.5464 61.0191 38.3211 29.2375 11.5819 79.5307 54.8834 35.7099 6.2388 79.6955 57.38 52.8759 12.3743 18.967 75.8337 78.7893 34.0764 62.6044 18.6025 77.4575 73.3475 90.4124 76.7644 16.5664 74.0461 30.2402 51.8664 29.1971 7.2963 68.277 54.0967 90.6163 2.0038 14.871 81.3061 11.1504 11.6647 27.0883 51.5083 32.136 56.0756 97.2462 10.5335 94.2583 43.0244 84.2901 54.9162 38.3619 18.8772 9.0528 58.5118 85.6767 67.3465 46.9184 37.8159 35.4644 10.2451 48.7921 94.1343 51.6227 37.3695 93.4607 54.2652 55.395 33.3267 87.001 50.5749 85.3675 95.7929 22.7643 77.6586 97.4451 53.9987 67.3082 31.4582 24.871 77.374 97.0866 41.4221 27.3604 86.0341 61.2664 53.966 83.2856 64.1871 63.7119 96.2008 56.7719 75.1915 13.1674 61.9034 92.8131 85.587 55.4971 15.2809 46.7752 41.3528 50.2905 80.2838 2.2222 57.619 91.9296 4.7808 18.9172 8.894 51.9191 27.8549 67.5387 66.7995 35.579 12.5734 81.207 38.931 81.0603 35.766 76.044 59.5333 6.9714 5.6118 18.3252 13.8286 68.6976 87.7729 31.1199 23.2576 80.0737 80.7125 81.6997 75.9182 90.6455 59.0362 98.3206 87.459 23.8116 39.657 85.8409 23.9948 60.3403 41.5036 56.899 98.363 5.1083 57.8129 39.5645 32.5221 13.6794 65.564 59.3217 72.8126 89.1047 10.7649 37.1909 45.0075 43.4921 40.8482 78.5911 16.6271 56.0923 51.3403 3.797 63.4219 8.6492 61.3369 62.5071 41.3041 87.1623 7.1799 91.1702 64.7367 57.8429 93.6329 34.2098 46.2944 66.8221 59.3961 95.7686 99.7049 16.7879 78.2758 23.8087 14.1376 69.8879 18.3662 51.5628 28.0258 20.5942 6.0206 66.0558 96.2944 99.914 93.7412 9.4413 73.7929 17.7868 86.2953 4.1905 70.6617 26.5573 2.0434
    ${output}=    Read Until Prompt
    Log    ${output}
    ${CmdComplete}=    Get Line    ${output}    -2
    Should Match Regexp    ${CmdComplete}    (=== \\[waitForCompletion_${component}\\] command )[0-9]+( timed out :)

Start Controller
    [Tags]    functional
    Switch Connection    Controller
    Comment    Move to working directory.
    Write    cd ${SALWorkDir}/${subSystem}/cpp/src
    Comment    Start Controller.
    ${input}=    Write    ./sacpp_${subSystem}_${component}_controller
    ${output}=    Read Until    controller ready
    Log    ${output}
    Should Contain    ${output}    ${subSystem}_${component} controller ready

Start Commander
    [Tags]    functional
    Switch Connection    Commander
    Comment    Move to working directory.
    Write    cd ${SALWorkDir}/${subSystem}/cpp/src
    Comment    Start Commander.
    ${input}=    Write    ./sacpp_${subSystem}_${component}_commander 86.8182 75.3604 3.4375 42.0748 81.879 59.5541 68.68 50.5114 57.376 81.5892 0.8662 29.8373 5.9394 42.8764 92.5601 20.9297 49.3404 1.6705 46.4123 78.0561 47.3462 21.8376 88.9941 97.8569 7.1126 1.8674 60.4722 81.3791 68.1415 56.3244 80.5928 32.9666 17.6712 87.4896 9.0864 27.209 51.5676 51.2508 68.5177 7.2585 93.6682 50.1011 79.3233 51.3171 33.2812 55.8734 38.0714 94.3449 40.0804 75.9144 94.5809 20.4112 51.8327 26.5558 45.9708 11.9922 9.2649 42.7348 24.1187 40.8138 20.8978 48.3736 14.457 83.5394 37.7926 96.437 96.1991 96.522 55.9358 87.4987 18.9386 10.2919 51.8353 64.4005 94.6575 15.9935 86.3516 33.1172 17.7931 64.2216 5.2116 59.1833 13.1091 4.3665 34.8012 32.421 8.0609 12.5714 33.7442 56.9325 78.2109 95.0327 28.7671 13.8594 84.6877 93.534 77.1524 16.0544 20.6912 44.7234 54.234 10.6649 69.163 40.6638 67.8055 21.1057 74.4035 83.9594 27.1276 17.8228 54.4677 90.721 80.4297 84.6479 45.3649 86.7487 46.6116 70.9005 82.4216 83.7321 37.7981 30.1847 29.9361 18.2006 49.8203 31.7543 3.3075 9.0837 57.2499 69.7153 58.8918 92.5051 52.074 95.5247 68.0405 70.0713 90.5445 0.426 69.8295 5.363 97.9321 78.4989 9.0185 95.4624 88.3427 71.6126 21.5608 45.6556 49.8912 12.2263 86.2796 22.1547 50.3371 99.86 45.0639 91.3247 91.1143 74.974 48.4398 60.4337 74.896 51.6996 31.1815 19.7997 15.6414 42.1591 63.3211 37.0972 0.6669 50.1182 26.5034 34.4467 74.3511 48.2706 85.5908 48.4409 96.0076 83.9353 61.4398 47.7753 41.8878 19.9089 68.493 23.9076 23.5491 0.2131 58.6785 23.9789 18.5778 51.451 40.1987 99.653 11.9191 31.2671 99.7154 18.8924 50.5782 66.8727 91.3434 81.6231 4.4433 80.0587 31.2483 64.0838 74.9115 11.3881 91.5303 22.0346 57.2814 94.6689 88.8043 90.7147 64.7368 19.7151 8.0347 19.7205 58.7513 43.1782 29.5868 29.7675 96.3706 13.3883 96.7972 99.4692 46.7915 10.5747 3.6173 74.7254 49.9524 38.4159 14.2578 6.4716 32.2877 89.6599 36.5155 48.8395 40.8339 12.747 34.368 60.5637 99.4183 76.5704 32.7914 72.9736 59.3175 81.8353 36.7983 80.7716 66.7873 89.5836 86.5642 20.6288 15.7818 51.4737 58.0883 77.8212 87.2459 45.345 23.5075 49.4138 9.4149 86.0539 85.7705 96.4899 11.8187 8.2415 62.5587 52.1004 26.2938 88.0648 82.3155 76.2008 31.3207 74.5318 23.3837 37.292 93.8285 81.1372 69.5503 27.4128 45.2971 76.99 40.2856 17.1662 40.9586 62.3239 19.8993 90.1127 10.9657 42.2074 21.4148 77.2435 32.2364 13.8222 69.5094 61.9516 77.7553 27.5956 64.5943 42.5957 27.901 92.1851 89.3615 38.8253 4.9492 70.7628 63.2287 75.3471 1.1229 82.6991 7.7969 91.6437 3.7778 87.7062 13.591 28.5822 70.5753 11.6965 67.7413 52.2446 17.6814 81.8294 36.1096 18.6461 50.9957 60.3002 54.2511 0.5906 92.7357 25.9696 49.8378 5.9774 80.2955 38.7941 72.5755 0.0364 27.6074 74.4238 9.9373 27.1666 8.1697 41.5464 61.0191 38.3211 29.2375 11.5819 79.5307 54.8834 35.7099 6.2388 79.6955 57.38 52.8759 12.3743 18.967 75.8337 78.7893 34.0764 62.6044 18.6025 77.4575 73.3475 90.4124 76.7644 16.5664 74.0461 30.2402 51.8664 29.1971 7.2963 68.277 54.0967 90.6163 2.0038 14.871 81.3061 11.1504 11.6647 27.0883 51.5083 32.136 56.0756 97.2462 10.5335 94.2583 43.0244 84.2901 54.9162 38.3619 18.8772 9.0528 58.5118 85.6767 67.3465 46.9184 37.8159 35.4644 10.2451 48.7921 94.1343 51.6227 37.3695 93.4607 54.2652 55.395 33.3267 87.001 50.5749 85.3675 95.7929 22.7643 77.6586 97.4451 53.9987 67.3082 31.4582 24.871 77.374 97.0866 41.4221 27.3604 86.0341 61.2664 53.966 83.2856 64.1871 63.7119 96.2008 56.7719 75.1915 13.1674 61.9034 92.8131 85.587 55.4971 15.2809 46.7752 41.3528 50.2905 80.2838 2.2222 57.619 91.9296 4.7808 18.9172 8.894 51.9191 27.8549 67.5387 66.7995 35.579 12.5734 81.207 38.931 81.0603 35.766 76.044 59.5333 6.9714 5.6118 18.3252 13.8286 68.6976 87.7729 31.1199 23.2576 80.0737 80.7125 81.6997 75.9182 90.6455 59.0362 98.3206 87.459 23.8116 39.657 85.8409 23.9948 60.3403 41.5036 56.899 98.363 5.1083 57.8129 39.5645 32.5221 13.6794 65.564 59.3217 72.8126 89.1047 10.7649 37.1909 45.0075 43.4921 40.8482 78.5911 16.6271 56.0923 51.3403 3.797 63.4219 8.6492 61.3369 62.5071 41.3041 87.1623 7.1799 91.1702 64.7367 57.8429 93.6329 34.2098 46.2944 66.8221 59.3961 95.7686 99.7049 16.7879 78.2758 23.8087 14.1376 69.8879 18.3662 51.5628 28.0258 20.5942 6.0206 66.0558 96.2944 99.914 93.7412 9.4413 73.7929 17.7868 86.2953 4.1905 70.6617 26.5573 2.0434
    ${output}=    Read Until Prompt
    Log    ${output}
    Should Contain X Times    ${output}    === [issueCommand_${component}] writing a command containing :    1
    Should Contain X Times    ${output}    device : target    1
    Should Contain X Times    ${output}    property : lut    1
    Should Contain X Times    ${output}    action :     1
    Should Contain X Times    ${output}    value :     1
    Should Contain X Times    ${output}    xlut : 86.8182    1
    Should Contain X Times    ${output}    ylut : 78.2109    1
    Should Contain X Times    ${output}    zlut : 41.8878    1
    Should Contain X Times    ${output}    ulut : 82.3155    1
    Should Contain X Times    ${output}    vlut : 77.4575    1
    Should Contain X Times    ${output}    wlut : 35.579    1
    Should Contain    ${output}    === command configureLut issued =
    ${CmdComplete}=    Get Line    ${output}    -2
    Should Match Regexp    ${CmdComplete}    (=== \\[waitForCompletion_${component}\\] command )[0-9]+( completed ok :)

Read Controller
    [Tags]    functional
    Switch Connection    Controller
    ${output}=    Read Until    result \ \ : Done : OK
    Log    ${output}
    Should Contain    ${output}    === command configureLut received =
    Should Contain    ${output}    device : target
    Should Contain    ${output}    property : lut
    Should Contain    ${output}    action : 
    Should Contain    ${output}    value : 
    Should Contain X Times    ${output}    xlut : 86.8182    1
    Should Contain X Times    ${output}    ylut : 78.2109    1
    Should Contain X Times    ${output}    zlut : 41.8878    1
    Should Contain X Times    ${output}    ulut : 82.3155    1
    Should Contain X Times    ${output}    vlut : 77.4575    1
    Should Contain X Times    ${output}    wlut : 35.579    1
    Should Contain X Times    ${output}    === [ackCommand_configureLut] acknowledging a command with :    2
    Should Contain    ${output}    seqNum   :
    Should Contain    ${output}    ack      : 301
    Should Contain X Times    ${output}    error \ \ \ : 0    2
    Should Contain    ${output}    result   : Ack : OK
    Should Contain    ${output}    ack      : 303
    Should Contain    ${output}    result   : Done : OK
