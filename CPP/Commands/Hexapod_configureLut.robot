*** Settings ***
Documentation    Hexapod_configureLut commander/controller tests.
Suite Setup    Log Many    ${Host}    ${subSystem}    ${component}    ${timeout}
Suite Teardown    Close All Connections
Library    SSHLibrary
Resource    ../../Global_Vars.robot

*** Variables ***
${subSystem}    hexapod
${component}    configureLut
${timeout}    30s

*** Test Cases ***
Create Commander Session
    [Documentation]    Connect to the SAL host.
    [Tags]    smoke
    Comment    Connect to host.
    Open Connection    host=${Host}    alias=Commander    timeout=${timeout}    prompt=${Prompt}
    Comment    Login.
    Log    ${ContInt}
    Run Keyword If    "${ContInt}"=="false"    Login    ${UserName}    ${PassWord}
    Run Keyword If    "${ContInt}"=="true"    Login With Public Key    ${UserName}    keyfile=${PassWord}
    Directory Should Exist    ${SALInstall}
    Directory Should Exist    ${SALHome}
    Directory Should Exist    ${SALWorkDir}/${subSystem}

Create Controller Session
    [Documentation]    Connect to the SAL host.
    [Tags]    smoke
    Comment    Connect to host.
    Open Connection    host=${Host}    alias=Controller    timeout=${timeout}    prompt=${Prompt}
    Comment    Login.
    Log    ${ContInt}
    Run Keyword If    "${ContInt}"=="false"    Login    ${UserName}    ${PassWord}
    Run Keyword If    "${ContInt}"=="true"    Login With Public Key    ${UserName}    keyfile=${PassWord}
    Directory Should Exist    ${SALInstall}
    Directory Should Exist    ${SALHome}
    Directory Should Exist    ${SALWorkDir}/${subSystem}

Verify Component Commander and Controller
    [Tags]    smoke
    File Should Exist    ${SALWorkDir}/${subSystem}/cpp/src/sacpp_${subSystem}_${component}_commander
    File Should Exist    ${SALWorkDir}/${subSystem}/cpp/src/sacpp_${subSystem}_${component}_controller

Start Commander - Verify Missing Inputs Error
    [Tags]    functional
    Switch Connection    Commander
    Comment    Move to working directory.
    Write    cd ${SALWorkDir}/${subSystem}/cpp/src
    Comment    Start Commander.
    ${input}=    Write    ./sacpp_${subSystem}_${component}_commander 
    ${output}=    Read Until Prompt
    Log    ${output}
    Should Contain    ${output}   Usage :  input parameters...

Start Commander - Verify Timeout without Controller
    [Tags]    functional
    Switch Connection    Commander
    Comment    Move to working directory.
    Write    cd ${SALWorkDir}/${subSystem}/cpp/src
    Comment    Start Commander.
    ${input}=    Write    ./sacpp_${subSystem}_${component}_commander 87.9266 43.6902 81.5686 63.0727 84.9321 36.1269 92.555 23.8555 91.4416 95.9889 45.6017 73.7715 77.806 68.9887 83.9427 37.8449 79.3796 62.6697 24.1656 13.459 7.9609 78.2252 69.2041 62.7472 9.7581 33.1919 37.7076 53.2157 27.4712 80.301 71.5197 89.2661 36.9272 5.3467 74.9895 54.9709 77.501 80.0596 44.1396 94.5977 56.9514 95.0629 7.6853 3.1058 70.8695 81.8257 55.6489 20.0051 94.8539 29.9154 31.4331 23.6275 22.1163 70.8846 53.652 56.2805 2.1346 7.348 99.7962 38.524 25.8615 89.941 92.8071 65.2851 87.1423 38.881 97.4165 61.3371 15.6328 22.6931 67.198 75.3156 18.8481 94.7876 73.2987 96.8796 95.5551 40.1322 83.1895 61.3192 59.1387 67.684 81.9453 6.4868 43.2716 65.7467 25.8392 89.3821 68.5338 32.5037 18.4 53.268 54.0425 18.2959 32.305 76.3975 65.5228 80.6773 51.0121 50.7508 97.5773 72.5857 27.3366 55.9528 49.0713 25.1804 30.3318 50.1138 38.7133 63.6838 27.6713 89.8001 34.2253 53.5641 72.1679 80.9396 99.8893 66.7069 13.8363 79.5669 37.514 98.2004 75.3413 22.2425 95.2282 15.1416 63.6074 8.2291 61.8899 60.8466 48.7919 56.0706 70.5407 69.4867 9.5148 27.0377 16.8747 66.6613 27.5314 96.4033 83.3233 0.692 82.1045 91.5987 44.7546 22.6566 22.5753 28.9158 73.7978 60.3651 61.3073 79.5269 71.0152 80.1273 75.5473 63.1642 20.533 96.5961 86.45 41.3298 33.2837 87.4629 46.9942 5.9461 44.5524 77.0428 72.7401 32.3841 75.3867 89.2692 46.7316 81.8221 71.0589 44.0402 8.8935 97.942 63.3933 87.1275 2.4281 36.4068 99.1458 75.9993 38.7852 90.9699 32.3201 28.3718 14.6216 47.7726 60.5511 21.5859 25.269 64.0297 57.9651 54.0653 72.1369 5.8608 29.5756 62.8648 24.0987 72.2073 89.0888 75.2267 62.5361 67.8855 24.3624 64.3443 13.6739 8.7016 25.3688 36.9601 1.9746 36.651 22.9109 95.0303 42.5465 74.9513 16.2946 31.9329 66.8142 35.7916 28.234 82.3107 30.9254 77.7018 11.4207 79.153 24.5165 82.8185 9.5078 18.6229 55.7973 66.6356 8.4643 78.9648 64.8439 62.0549 17.5154 75.7363 59.189 68.2722 52.7157 79.6242 93.4273 18.4102 78.4537 13.2084 41.5206 61.2174 71.7823 36.237 49.0211 94.5158 15.0336 4.6909 91.7078 66.7953 85.5407 12.6608 66.2539 19.3529 55.2843 61.9903 37.1844 96.3597 74.6686 21.7753 99.7329 2.6607 22.2483 50.0173 46.3728 45.4287 0.7396 78.1482 94.9595 42.577 65.172 93.9407 18.7315 21.1318 9.6874 55.8081 93.71 4.3359 96.0793 33.3761 64.2788 2.9385 61.2464 89.5349 76.6795 7.6983 35.6846 77.0278 60.941 81.6477 36.0787 47.8235 31.8345 90.7222 84.3983 1.795 38.2986 58.2343 39.5 50.9191 86.8042 22.1248 24.4691 78.7711 49.8453 62.7462 4.4113 47.6748 80.8143 17.7889 49.9985 83.7964 77.7029 8.1366 60.6467 23.2623 32.5165 11.8886 18.9236 33.6812 73.153 11.8818 98.4589 70.4338 66.3791 25.0183 15.2949 7.7555 14.5948 59.708 72.672 76.3094 63.5539 83.9966 64.8522 39.6209 23.6218 77.1662 78.2666 39.0488 45.0969 8.9922 2.651 29.4747 29.578 41.2237 90.1025 43.5527 22.5602 88.7317 31.0369 94.154 40.1537 65.5369 92.6558 9.3966 76.0853 17.2761 25.9745 99.8546 0.2084 92.1464 96.7143 70.759 75.2709 72.1557 33.4827 82.183 72.9909 56.5356 51.8633 51.9634 67.96 67.5519 2.0029 97.8478 64.291 40.3528 70.9624 95.946 37.516 18.051 27.3061 58.8026 66.677 81.8443 5.5997 92.0518 19.9164 25.4249 88.7708 57.3439 95.2435 17.0193 72.4876 40.6396 49.9952 76.5008 94.4102 69.9066 54.7768 50.9176 81.8429 79.4479 54.6606 86.837 97.077 99.7843 92.8812 85.2032 2.3169 7.2928 14.8262 82.6076 67.4256 31.6226 41.1869 70.3711 6.6804 85.4245 46.3439 80.1289 71.2833 47.4689 66.9272 20.1278 78.8338 68.3046 57.3371 47.1675 51.5843 17.3437 37.4468 98.7493 98.9807 33.224 75.5753 83.1588 56.768 60.4246 71.0644 86.6381 7.4454 7.1701 39.1225 37.2079 59.7462 24.1412 71.1719 1.1569 44.0468 90.5835 40.6856 20.9861 22.8452 99.7808 38.9937 25.3226 70.2663 37.1087 49.5309 55.5503 17.3993 89.7207 87.6619 65.5621 62.8931 71.5337 48.1866 45.3855 29.5926 67.9557 67.3641 49.0762 88.2511 10.0318 90.8686 53.1977 69.2373 38.8991 62.4145 91.7728 79.0033 63.7805 85.8668 84.7871 0.1271 30.7769 59.1695 3.8952 83.5549 99.8328 98.9525 50.3423 25.8369 40.0188 66.2635 85.0728 27.9473 46.9754 4.3038 57.5533 52.6809 54.2941 42.2613 71.6507 48.1036 26.3765 12.3691 83.0505 32.7609 29.6453 16.6964 48.3986 16.5629 80.2209 15.018 16.3601 66.6055 86.1859 79.4607 58.8518 67.4955 61.1609 19.0143 67.011 16.5931 15.5341 98.9522 50.2537 18.4316 39.7928 78.4925 36.455
    ${output}=    Read Until Prompt
    Log    ${output}
    Should Contain    ${output}    === [waitForCompletion_${component}] command 0 timed out :

Start Controller
    [Tags]    functional
    Switch Connection    Controller
    Comment    Move to working directory.
    Write    cd ${SALWorkDir}/${subSystem}/cpp/src
    Comment    Start Controller.
    ${input}=    Write    ./sacpp_${subSystem}_${component}_controller
    ${output}=    Read Until    controller ready
    Log    ${output}
    Should Contain    ${output}    ${subSystem}_${component} controller ready

Start Commander
    [Tags]    functional
    Switch Connection    Commander
    Comment    Move to working directory.
    Write    cd ${SALWorkDir}/${subSystem}/cpp/src
    Comment    Start Commander.
    ${input}=    Write    ./sacpp_${subSystem}_${component}_commander 87.9266 43.6902 81.5686 63.0727 84.9321 36.1269 92.555 23.8555 91.4416 95.9889 45.6017 73.7715 77.806 68.9887 83.9427 37.8449 79.3796 62.6697 24.1656 13.459 7.9609 78.2252 69.2041 62.7472 9.7581 33.1919 37.7076 53.2157 27.4712 80.301 71.5197 89.2661 36.9272 5.3467 74.9895 54.9709 77.501 80.0596 44.1396 94.5977 56.9514 95.0629 7.6853 3.1058 70.8695 81.8257 55.6489 20.0051 94.8539 29.9154 31.4331 23.6275 22.1163 70.8846 53.652 56.2805 2.1346 7.348 99.7962 38.524 25.8615 89.941 92.8071 65.2851 87.1423 38.881 97.4165 61.3371 15.6328 22.6931 67.198 75.3156 18.8481 94.7876 73.2987 96.8796 95.5551 40.1322 83.1895 61.3192 59.1387 67.684 81.9453 6.4868 43.2716 65.7467 25.8392 89.3821 68.5338 32.5037 18.4 53.268 54.0425 18.2959 32.305 76.3975 65.5228 80.6773 51.0121 50.7508 97.5773 72.5857 27.3366 55.9528 49.0713 25.1804 30.3318 50.1138 38.7133 63.6838 27.6713 89.8001 34.2253 53.5641 72.1679 80.9396 99.8893 66.7069 13.8363 79.5669 37.514 98.2004 75.3413 22.2425 95.2282 15.1416 63.6074 8.2291 61.8899 60.8466 48.7919 56.0706 70.5407 69.4867 9.5148 27.0377 16.8747 66.6613 27.5314 96.4033 83.3233 0.692 82.1045 91.5987 44.7546 22.6566 22.5753 28.9158 73.7978 60.3651 61.3073 79.5269 71.0152 80.1273 75.5473 63.1642 20.533 96.5961 86.45 41.3298 33.2837 87.4629 46.9942 5.9461 44.5524 77.0428 72.7401 32.3841 75.3867 89.2692 46.7316 81.8221 71.0589 44.0402 8.8935 97.942 63.3933 87.1275 2.4281 36.4068 99.1458 75.9993 38.7852 90.9699 32.3201 28.3718 14.6216 47.7726 60.5511 21.5859 25.269 64.0297 57.9651 54.0653 72.1369 5.8608 29.5756 62.8648 24.0987 72.2073 89.0888 75.2267 62.5361 67.8855 24.3624 64.3443 13.6739 8.7016 25.3688 36.9601 1.9746 36.651 22.9109 95.0303 42.5465 74.9513 16.2946 31.9329 66.8142 35.7916 28.234 82.3107 30.9254 77.7018 11.4207 79.153 24.5165 82.8185 9.5078 18.6229 55.7973 66.6356 8.4643 78.9648 64.8439 62.0549 17.5154 75.7363 59.189 68.2722 52.7157 79.6242 93.4273 18.4102 78.4537 13.2084 41.5206 61.2174 71.7823 36.237 49.0211 94.5158 15.0336 4.6909 91.7078 66.7953 85.5407 12.6608 66.2539 19.3529 55.2843 61.9903 37.1844 96.3597 74.6686 21.7753 99.7329 2.6607 22.2483 50.0173 46.3728 45.4287 0.7396 78.1482 94.9595 42.577 65.172 93.9407 18.7315 21.1318 9.6874 55.8081 93.71 4.3359 96.0793 33.3761 64.2788 2.9385 61.2464 89.5349 76.6795 7.6983 35.6846 77.0278 60.941 81.6477 36.0787 47.8235 31.8345 90.7222 84.3983 1.795 38.2986 58.2343 39.5 50.9191 86.8042 22.1248 24.4691 78.7711 49.8453 62.7462 4.4113 47.6748 80.8143 17.7889 49.9985 83.7964 77.7029 8.1366 60.6467 23.2623 32.5165 11.8886 18.9236 33.6812 73.153 11.8818 98.4589 70.4338 66.3791 25.0183 15.2949 7.7555 14.5948 59.708 72.672 76.3094 63.5539 83.9966 64.8522 39.6209 23.6218 77.1662 78.2666 39.0488 45.0969 8.9922 2.651 29.4747 29.578 41.2237 90.1025 43.5527 22.5602 88.7317 31.0369 94.154 40.1537 65.5369 92.6558 9.3966 76.0853 17.2761 25.9745 99.8546 0.2084 92.1464 96.7143 70.759 75.2709 72.1557 33.4827 82.183 72.9909 56.5356 51.8633 51.9634 67.96 67.5519 2.0029 97.8478 64.291 40.3528 70.9624 95.946 37.516 18.051 27.3061 58.8026 66.677 81.8443 5.5997 92.0518 19.9164 25.4249 88.7708 57.3439 95.2435 17.0193 72.4876 40.6396 49.9952 76.5008 94.4102 69.9066 54.7768 50.9176 81.8429 79.4479 54.6606 86.837 97.077 99.7843 92.8812 85.2032 2.3169 7.2928 14.8262 82.6076 67.4256 31.6226 41.1869 70.3711 6.6804 85.4245 46.3439 80.1289 71.2833 47.4689 66.9272 20.1278 78.8338 68.3046 57.3371 47.1675 51.5843 17.3437 37.4468 98.7493 98.9807 33.224 75.5753 83.1588 56.768 60.4246 71.0644 86.6381 7.4454 7.1701 39.1225 37.2079 59.7462 24.1412 71.1719 1.1569 44.0468 90.5835 40.6856 20.9861 22.8452 99.7808 38.9937 25.3226 70.2663 37.1087 49.5309 55.5503 17.3993 89.7207 87.6619 65.5621 62.8931 71.5337 48.1866 45.3855 29.5926 67.9557 67.3641 49.0762 88.2511 10.0318 90.8686 53.1977 69.2373 38.8991 62.4145 91.7728 79.0033 63.7805 85.8668 84.7871 0.1271 30.7769 59.1695 3.8952 83.5549 99.8328 98.9525 50.3423 25.8369 40.0188 66.2635 85.0728 27.9473 46.9754 4.3038 57.5533 52.6809 54.2941 42.2613 71.6507 48.1036 26.3765 12.3691 83.0505 32.7609 29.6453 16.6964 48.3986 16.5629 80.2209 15.018 16.3601 66.6055 86.1859 79.4607 58.8518 67.4955 61.1609 19.0143 67.011 16.5931 15.5341 98.9522 50.2537 18.4316 39.7928 78.4925 36.455
    ${output}=    Read Until Prompt
    Log    ${output}
    Should Contain X Times    ${output}    === [issueCommand_${component}] writing a command containing :    1
    Should Contain X Times    ${output}    device : target    1
    Should Contain X Times    ${output}    property : lut    1
    Should Contain X Times    ${output}    action :     1
    Should Contain X Times    ${output}    value :     1
    Should Contain X Times    ${output}    xlut : 87.9266    1
    Should Contain X Times    ${output}    ylut : 43.6902    1
    Should Contain X Times    ${output}    zlut : 81.5686    1
    Should Contain X Times    ${output}    ulut : 63.0727    1
    Should Contain X Times    ${output}    vlut : 84.9321    1
    Should Contain X Times    ${output}    wlut : 36.1269    1
    Should Contain    ${output}    === command configureLut issued =
    Should Contain    ${output}    === [waitForCompletion_${component}] command 0 completed ok :

Read Controller
    [Tags]    functional
    Switch Connection    Controller
    ${output}=    Read Until    result \ \ : Done : OK
    Log    ${output}
    Should Contain    ${output}    === command configureLut received =
    Should Contain    ${output}    device : target
    Should Contain    ${output}    property : lut
    Should Contain    ${output}    action : 
    Should Contain    ${output}    value : 
    Should Contain X Times    ${output}    xlut : 87.9266    1
    Should Contain X Times    ${output}    ylut : 18.4    1
    Should Contain X Times    ${output}    zlut : 99.1458    1
    Should Contain X Times    ${output}    ulut : 46.3728    1
    Should Contain X Times    ${output}    vlut : 92.6558    1
    Should Contain X Times    ${output}    wlut : 39.1225    1
    Should Contain X Times    ${output}    === [ackCommand_configureLut] acknowledging a command with :    2
    Should Contain    ${output}    seqNum   :
    Should Contain    ${output}    ack      : 301
    Should Contain X Times    ${output}    error \ \ \ : 0    2
    Should Contain    ${output}    result   : Ack : OK
    Should Contain    ${output}    ack      : 303
    Should Contain    ${output}    result   : Done : OK
