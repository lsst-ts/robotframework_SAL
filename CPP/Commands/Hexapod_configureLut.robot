*** Settings ***
Documentation    Hexapod_configureLut commander/controller tests.
Force Tags    cpp
Suite Setup    Log Many    ${Host}    ${subSystem}    ${component}    ${timeout}
Suite Teardown    Close All Connections
Library    SSHLibrary
Library    String
Resource    ../../Global_Vars.robot

*** Variables ***
${subSystem}    hexapod
${component}    configureLut
${timeout}    30s

*** Test Cases ***
Create Commander Session
    [Documentation]    Connect to the SAL host.
    [Tags]    smoke
    Comment    Connect to host.
    Open Connection    host=${Host}    alias=Commander    timeout=${timeout}    prompt=${Prompt}
    Comment    Login.
    Log    ${ContInt}
    Login With Public Key    ${UserName}    keyfile=${KeyFile}    password=${PassWord}
    Directory Should Exist    ${SALInstall}
    Directory Should Exist    ${SALHome}

Create Controller Session
    [Documentation]    Connect to the SAL host.
    [Tags]    smoke
    Comment    Connect to host.
    Open Connection    host=${Host}    alias=Controller    timeout=${timeout}    prompt=${Prompt}
    Comment    Login.
    Log    ${ContInt}
    Login With Public Key    ${UserName}    keyfile=${KeyFile}    password=${PassWord}
    Directory Should Exist    ${SALInstall}
    Directory Should Exist    ${SALHome}

Verify Component Commander and Controller
    [Tags]    smoke
    File Should Exist    ${SALWorkDir}/${subSystem}/cpp/src/sacpp_${subSystem}_${component}_commander
    File Should Exist    ${SALWorkDir}/${subSystem}/cpp/src/sacpp_${subSystem}_${component}_controller

Start Commander - Verify Missing Inputs Error
    [Tags]    functional
    Switch Connection    Commander
    Comment    Move to working directory.
    Write    cd ${SALWorkDir}/${subSystem}/cpp/src
    Comment    Start Commander.
    ${input}=    Write    ./sacpp_${subSystem}_${component}_commander 
    ${output}=    Read Until Prompt
    Log    ${output}
    Should Contain    ${output}   Usage : \ input parameters...

Start Commander - Verify Timeout without Controller
    [Tags]    functional
    Switch Connection    Commander
    Comment    Move to working directory.
    Write    cd ${SALWorkDir}/${subSystem}/cpp/src
    Comment    Start Commander.
    ${input}=    Write    ./sacpp_${subSystem}_${component}_commander 80.4291 19.9348 56.6152 11.248 93.5791 20.0345 78.3959 5.0198 25.2643 60.6965 93.3842 76.2277 7.205 19.9818 39.3906 69.3254 19.3854 78.3783 5.9863 70.3006 91.0074 62.1914 19.6981 91.1651 31.5988 76.7282 42.845 82.9558 64.1133 1.6141 36.9522 21.0232 98.1863 40.4649 16.3188 77.0096 76.0841 73.482 76.6085 84.621 15.7612 25.6326 59.0857 66.22 32.8943 93.6939 36.2191 3.6489 69.0936 4.6414 96.5029 7.0674 88.5118 57.671 78.0305 0.715 18.7861 6.8682 72.3842 73.7784 81.1264 27.4805 70.7307 68.9184 47.4209 19.7743 95.7942 70.0698 57.052 46.4763 9.2342 97.7205 77.9882 55.9272 27.8089 98.6054 39.3823 57.7188 9.4395 87.2855 70.4938 47.3944 3.3175 79.7062 85.0398 13.3566 9.382 39.7955 27.6473 63.7439 6.2381 7.4695 43.5634 2.5443 99.0661 42.2049 40.0568 49.3302 47.095 8.3067 58.0968 27.6525 85.2143 10.1432 67.8469 60.3278 19.7703 41.1612 33.7027 6.1355 70.4286 99.8917 20.2994 52.2583 91.0735 16.3615 68.2546 52.879 27.4712 59.6347 27.5593 89.4147 8.4084 31.7523 16.5007 79.0471 43.0887 56.161 54.1006 66.8238 7.5425 93.9572 54.2144 84.8703 13.6977 12.418 9.0013 56.8905 77.2358 26.2804 26.5913 31.0176 61.614 63.0248 65.5035 69.585 20.432 18.4459 78.1556 11.3464 0.8922 42.2471 34.6134 7.3115 39.9858 78.4784 22.3139 88.4734 7.615 86.2197 74.7212 53.0137 8.0833 95.2977 53.7862 20.048 75.8534 26.572 5.8208 41.3224 18.3582 16.6425 56.167 38.4022 46.4686 86.4698 30.7991 44.4449 50.3834 88.1648 56.8653 15.0182 89.1104 71.3914 50.4118 80.8929 26.3177 22.9334 50.832 51.6906 9.7339 97.4354 35.3215 10.3743 17.5816 98.6291 70.6455 59.6317 43.543 20.939 91.169 11.0315 48.5528 7.6203 48.205 87.4514 13.3418 12.8082 18.7716 14.4764 28.6556 13.0647 9.5716 56.8274 26.0491 43.8162 39.1344 12.0991 53.703 27.9311 6.028 74.5527 68.4868 22.6143 23.7394 31.1299 94.8777 22.9336 70.6672 0.2762 79.5242 91.3008 32.6464 18.8942 91.9204 48.6405 91.3645 58.5251 79.7099 61.5952 38.7921 26.6459 11.3367 19.2054 60.7927 15.3971 38.5809 1.6522 87.7053 85.7056 43.7687 41.8303 36.5034 69.0717 75.8395 93.1274 91.8836 39.1747 71.8446 37.3012 55.201 45.6343 65.4192 58.2922 36.1757 9.428 30.5405 59.1459 98.287 11.8521 56.0411 91.9039 81.9001 89.6017 69.6765 79.2448 19.5184 19.5261 77.5935 38.5256 9.3826 65.5633 13.976 46.1641 93.0589 14.0299 22.238 0.4438 37.8362 50.7716 51.3364 54.8288 4.496 67.6534 2.2157 24.5677 18.0124 99.3168 26.8103 46.2712 67.9055 18.9818 32.8361 49.384 71.3115 42.4735 82.2253 73.5998 39.9755 73.482 81.9298 23.4011 54.707 52.1918 32.1553 10.1236 52.2064 4.8542 45.8343 31.0816 21.9198 2.704 20.3797 99.3615 64.7215 45.9799 17.9592 46.6587 21.2003 0.3857 16.7056 47.7365 21.6224 9.3525 77.7465 47.2104 44.7175 58.157 25.9343 38.8993 3.0414 66.3564 30.7206 62.1443 32.598 9.3752 60.2849 84.8153 23.936 51.8165 64.4506 59.94 18.3859 85.1017 26.0056 89.8119 68.9479 43.9514 20.4112 88.8236 34.5697 41.3498 70.3878 12.6173 37.3523 13.3245 66.9989 53.6064 68.3022 22.5403 18.8096 82.0094 90.4813 62.3742 60.2145 92.7084 54.4499 20.1228 28.0777 68.8897 97.3802 6.4465 13.6358 41.6554 18.8837 80.1784 53.2564 72.8148 23.4928 88.6968 54.0446 44.3995 56.3171 80.3277 68.7939 27.4811 88.7865 0.4041 17.9121 32.5747 22.7257 31.5982 97.4676 71.7793 40.3672 59.1301 15.3093 78.581 55.6626 49.6844 32.9013 76.4156 43.913 12.2257 24.3666 13.7248 22.5517 74.9237 51.8953 47.6265 54.7591 49.1834 2.0773 43.731 34.1522 13.994 52.5242 2.7779 1.427 97.1085 33.0797 57.5846 71.0241 73.0154 91.5507 21.7598 58.2071 78.7641 53.7237 92.4609 54.8835 53.3948 56.2776 21.8828 96.0047 2.7164 65.4843 48.1928 37.94 36.7306 94.2635 34.218 48.7271 23.4822 27.1224 2.3438 75.4576 0.8812 26.2723 35.0521 53.0692 65.7729 19.3231 62.5626 23.2411 43.5451 42.6538 22.9999 48.3551 94.0502 35.146 27.5445 98.1779 8.0874 23.621 3.7247 37.2428 29.6027 27.4147 31.5567 0.7665 71.474 49.102 7.8775 31.4932 13.834 11.8773 66.369 68.3096 71.6697 81.3653 10.085 45.5746 18.7599 38.5811 45.0529 27.8015 33.1592 41.0546 67.2483 78.4877 38.2938 69.7237 51.7469 62.6393 83.4711 30.5541 94.3967 94.3443 79.3377 40.3223 8.2672 34.7881 61.2626 32.3489 1.6437 80.7416 35.3832 16.3009 1.0044 54.0497 90.5731 27.4383 73.4313 72.7469 68.3487 37.1183 3.5089 75.4026 2.2872 27.7974 85.8193 42.1834 33.0225 22.2834 12.8925 25.2688 6.8074 48.4628 78.0202
    ${output}=    Read Until Prompt
    Log    ${output}
    ${CmdComplete}=    Get Line    ${output}    -2
    Should Match Regexp    ${CmdComplete}    (=== \\[waitForCompletion_${component}\\] command )[0-9]+( timed out :)

Start Controller
    [Tags]    functional
    Switch Connection    Controller
    Comment    Move to working directory.
    Write    cd ${SALWorkDir}/${subSystem}/cpp/src
    Comment    Start Controller.
    ${input}=    Write    ./sacpp_${subSystem}_${component}_controller
    ${output}=    Read Until    controller ready
    Log    ${output}
    Should Contain    ${output}    ${subSystem}_${component} controller ready

Start Commander
    [Tags]    functional
    Switch Connection    Commander
    Comment    Move to working directory.
    Write    cd ${SALWorkDir}/${subSystem}/cpp/src
    Comment    Start Commander.
    ${input}=    Write    ./sacpp_${subSystem}_${component}_commander 80.4291 19.9348 56.6152 11.248 93.5791 20.0345 78.3959 5.0198 25.2643 60.6965 93.3842 76.2277 7.205 19.9818 39.3906 69.3254 19.3854 78.3783 5.9863 70.3006 91.0074 62.1914 19.6981 91.1651 31.5988 76.7282 42.845 82.9558 64.1133 1.6141 36.9522 21.0232 98.1863 40.4649 16.3188 77.0096 76.0841 73.482 76.6085 84.621 15.7612 25.6326 59.0857 66.22 32.8943 93.6939 36.2191 3.6489 69.0936 4.6414 96.5029 7.0674 88.5118 57.671 78.0305 0.715 18.7861 6.8682 72.3842 73.7784 81.1264 27.4805 70.7307 68.9184 47.4209 19.7743 95.7942 70.0698 57.052 46.4763 9.2342 97.7205 77.9882 55.9272 27.8089 98.6054 39.3823 57.7188 9.4395 87.2855 70.4938 47.3944 3.3175 79.7062 85.0398 13.3566 9.382 39.7955 27.6473 63.7439 6.2381 7.4695 43.5634 2.5443 99.0661 42.2049 40.0568 49.3302 47.095 8.3067 58.0968 27.6525 85.2143 10.1432 67.8469 60.3278 19.7703 41.1612 33.7027 6.1355 70.4286 99.8917 20.2994 52.2583 91.0735 16.3615 68.2546 52.879 27.4712 59.6347 27.5593 89.4147 8.4084 31.7523 16.5007 79.0471 43.0887 56.161 54.1006 66.8238 7.5425 93.9572 54.2144 84.8703 13.6977 12.418 9.0013 56.8905 77.2358 26.2804 26.5913 31.0176 61.614 63.0248 65.5035 69.585 20.432 18.4459 78.1556 11.3464 0.8922 42.2471 34.6134 7.3115 39.9858 78.4784 22.3139 88.4734 7.615 86.2197 74.7212 53.0137 8.0833 95.2977 53.7862 20.048 75.8534 26.572 5.8208 41.3224 18.3582 16.6425 56.167 38.4022 46.4686 86.4698 30.7991 44.4449 50.3834 88.1648 56.8653 15.0182 89.1104 71.3914 50.4118 80.8929 26.3177 22.9334 50.832 51.6906 9.7339 97.4354 35.3215 10.3743 17.5816 98.6291 70.6455 59.6317 43.543 20.939 91.169 11.0315 48.5528 7.6203 48.205 87.4514 13.3418 12.8082 18.7716 14.4764 28.6556 13.0647 9.5716 56.8274 26.0491 43.8162 39.1344 12.0991 53.703 27.9311 6.028 74.5527 68.4868 22.6143 23.7394 31.1299 94.8777 22.9336 70.6672 0.2762 79.5242 91.3008 32.6464 18.8942 91.9204 48.6405 91.3645 58.5251 79.7099 61.5952 38.7921 26.6459 11.3367 19.2054 60.7927 15.3971 38.5809 1.6522 87.7053 85.7056 43.7687 41.8303 36.5034 69.0717 75.8395 93.1274 91.8836 39.1747 71.8446 37.3012 55.201 45.6343 65.4192 58.2922 36.1757 9.428 30.5405 59.1459 98.287 11.8521 56.0411 91.9039 81.9001 89.6017 69.6765 79.2448 19.5184 19.5261 77.5935 38.5256 9.3826 65.5633 13.976 46.1641 93.0589 14.0299 22.238 0.4438 37.8362 50.7716 51.3364 54.8288 4.496 67.6534 2.2157 24.5677 18.0124 99.3168 26.8103 46.2712 67.9055 18.9818 32.8361 49.384 71.3115 42.4735 82.2253 73.5998 39.9755 73.482 81.9298 23.4011 54.707 52.1918 32.1553 10.1236 52.2064 4.8542 45.8343 31.0816 21.9198 2.704 20.3797 99.3615 64.7215 45.9799 17.9592 46.6587 21.2003 0.3857 16.7056 47.7365 21.6224 9.3525 77.7465 47.2104 44.7175 58.157 25.9343 38.8993 3.0414 66.3564 30.7206 62.1443 32.598 9.3752 60.2849 84.8153 23.936 51.8165 64.4506 59.94 18.3859 85.1017 26.0056 89.8119 68.9479 43.9514 20.4112 88.8236 34.5697 41.3498 70.3878 12.6173 37.3523 13.3245 66.9989 53.6064 68.3022 22.5403 18.8096 82.0094 90.4813 62.3742 60.2145 92.7084 54.4499 20.1228 28.0777 68.8897 97.3802 6.4465 13.6358 41.6554 18.8837 80.1784 53.2564 72.8148 23.4928 88.6968 54.0446 44.3995 56.3171 80.3277 68.7939 27.4811 88.7865 0.4041 17.9121 32.5747 22.7257 31.5982 97.4676 71.7793 40.3672 59.1301 15.3093 78.581 55.6626 49.6844 32.9013 76.4156 43.913 12.2257 24.3666 13.7248 22.5517 74.9237 51.8953 47.6265 54.7591 49.1834 2.0773 43.731 34.1522 13.994 52.5242 2.7779 1.427 97.1085 33.0797 57.5846 71.0241 73.0154 91.5507 21.7598 58.2071 78.7641 53.7237 92.4609 54.8835 53.3948 56.2776 21.8828 96.0047 2.7164 65.4843 48.1928 37.94 36.7306 94.2635 34.218 48.7271 23.4822 27.1224 2.3438 75.4576 0.8812 26.2723 35.0521 53.0692 65.7729 19.3231 62.5626 23.2411 43.5451 42.6538 22.9999 48.3551 94.0502 35.146 27.5445 98.1779 8.0874 23.621 3.7247 37.2428 29.6027 27.4147 31.5567 0.7665 71.474 49.102 7.8775 31.4932 13.834 11.8773 66.369 68.3096 71.6697 81.3653 10.085 45.5746 18.7599 38.5811 45.0529 27.8015 33.1592 41.0546 67.2483 78.4877 38.2938 69.7237 51.7469 62.6393 83.4711 30.5541 94.3967 94.3443 79.3377 40.3223 8.2672 34.7881 61.2626 32.3489 1.6437 80.7416 35.3832 16.3009 1.0044 54.0497 90.5731 27.4383 73.4313 72.7469 68.3487 37.1183 3.5089 75.4026 2.2872 27.7974 85.8193 42.1834 33.0225 22.2834 12.8925 25.2688 6.8074 48.4628 78.0202
    ${output}=    Read Until Prompt
    Log    ${output}
    Should Contain X Times    ${output}    === [issueCommand_${component}] writing a command containing :    1
    Should Contain X Times    ${output}    device : target    1
    Should Contain X Times    ${output}    property : lut    1
    Should Contain X Times    ${output}    action :     1
    Should Contain X Times    ${output}    value :     1
    Should Contain X Times    ${output}    xlut : 80.4291    1
    Should Contain X Times    ${output}    ylut : 6.2381    1
    Should Contain X Times    ${output}    zlut : 56.8653    1
    Should Contain X Times    ${output}    ulut : 56.0411    1
    Should Contain X Times    ${output}    vlut : 34.5697    1
    Should Contain X Times    ${output}    wlut : 94.2635    1
    Should Contain    ${output}    === command configureLut issued =
    ${CmdComplete}=    Get Line    ${output}    -2
    Should Match Regexp    ${CmdComplete}    (=== \\[waitForCompletion_${component}\\] command )[0-9]+( completed ok :)

Read Controller
    [Tags]    functional
    Switch Connection    Controller
    ${output}=    Read Until    result \ \ : Done : OK
    Log    ${output}
    Should Contain    ${output}    === command configureLut received =
    Should Contain    ${output}    device : target
    Should Contain    ${output}    property : lut
    Should Contain    ${output}    action : 
    Should Contain    ${output}    value : 
    Should Contain X Times    ${output}    xlut : 80.4291    1
    Should Contain X Times    ${output}    ylut : 6.2381    1
    Should Contain X Times    ${output}    zlut : 56.8653    1
    Should Contain X Times    ${output}    ulut : 56.0411    1
    Should Contain X Times    ${output}    vlut : 34.5697    1
    Should Contain X Times    ${output}    wlut : 94.2635    1
    Should Contain X Times    ${output}    === [ackCommand_configureLut] acknowledging a command with :    2
    Should Contain    ${output}    seqNum   :
    Should Contain    ${output}    ack      : 301
    Should Contain X Times    ${output}    error \ \ \ : 0    2
    Should Contain    ${output}    result   : Ack : OK
    Should Contain    ${output}    ack      : 303
    Should Contain    ${output}    result   : Done : OK
