*** Settings ***
Documentation    Hexapod_configureLut commander/controller tests.
Suite Setup    Log Many    ${Host}    ${subSystem}    ${component}    ${timeout}
Suite Teardown    Close All Connections
Library    SSHLibrary
Library    String
Resource    ../../Global_Vars.robot

*** Variables ***
${subSystem}    hexapod
${component}    configureLut
${timeout}    30s

*** Test Cases ***
Create Commander Session
    [Documentation]    Connect to the SAL host.
    [Tags]    smoke
    Comment    Connect to host.
    Open Connection    host=${Host}    alias=Commander    timeout=${timeout}    prompt=${Prompt}
    Comment    Login.
    Log    ${ContInt}
    Login With Public Key    ${UserName}    keyfile=${KeyFile}    password=${PassWord}
    Directory Should Exist    ${SALInstall}
    Directory Should Exist    ${SALHome}

Create Controller Session
    [Documentation]    Connect to the SAL host.
    [Tags]    smoke
    Comment    Connect to host.
    Open Connection    host=${Host}    alias=Controller    timeout=${timeout}    prompt=${Prompt}
    Comment    Login.
    Log    ${ContInt}
    Login With Public Key    ${UserName}    keyfile=${KeyFile}    password=${PassWord}
    Directory Should Exist    ${SALInstall}
    Directory Should Exist    ${SALHome}

Verify Component Commander and Controller
    [Tags]    smoke
    File Should Exist    ${SALWorkDir}/${subSystem}/cpp/src/sacpp_${subSystem}_${component}_commander
    File Should Exist    ${SALWorkDir}/${subSystem}/cpp/src/sacpp_${subSystem}_${component}_controller

Start Commander - Verify Missing Inputs Error
    [Tags]    functional
    Switch Connection    Commander
    Comment    Move to working directory.
    Write    cd ${SALWorkDir}/${subSystem}/cpp/src
    Comment    Start Commander.
    ${input}=    Write    ./sacpp_${subSystem}_${component}_commander 
    ${output}=    Read Until Prompt
    Log    ${output}
    Should Contain    ${output}   Usage : \ input parameters...

Start Commander - Verify Timeout without Controller
    [Tags]    functional
    Switch Connection    Commander
    Comment    Move to working directory.
    Write    cd ${SALWorkDir}/${subSystem}/cpp/src
    Comment    Start Commander.
    ${input}=    Write    ./sacpp_${subSystem}_${component}_commander 41.5744 26.5173 79.5948 13.6054 68.4917 91.94 42.0997 14.8569 13.744 28.6721 17.448 93.2232 22.554 19.1425 61.7212 91.2915 24.8707 13.7185 85.0345 85.513 27.0415 60.7951 22.0034 2.2758 60.3694 13.8619 16.7903 96.3396 11.4417 13.8973 64.0531 64.3299 64.4683 36.372 8.3261 14.415 76.2958 18.921 49.5774 48.3949 13.1059 27.7398 17.7296 49.9708 64.5392 35.9978 19.0154 21.6834 52.7945 27.3097 12.8078 58.0297 65.069 65.9785 86.3659 93.938 67.4466 30.1877 57.1234 83.6509 72.2738 38.2766 14.9799 57.3006 11.1611 86.2421 82.1742 62.032 23.9998 10.3402 62.523 94.9949 83.3987 17.5811 35.6559 78.3024 91.1271 16.2202 64.8015 84.3801 5.1482 92.9552 94.0986 46.4379 38.7688 45.8646 46.3122 75.5824 53.8257 81.2124 94.7924 75.2474 49.9656 37.2675 2.6665 95.1325 42.9227 47.9295 46.0788 41.0171 73.0327 3.4911 25.9911 63.2356 79.9172 34.0789 99.1662 95.9991 32.9236 75.2963 56.5338 83.3049 32.0717 13.2672 74.7852 28.1778 68.0305 11.1617 50.0599 61.8143 81.783 26.4916 41.6593 89.2977 39.5503 59.0004 63.3553 64.1477 69.843 4.1206 2.9718 11.8131 38.5519 43.1467 98.6033 75.5764 40.742 71.7442 63.5485 23.1451 65.0041 97.5215 90.9362 22.7643 79.4268 62.6708 44.2297 81.4649 13.0423 94.0919 56.3951 97.8189 83.2167 59.2236 86.1752 92.7015 75.8628 5.0773 69.0092 56.7288 36.2158 81.3115 41.836 43.9689 6.2378 64.5138 96.3405 78.6838 62.9485 15.5811 73.2367 49.7722 26.4951 60.4736 58.2205 4.9845 86.6355 71.7861 31.5016 47.1877 88.743 58.5314 93.7063 8.0646 87.3743 12.4367 81.6865 99.8508 93.8887 51.8805 20.3249 91.979 75.5941 26.2409 35.4437 51.3147 97.8217 19.1967 32.2636 58.5201 6.3807 95.6343 97.3863 71.8277 62.936 80.7951 6.1453 33.5137 75.2092 43.7455 40.7679 38.4134 99.2072 70.8025 83.3562 94.9542 95.0857 91.13 16.3445 36.4279 22.8437 98.6872 8.5159 87.1111 45.591 43.667 40.1265 76.9499 27.0474 50.2405 54.8944 54.7779 35.2432 82.4133 43.3612 97.8132 52.9115 74.3495 21.2289 98.576 6.9846 5.5691 20.1073 7.5398 98.0818 71.5481 92.0827 38.2527 31.6948 14.5201 2.0101 11.391 34.4609 49.8715 66.4891 45.5435 41.4349 82.8424 81.0961 84.505 25.6759 40.4381 69.9884 59.5524 10.6798 8.5535 24.6268 78.8229 54.7231 95.2953 69.7656 24.851 35.9478 7.1393 48.2189 73.1725 58.1484 80.5974 46.843 14.3136 46.2644 62.1011 33.3083 86.4375 39.3913 82.8864 1.9364 26.6721 3.9338 66.4738 22.6 9.1065 8.6505 68.0627 27.1741 38.9614 64.1186 46.0361 74.4041 55.9073 10.2504 69.7759 79.0828 99.4341 24.9029 60.0233 28.3954 24.8495 3.3882 25.079 73.0098 83.7265 67.3958 84.3229 43.1857 68.9612 5.4455 36.0336 36.9409 5.2861 87.5477 82.9442 38.9141 22.0856 70.206 99.2887 34.305 84.8972 11.1345 25.7121 20.4488 1.826 90.9728 75.5881 60.5516 19.5466 86.3897 5.9308 7.7671 61.2688 0.276 81.337 14.8217 54.4906 28.942 9.402 72.6236 25.136 85.7076 84.6107 88.6731 52.1994 97.0812 41.1994 64.9938 27.7888 99.8082 98.7455 40.412 36.5105 15.4473 91.6214 4.5572 96.9854 13.8248 55.7673 7.3231 57.3362 7.4139 27.511 93.1695 4.2032 57.8371 22.834 69.2535 30.9911 83.2462 98.0818 5.6117 60.5637 40.8065 0.6807 17.7162 93.7854 82.3994 18.1009 70.8766 4.6109 80.181 63.7697 7.7129 10.3852 14.3445 22.6865 80.9174 66.6327 76.0649 78.9079 64.3261 46.1883 42.4082 82.3397 28.9544 3.5415 48.6084 7.9922 54.7408 76.9256 22.633 83.0234 27.5314 11.2843 99.7945 80.8354 85.9654 42.4553 74.3413 20.3867 38.6604 3.6008 24.6553 87.6957 47.3671 73.4223 74.4597 71.4706 78.1532 6.6701 56.664 17.2153 32.3868 58.6866 20.7389 50.4327 47.2793 72.0034 9.7079 55.9095 89.0917 37.6712 19.8095 78.4875 38.3215 41.6407 38.7091 30.898 81.8088 20.5909 35.5646 46.9965 29.2429 9.6442 12.5441 5.0399 81.7636 56.0597 2.9951 31.1871 71.2131 43.4735 76.2081 59.8825 74.4273 85.4837 3.105 34.6187 34.5698 17.7866 20.5393 18.1434 33.1756 59.5086 46.7809 34.4835 51.6788 22.1632 64.1119 55.2884 38.893 74.294 41.4153 13.6101 39.6812 4.0382 39.7154 40.5351 29.1158 20.8701 82.1591 76.5075 77.4396 83.9418 15.5321 59.1016 97.3689 15.5386 92.3414 40.1676 82.5655 92.576 97.1486 73.1903 28.708 77.65 48.4078 57.561 89.5719 18.0932 99.2396 65.7583 21.464 35.6539 92.0258 51.5052 27.0792 34.9165 26.8107 85.7529 43.1154 67.3797 0.2563 33.0013 29.9435 88.6486 98.9402 64.2067 51.6477 89.387 6.3544 16.3904 97.9109 8.5752 81.2761 55.8477 87.6038 78.6541 35.58 24.5411 61.6178 44.0671
    ${output}=    Read Until Prompt
    Log    ${output}
    ${CmdComplete}=    Get Line    ${output}    -2
    Should Match Regexp    ${CmdComplete}    (=== \\[waitForCompletion_${component}\\] command )[0-9]+( timed out :)

Start Controller
    [Tags]    functional
    Switch Connection    Controller
    Comment    Move to working directory.
    Write    cd ${SALWorkDir}/${subSystem}/cpp/src
    Comment    Start Controller.
    ${input}=    Write    ./sacpp_${subSystem}_${component}_controller
    ${output}=    Read Until    controller ready
    Log    ${output}
    Should Contain    ${output}    ${subSystem}_${component} controller ready

Start Commander
    [Tags]    functional
    Switch Connection    Commander
    Comment    Move to working directory.
    Write    cd ${SALWorkDir}/${subSystem}/cpp/src
    Comment    Start Commander.
    ${input}=    Write    ./sacpp_${subSystem}_${component}_commander 41.5744 26.5173 79.5948 13.6054 68.4917 91.94 42.0997 14.8569 13.744 28.6721 17.448 93.2232 22.554 19.1425 61.7212 91.2915 24.8707 13.7185 85.0345 85.513 27.0415 60.7951 22.0034 2.2758 60.3694 13.8619 16.7903 96.3396 11.4417 13.8973 64.0531 64.3299 64.4683 36.372 8.3261 14.415 76.2958 18.921 49.5774 48.3949 13.1059 27.7398 17.7296 49.9708 64.5392 35.9978 19.0154 21.6834 52.7945 27.3097 12.8078 58.0297 65.069 65.9785 86.3659 93.938 67.4466 30.1877 57.1234 83.6509 72.2738 38.2766 14.9799 57.3006 11.1611 86.2421 82.1742 62.032 23.9998 10.3402 62.523 94.9949 83.3987 17.5811 35.6559 78.3024 91.1271 16.2202 64.8015 84.3801 5.1482 92.9552 94.0986 46.4379 38.7688 45.8646 46.3122 75.5824 53.8257 81.2124 94.7924 75.2474 49.9656 37.2675 2.6665 95.1325 42.9227 47.9295 46.0788 41.0171 73.0327 3.4911 25.9911 63.2356 79.9172 34.0789 99.1662 95.9991 32.9236 75.2963 56.5338 83.3049 32.0717 13.2672 74.7852 28.1778 68.0305 11.1617 50.0599 61.8143 81.783 26.4916 41.6593 89.2977 39.5503 59.0004 63.3553 64.1477 69.843 4.1206 2.9718 11.8131 38.5519 43.1467 98.6033 75.5764 40.742 71.7442 63.5485 23.1451 65.0041 97.5215 90.9362 22.7643 79.4268 62.6708 44.2297 81.4649 13.0423 94.0919 56.3951 97.8189 83.2167 59.2236 86.1752 92.7015 75.8628 5.0773 69.0092 56.7288 36.2158 81.3115 41.836 43.9689 6.2378 64.5138 96.3405 78.6838 62.9485 15.5811 73.2367 49.7722 26.4951 60.4736 58.2205 4.9845 86.6355 71.7861 31.5016 47.1877 88.743 58.5314 93.7063 8.0646 87.3743 12.4367 81.6865 99.8508 93.8887 51.8805 20.3249 91.979 75.5941 26.2409 35.4437 51.3147 97.8217 19.1967 32.2636 58.5201 6.3807 95.6343 97.3863 71.8277 62.936 80.7951 6.1453 33.5137 75.2092 43.7455 40.7679 38.4134 99.2072 70.8025 83.3562 94.9542 95.0857 91.13 16.3445 36.4279 22.8437 98.6872 8.5159 87.1111 45.591 43.667 40.1265 76.9499 27.0474 50.2405 54.8944 54.7779 35.2432 82.4133 43.3612 97.8132 52.9115 74.3495 21.2289 98.576 6.9846 5.5691 20.1073 7.5398 98.0818 71.5481 92.0827 38.2527 31.6948 14.5201 2.0101 11.391 34.4609 49.8715 66.4891 45.5435 41.4349 82.8424 81.0961 84.505 25.6759 40.4381 69.9884 59.5524 10.6798 8.5535 24.6268 78.8229 54.7231 95.2953 69.7656 24.851 35.9478 7.1393 48.2189 73.1725 58.1484 80.5974 46.843 14.3136 46.2644 62.1011 33.3083 86.4375 39.3913 82.8864 1.9364 26.6721 3.9338 66.4738 22.6 9.1065 8.6505 68.0627 27.1741 38.9614 64.1186 46.0361 74.4041 55.9073 10.2504 69.7759 79.0828 99.4341 24.9029 60.0233 28.3954 24.8495 3.3882 25.079 73.0098 83.7265 67.3958 84.3229 43.1857 68.9612 5.4455 36.0336 36.9409 5.2861 87.5477 82.9442 38.9141 22.0856 70.206 99.2887 34.305 84.8972 11.1345 25.7121 20.4488 1.826 90.9728 75.5881 60.5516 19.5466 86.3897 5.9308 7.7671 61.2688 0.276 81.337 14.8217 54.4906 28.942 9.402 72.6236 25.136 85.7076 84.6107 88.6731 52.1994 97.0812 41.1994 64.9938 27.7888 99.8082 98.7455 40.412 36.5105 15.4473 91.6214 4.5572 96.9854 13.8248 55.7673 7.3231 57.3362 7.4139 27.511 93.1695 4.2032 57.8371 22.834 69.2535 30.9911 83.2462 98.0818 5.6117 60.5637 40.8065 0.6807 17.7162 93.7854 82.3994 18.1009 70.8766 4.6109 80.181 63.7697 7.7129 10.3852 14.3445 22.6865 80.9174 66.6327 76.0649 78.9079 64.3261 46.1883 42.4082 82.3397 28.9544 3.5415 48.6084 7.9922 54.7408 76.9256 22.633 83.0234 27.5314 11.2843 99.7945 80.8354 85.9654 42.4553 74.3413 20.3867 38.6604 3.6008 24.6553 87.6957 47.3671 73.4223 74.4597 71.4706 78.1532 6.6701 56.664 17.2153 32.3868 58.6866 20.7389 50.4327 47.2793 72.0034 9.7079 55.9095 89.0917 37.6712 19.8095 78.4875 38.3215 41.6407 38.7091 30.898 81.8088 20.5909 35.5646 46.9965 29.2429 9.6442 12.5441 5.0399 81.7636 56.0597 2.9951 31.1871 71.2131 43.4735 76.2081 59.8825 74.4273 85.4837 3.105 34.6187 34.5698 17.7866 20.5393 18.1434 33.1756 59.5086 46.7809 34.4835 51.6788 22.1632 64.1119 55.2884 38.893 74.294 41.4153 13.6101 39.6812 4.0382 39.7154 40.5351 29.1158 20.8701 82.1591 76.5075 77.4396 83.9418 15.5321 59.1016 97.3689 15.5386 92.3414 40.1676 82.5655 92.576 97.1486 73.1903 28.708 77.65 48.4078 57.561 89.5719 18.0932 99.2396 65.7583 21.464 35.6539 92.0258 51.5052 27.0792 34.9165 26.8107 85.7529 43.1154 67.3797 0.2563 33.0013 29.9435 88.6486 98.9402 64.2067 51.6477 89.387 6.3544 16.3904 97.9109 8.5752 81.2761 55.8477 87.6038 78.6541 35.58 24.5411 61.6178 44.0671
    ${output}=    Read Until Prompt
    Log    ${output}
    Should Contain X Times    ${output}    === [issueCommand_${component}] writing a command containing :    1
    Should Contain X Times    ${output}    device : target    1
    Should Contain X Times    ${output}    property : lut    1
    Should Contain X Times    ${output}    action :     1
    Should Contain X Times    ${output}    value :     1
    Should Contain X Times    ${output}    xlut : 41.5744    1
    Should Contain X Times    ${output}    ylut : 94.7924    1
    Should Contain X Times    ${output}    zlut : 88.743    1
    Should Contain X Times    ${output}    ulut : 69.7656    1
    Should Contain X Times    ${output}    vlut : 15.4473    1
    Should Contain X Times    ${output}    wlut : 29.2429    1
    Should Contain    ${output}    === command configureLut issued =
    ${CmdComplete}=    Get Line    ${output}    -2
    Should Match Regexp    ${CmdComplete}    (=== \\[waitForCompletion_${component}\\] command )[0-9]+( completed ok :)

Read Controller
    [Tags]    functional
    Switch Connection    Controller
    ${output}=    Read Until    result \ \ : Done : OK
    Log    ${output}
    Should Contain    ${output}    === command configureLut received =
    Should Contain    ${output}    device : target
    Should Contain    ${output}    property : lut
    Should Contain    ${output}    action : 
    Should Contain    ${output}    value : 
    Should Contain X Times    ${output}    xlut : 41.5744    1
    Should Contain X Times    ${output}    ylut : 94.7924    1
    Should Contain X Times    ${output}    zlut : 88.743    1
    Should Contain X Times    ${output}    ulut : 69.7656    1
    Should Contain X Times    ${output}    vlut : 15.4473    1
    Should Contain X Times    ${output}    wlut : 29.2429    1
    Should Contain X Times    ${output}    === [ackCommand_configureLut] acknowledging a command with :    2
    Should Contain    ${output}    seqNum   :
    Should Contain    ${output}    ack      : 301
    Should Contain X Times    ${output}    error \ \ \ : 0    2
    Should Contain    ${output}    result   : Ack : OK
    Should Contain    ${output}    ack      : 303
    Should Contain    ${output}    result   : Done : OK
