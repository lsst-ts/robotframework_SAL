*** Settings ***
Documentation    Hexapod_configureLut commander/controller tests.
Suite Setup    Log Many    ${Host}    ${subSystem}    ${component}    ${timeout}
Suite Teardown    Close All Connections
Library    SSHLibrary
Library    String
Resource    ../../Global_Vars.robot

*** Variables ***
${subSystem}    hexapod
${component}    configureLut
${timeout}    30s

*** Test Cases ***
Create Commander Session
    [Documentation]    Connect to the SAL host.
    [Tags]    smoke
    Comment    Connect to host.
    Open Connection    host=${Host}    alias=Commander    timeout=${timeout}    prompt=${Prompt}
    Comment    Login.
    Log    ${ContInt}
    Login With Public Key    ${UserName}    keyfile=${KeyFile}    password=${PassWord}
    Directory Should Exist    ${SALInstall}
    Directory Should Exist    ${SALHome}

Create Controller Session
    [Documentation]    Connect to the SAL host.
    [Tags]    smoke
    Comment    Connect to host.
    Open Connection    host=${Host}    alias=Controller    timeout=${timeout}    prompt=${Prompt}
    Comment    Login.
    Log    ${ContInt}
    Login With Public Key    ${UserName}    keyfile=${KeyFile}    password=${PassWord}
    Directory Should Exist    ${SALInstall}
    Directory Should Exist    ${SALHome}

Verify Component Commander and Controller
    [Tags]    smoke
    File Should Exist    ${SALWorkDir}/${subSystem}/cpp/src/sacpp_${subSystem}_${component}_commander
    File Should Exist    ${SALWorkDir}/${subSystem}/cpp/src/sacpp_${subSystem}_${component}_controller

Start Commander - Verify Missing Inputs Error
    [Tags]    functional
    Switch Connection    Commander
    Comment    Move to working directory.
    Write    cd ${SALWorkDir}/${subSystem}/cpp/src
    Comment    Start Commander.
    ${input}=    Write    ./sacpp_${subSystem}_${component}_commander 
    ${output}=    Read Until Prompt
    Log    ${output}
    Should Contain    ${output}   Usage : \ input parameters...

Start Commander - Verify Timeout without Controller
    [Tags]    functional
    Switch Connection    Commander
    Comment    Move to working directory.
    Write    cd ${SALWorkDir}/${subSystem}/cpp/src
    Comment    Start Commander.
    ${input}=    Write    ./sacpp_${subSystem}_${component}_commander 22.2353 76.8637 20.2243 22.8749 43.5053 24.819 23.0453 85.218 15.5529 81.5304 8.0793 66.6336 23.9507 11.0943 92.0887 23.1332 11.1945 94.3904 1.7292 28.6256 54.7431 93.1269 83.3191 74.5797 48.9813 48.9786 68.6217 35.1833 94.6902 68.9577 49.1491 1.0826 10.8249 80.6066 42.1917 96.2225 18.305 8.5179 70.8493 15.7507 91.1347 77.251 49.4717 17.902 2.9283 65.6927 62.4458 71.1667 92.9028 45.485 69.8617 55.1256 33.6325 44.8739 7.086 93.8093 0.4666 44.8405 35.9538 0.7475 52.4491 42.4361 66.8056 11.9725 87.272 87.3348 25.2603 60.8842 89.8072 20.5464 87.7434 3.8687 97.7644 94.551 90.6319 76.0556 57.0081 78.3834 45.6334 36.3656 53.1821 93.1703 23.8595 90.6398 36.2955 42.2539 72.4519 6.7744 93.5786 44.0836 81.1907 45.0351 68.8162 9.7417 63.2542 85.5458 11.0791 35.5222 56.4184 31.5943 3.966 5.6074 47.3497 51.847 54.1614 86.1405 89.8579 13.3396 43.073 62.171 19.0557 75.2462 38.9476 51.5935 13.9415 1.2521 60.1403 30.9671 1.5706 89.3164 89.8085 6.6659 90.8068 32.7405 75.178 0.3621 91.0491 65.1211 60.845 98.0942 91.9722 77.7943 93.6254 59.5657 53.6172 97.5937 26.4654 27.0032 66.5538 78.3937 0.6788 77.7771 38.1296 13.8466 64.8618 65.4344 70.5501 93.2725 21.2809 27.7706 13.7025 17.7177 9.5499 36.9975 39.448 54.2226 57.9201 73.983 38.1867 34.7617 34.0049 24.3433 25.6288 78.7474 98.1155 27.6192 12.661 94.291 2.818 78.4508 29.533 55.1059 99.5957 13.599 17.37 29.9875 40.1546 48.6448 90.6098 54.6923 8.6846 76.8859 32.1887 55.9375 9.1714 89.2692 86.0597 82.7576 64.3083 74.956 75.9844 24.1258 14.2251 38.8648 12.1494 30.1077 74.3552 8.808 56.937 3.5585 84.6092 82.4947 65.1831 28.0516 74.0151 71.9827 52.7003 0.1136 66.3677 20.0212 58.0855 11.9737 3.0351 89.8208 27.4028 20.6887 77.9759 46.6794 41.1318 38.1806 45.1918 43.1129 73.2063 14.1345 90.1328 60.0348 13.3887 25.9362 1.8497 31.1648 45.8501 15.5392 26.3646 49.5859 0.5957 45.4008 58.8442 25.8154 19.9637 16.0152 95.8401 82.8241 22.1971 11.0514 17.4828 0.522 85.0644 94.0209 47.3987 34.5419 7.127 22.5133 67.0105 45.444 62.3766 73.5864 39.6377 18.0355 48.0923 62.1098 42.407 76.8307 95.331 72.7691 9.7058 56.9519 6.8882 6.9881 43.188 29.8536 74.6276 43.08 59.41 94.8815 25.3845 4.4121 61.4849 21.8964 36.5355 19.831 90.6429 73.6709 59.9469 12.4499 36.9535 37.4628 16.1653 80.272 44.7497 69.7516 8.5983 0.9059 8.1398 88.7246 37.8856 14.1134 1.1709 70.3354 5.371 30.8056 4.9658 2.2214 39.1959 8.0793 69.2059 57.666 48.1587 51.0593 73.4385 47.2302 62.4576 32.9156 81.4874 1.6032 9.2263 59.566 65.2258 46.7716 31.2231 99.3147 77.5995 92.29 52.688 66.1679 86.4666 9.8475 63.6594 57.4076 96.5855 43.4868 48.1516 0.6367 44.6357 81.5704 87.9427 57.542 41.7791 44.5033 39.8329 73.8783 55.6962 72.4583 47.7863 68.5945 93.3245 80.4528 57.1444 59.9306 86.8593 87.2686 68.2781 43.234 72.5122 4.3473 26.7927 81.8774 52.8187 50.7589 73.3768 2.4356 83.3403 15.389 3.4409 27.412 72.4306 68.6098 10.7072 4.3889 47.0024 13.7408 12.1997 87.7278 90.1077 48.9121 35.4848 21.9708 76.7662 87.0437 76.2472 91.6593 99.5119 14.4509 21.5801 35.072 26.4794 30.4324 54.8487 69.1406 99.5691 72.1386 22.7013 86.7549 46.0924 67.2218 69.3909 21.4421 10.9004 66.7557 27.1221 89.489 29.2899 68.7728 53.5485 8.5186 81.459 46.4117 92.861 45.0267 32.6026 14.8683 43.7392 94.5789 61.0474 8.236 89.5027 55.055 5.0646 17.1961 65.5661 27.4572 53.6344 33.335 21.5317 7.2924 35.1725 30.4801 73.608 62.9941 50.2353 44.4519 56.2223 90.8827 53.1084 54.0079 78.4149 61.2415 15.1158 6.0952 13.789 64.4315 67.6936 47.3033 15.4038 45.3895 97.1901 79.8543 67.6647 38.242 91.2557 98.2933 67.0543 9.2111 13.5397 10.9327 89.2962 49.2883 0.7563 38.2918 67.6517 65.1653 90.6201 37.6801 43.6265 12.434 39.3337 3.4304 78.0317 79.7743 71.9415 72.0201 70.7236 21.7761 36.2067 69.7479 74.933 43.6694 97.8301 61.1634 31.0523 0.4268 70.7474 60.5985 24.176 40.5287 83.7471 67.9231 41.726 13.1055 23.5392 36.5985 17.8214 17.142 76.9396 88.2673 31.6029 52.622 75.0172 68.4597 28.3359 44.0259 54.4295 44.9971 35.5521 34.2248 11.3042 59.9063 27.0802 87.5284 74.4425 62.6285 68.3741 99.1975 93.3655 4.671 71.7785 71.0257 92.3895 18.2406 66.724 34.1136 19.5517 49.6478 32.7975 40.9114 9.6642 39.5164 89.4852 35.1697 23.2698 92.1968 9.9701 20.71 33.3078 31.6399 76.6591 56.9032 47.6896 11.066 42.7245 29.2634
    ${output}=    Read Until Prompt
    Log    ${output}
    ${CmdComplete}=    Get Line    ${output}    -2
    Should Match Regexp    ${CmdComplete}    (=== \\[waitForCompletion_${component}\\] command )[0-9]+( timed out :)

Start Controller
    [Tags]    functional
    Switch Connection    Controller
    Comment    Move to working directory.
    Write    cd ${SALWorkDir}/${subSystem}/cpp/src
    Comment    Start Controller.
    ${input}=    Write    ./sacpp_${subSystem}_${component}_controller
    ${output}=    Read Until    controller ready
    Log    ${output}
    Should Contain    ${output}    ${subSystem}_${component} controller ready

Start Commander
    [Tags]    functional
    Switch Connection    Commander
    Comment    Move to working directory.
    Write    cd ${SALWorkDir}/${subSystem}/cpp/src
    Comment    Start Commander.
    ${input}=    Write    ./sacpp_${subSystem}_${component}_commander 22.2353 76.8637 20.2243 22.8749 43.5053 24.819 23.0453 85.218 15.5529 81.5304 8.0793 66.6336 23.9507 11.0943 92.0887 23.1332 11.1945 94.3904 1.7292 28.6256 54.7431 93.1269 83.3191 74.5797 48.9813 48.9786 68.6217 35.1833 94.6902 68.9577 49.1491 1.0826 10.8249 80.6066 42.1917 96.2225 18.305 8.5179 70.8493 15.7507 91.1347 77.251 49.4717 17.902 2.9283 65.6927 62.4458 71.1667 92.9028 45.485 69.8617 55.1256 33.6325 44.8739 7.086 93.8093 0.4666 44.8405 35.9538 0.7475 52.4491 42.4361 66.8056 11.9725 87.272 87.3348 25.2603 60.8842 89.8072 20.5464 87.7434 3.8687 97.7644 94.551 90.6319 76.0556 57.0081 78.3834 45.6334 36.3656 53.1821 93.1703 23.8595 90.6398 36.2955 42.2539 72.4519 6.7744 93.5786 44.0836 81.1907 45.0351 68.8162 9.7417 63.2542 85.5458 11.0791 35.5222 56.4184 31.5943 3.966 5.6074 47.3497 51.847 54.1614 86.1405 89.8579 13.3396 43.073 62.171 19.0557 75.2462 38.9476 51.5935 13.9415 1.2521 60.1403 30.9671 1.5706 89.3164 89.8085 6.6659 90.8068 32.7405 75.178 0.3621 91.0491 65.1211 60.845 98.0942 91.9722 77.7943 93.6254 59.5657 53.6172 97.5937 26.4654 27.0032 66.5538 78.3937 0.6788 77.7771 38.1296 13.8466 64.8618 65.4344 70.5501 93.2725 21.2809 27.7706 13.7025 17.7177 9.5499 36.9975 39.448 54.2226 57.9201 73.983 38.1867 34.7617 34.0049 24.3433 25.6288 78.7474 98.1155 27.6192 12.661 94.291 2.818 78.4508 29.533 55.1059 99.5957 13.599 17.37 29.9875 40.1546 48.6448 90.6098 54.6923 8.6846 76.8859 32.1887 55.9375 9.1714 89.2692 86.0597 82.7576 64.3083 74.956 75.9844 24.1258 14.2251 38.8648 12.1494 30.1077 74.3552 8.808 56.937 3.5585 84.6092 82.4947 65.1831 28.0516 74.0151 71.9827 52.7003 0.1136 66.3677 20.0212 58.0855 11.9737 3.0351 89.8208 27.4028 20.6887 77.9759 46.6794 41.1318 38.1806 45.1918 43.1129 73.2063 14.1345 90.1328 60.0348 13.3887 25.9362 1.8497 31.1648 45.8501 15.5392 26.3646 49.5859 0.5957 45.4008 58.8442 25.8154 19.9637 16.0152 95.8401 82.8241 22.1971 11.0514 17.4828 0.522 85.0644 94.0209 47.3987 34.5419 7.127 22.5133 67.0105 45.444 62.3766 73.5864 39.6377 18.0355 48.0923 62.1098 42.407 76.8307 95.331 72.7691 9.7058 56.9519 6.8882 6.9881 43.188 29.8536 74.6276 43.08 59.41 94.8815 25.3845 4.4121 61.4849 21.8964 36.5355 19.831 90.6429 73.6709 59.9469 12.4499 36.9535 37.4628 16.1653 80.272 44.7497 69.7516 8.5983 0.9059 8.1398 88.7246 37.8856 14.1134 1.1709 70.3354 5.371 30.8056 4.9658 2.2214 39.1959 8.0793 69.2059 57.666 48.1587 51.0593 73.4385 47.2302 62.4576 32.9156 81.4874 1.6032 9.2263 59.566 65.2258 46.7716 31.2231 99.3147 77.5995 92.29 52.688 66.1679 86.4666 9.8475 63.6594 57.4076 96.5855 43.4868 48.1516 0.6367 44.6357 81.5704 87.9427 57.542 41.7791 44.5033 39.8329 73.8783 55.6962 72.4583 47.7863 68.5945 93.3245 80.4528 57.1444 59.9306 86.8593 87.2686 68.2781 43.234 72.5122 4.3473 26.7927 81.8774 52.8187 50.7589 73.3768 2.4356 83.3403 15.389 3.4409 27.412 72.4306 68.6098 10.7072 4.3889 47.0024 13.7408 12.1997 87.7278 90.1077 48.9121 35.4848 21.9708 76.7662 87.0437 76.2472 91.6593 99.5119 14.4509 21.5801 35.072 26.4794 30.4324 54.8487 69.1406 99.5691 72.1386 22.7013 86.7549 46.0924 67.2218 69.3909 21.4421 10.9004 66.7557 27.1221 89.489 29.2899 68.7728 53.5485 8.5186 81.459 46.4117 92.861 45.0267 32.6026 14.8683 43.7392 94.5789 61.0474 8.236 89.5027 55.055 5.0646 17.1961 65.5661 27.4572 53.6344 33.335 21.5317 7.2924 35.1725 30.4801 73.608 62.9941 50.2353 44.4519 56.2223 90.8827 53.1084 54.0079 78.4149 61.2415 15.1158 6.0952 13.789 64.4315 67.6936 47.3033 15.4038 45.3895 97.1901 79.8543 67.6647 38.242 91.2557 98.2933 67.0543 9.2111 13.5397 10.9327 89.2962 49.2883 0.7563 38.2918 67.6517 65.1653 90.6201 37.6801 43.6265 12.434 39.3337 3.4304 78.0317 79.7743 71.9415 72.0201 70.7236 21.7761 36.2067 69.7479 74.933 43.6694 97.8301 61.1634 31.0523 0.4268 70.7474 60.5985 24.176 40.5287 83.7471 67.9231 41.726 13.1055 23.5392 36.5985 17.8214 17.142 76.9396 88.2673 31.6029 52.622 75.0172 68.4597 28.3359 44.0259 54.4295 44.9971 35.5521 34.2248 11.3042 59.9063 27.0802 87.5284 74.4425 62.6285 68.3741 99.1975 93.3655 4.671 71.7785 71.0257 92.3895 18.2406 66.724 34.1136 19.5517 49.6478 32.7975 40.9114 9.6642 39.5164 89.4852 35.1697 23.2698 92.1968 9.9701 20.71 33.3078 31.6399 76.6591 56.9032 47.6896 11.066 42.7245 29.2634
    ${output}=    Read Until Prompt
    Log    ${output}
    Should Contain X Times    ${output}    === [issueCommand_${component}] writing a command containing :    1
    Should Contain X Times    ${output}    device : target    1
    Should Contain X Times    ${output}    property : lut    1
    Should Contain X Times    ${output}    action :     1
    Should Contain X Times    ${output}    value :     1
    Should Contain X Times    ${output}    xlut : 22.2353    1
    Should Contain X Times    ${output}    ylut : 81.1907    1
    Should Contain X Times    ${output}    zlut : 8.6846    1
    Should Contain X Times    ${output}    ulut : 74.6276    1
    Should Contain X Times    ${output}    vlut : 83.3403    1
    Should Contain X Times    ${output}    wlut : 67.0543    1
    Should Contain    ${output}    === command configureLut issued =
    ${CmdComplete}=    Get Line    ${output}    -2
    Should Match Regexp    ${CmdComplete}    (=== \\[waitForCompletion_${component}\\] command )[0-9]+( completed ok :)

Read Controller
    [Tags]    functional
    Switch Connection    Controller
    ${output}=    Read Until    result \ \ : Done : OK
    Log    ${output}
    Should Contain    ${output}    === command configureLut received =
    Should Contain    ${output}    device : target
    Should Contain    ${output}    property : lut
    Should Contain    ${output}    action : 
    Should Contain    ${output}    value : 
    Should Contain X Times    ${output}    xlut : 22.2353    1
    Should Contain X Times    ${output}    ylut : 81.1907    1
    Should Contain X Times    ${output}    zlut : 8.6846    1
    Should Contain X Times    ${output}    ulut : 74.6276    1
    Should Contain X Times    ${output}    vlut : 83.3403    1
    Should Contain X Times    ${output}    wlut : 67.0543    1
    Should Contain X Times    ${output}    === [ackCommand_configureLut] acknowledging a command with :    2
    Should Contain    ${output}    seqNum   :
    Should Contain    ${output}    ack      : 301
    Should Contain X Times    ${output}    error \ \ \ : 0    2
    Should Contain    ${output}    result   : Ack : OK
    Should Contain    ${output}    ack      : 303
    Should Contain    ${output}    result   : Done : OK
